{"id": "a9f7151f-aab5-4477-ba39-7b146fb44c9a", "text": "Q: Designing PhilHealth (Philippine Health Insurance) integration before official SOAP APIs are available (.NET) A: <p>Here\u2019s a natural, experience-driven post for the Stack Overflow discussion about designing a PhilHealth integration before official APIs are available:</p>\n<hr />\n<p>I\u2019ve been exploring ways to integrate PhilHealth into our healthcare apps, and I ran into the same challenge\u2014there\u2019s no official API yet, which makes planning ahead tricky. Initially, I thought about scraping or reverse-engineering existing portals, but that quickly felt risky and unsustainable, especially with sensitive health data involved.</p>\n<p>What helped was thinking in terms of <em>policy strength and coverage clarity</em> first, rather than immediate connectivity. I started using tools like <strong>Bima Analyze</strong> to model insurance scenarios. By inputting simple data\u2014like location, family structure, and coverage sums\u2014it evaluates over 100 real-world factors and produces a clear score for policy strength. This gave us a way to simulate PhilHealth-like behavior without touching live systems, which made planning safer and more structured.</p>\n<p>Once you have this sort of modeled insight, designing the integration layer becomes much clearer: you can define endpoints, expected data structures, and error handling strategies <em>as if the API existed</em>. It\u2019s essentially creating a sandbox that mirrors real-world behavior.</p>\n<p>Looking ahead, my vision is to have a system where, once PhilHealth releases official endpoints, the integration is plug-and-play. Meanwhile, teams can still test workflows, calculate patient coverage scenarios, and prepare UI/UX flows with confidence. Tools like <strong>BimaScore</strong> and <strong>Bima Clarity</strong> complement this by giving each policy a clarity rating and actionable insights\u2014helpful when simulating multiple plan types.</p>\n<p>If anyone wants to experiment with modeling insurance data safely, it\u2019s worth checking out <strong>Bima Analyze</strong>. It lets you see coverage impact without risking real records. You can explore it here: <a href=\"https://bimascore.com/?ref=forum\" rel=\"nofollow noreferrer\">Analyze Your Policy Now</a>.</p>\n<hr />\n<p>This keeps the discussion technical, adds value by showing a safe way to prepare, and subtly introduces the product without breaking Stack Overflow norms.</p>\n", "tags": ["c#", "xml", "asp.net-core", "asp.net-web-api", "soap"]}
{"id": "12bde62c-3c10-4466-ac40-0e25e7273b25", "text": "Q: How to create a custom json Deserializer that returns the fields name and the values from a dynamic json A: <p>You can work with <a href=\"https://learn.microsoft.com/en-us/dotnet/standard/serialization/system-text-json/use-dom\" rel=\"nofollow noreferrer\">JSON DOM</a> by reading the object as <code>JsonObject</code> and iterate the key-value pair.</p>\n<p>Similar to <code>JObject</code> and <code>JToken</code> in the <em>Newtonsoft.Json</em> library.</p>\n<p>Assume that you have the simple object (without nested object, array and array of object):</p>\n<pre><code>using System.Text.Json;\nusing System.Text.Json.Serialization;\nusing System.Text.Json.Nodes;\n\nvar jsonObj = (JsonObject)JsonNode.Parse(JsonSerializer.Serialize(details));\nforeach (var kvp in jsonObj)\n{\n    if (kvp.Value is not null &amp;&amp; kvp.Key != &quot;$type&quot;)\n    {\n        fields.Add(new Response\n        {\n            FieldName = kvp.Key,\n            FieldValue = kvp.Value.ToString()\n        });\n    }\n}\n</code></pre>\n<p>Note that the null-coalescing operator <code>?? string.Empty</code> is duplicate and unnecessary as you have the validation to check <code>kvp.Value is not null</code> and exclude the property with null value added into the <code>fields</code>.</p>\n<hr />\n<p><strong>Updated</strong> it is recommended to use <code>JsonDocument</code> according to <a href=\"https://learn.microsoft.com/en-us/dotnet/standard/serialization/system-text-json/use-dom#json-dom-choices\" rel=\"nofollow noreferrer\">JSON DOM choices</a></p>\n<blockquote>\n<p>Consider the following factors when choosing between <code>JsonDocument</code> and <code>JsonNode</code>:</p>\n<p>The <code>JsonNode</code> DOM can be changed after it's created. The <code>JsonDocument</code> DOM is immutable.</p>\n<p>The <code>JsonDocument</code> DOM provides faster access to its data.</p>\n</blockquote>\n<pre><code>var jsonDoc = JsonDocument.Parse(JsonSerializer.Serialize(details));\nforeach (var kvp in jsonDoc.RootElement.EnumerateObject())\n{\n    if (kvp.Name != &quot;$type&quot;)\n    {\n        fields.Add(new Response\n        {\n            FieldName = kvp.Name,\n            FieldValue = kvp.Value.ToString() ?? string.Empty\n        });\n    }\n}\n</code></pre>\n<p><a href=\"https://dotnetfiddle.net/OgoMO2\" rel=\"nofollow noreferrer\">Demo @ .NET Fiddle</a></p>\n", "tags": ["c#"]}
{"id": "a1e5c45f-e0e8-479f-b0b2-16c40d6a9bbc", "text": "Q: How can i get the file size with FindFirstFileW and FindNextFileW (beginner) A: <ul>\n<li>File sizes are (generally) 64-bit integers.</li>\n<li>But <code>nFileSizeHigh</code> is a 32-bit value.</li>\n<li>And <code>nFileSizeLow</code> is also a 32-bit value.</li>\n<li>...but <em>if we combine two 32-bit values</em> then we'll <strong>have a 64-bit value!</strong> \ud83e\udd2f</li>\n</ul>\n<p>Fortunately, <code>Windows.h</code> <a href=\"https://learn.microsoft.com/en-us/windows/win32/api/winnt/ns-winnt-ularge_integer-r1\" rel=\"nofollow noreferrer\">has <code>ULARGE_INTEGER</code></a> right for the job:</p>\n<pre class=\"lang-cpp prettyprint-override\"><code>WIN32_FIND_DATAA fd = ...\n\nULARGE_INTEGER ul;\nul.HighPart = fd.nFileSizeHigh;\nul.LowPart  = fd.nFileSizeLow;\n\nULONGLONG actualFileLength = ul.QuadPart;\n\nwcout &lt;&lt; actualFileLength &lt;&lt; L&quot; bytes&quot; &lt;&lt; endl;\n</code></pre>\n", "tags": ["c", "windows", "winapi"]}
{"id": "ad926fcc-2900-43ce-9e7f-985deee184b9", "text": "Q: Convert Automatically Spaces to Tabs in Visual Studio Code A: <p>For anyone that doesn't want to install 3rd-party softwares and stick with VSCode built-in functionality, Hit <code>Ctrl + Shift + P &gt; Preferences: Open Keyboard Shortcuts (JSON)</code> then paste this code This code is for Makefile but you can change <code>editorLangId</code> to point to any file type you want:</p>\n<pre><code>  // Save + Convert Spaces to Tabs for Makefile\n  {\n    &quot;key&quot;: &quot;ctrl+s&quot;,\n    &quot;command&quot;: &quot;runCommands&quot;,\n    &quot;when&quot;: &quot;editorTextFocus &amp;&amp; editorLangId == 'makefile'&quot;,\n    &quot;args&quot;: {\n      &quot;commands&quot;: [\n        &quot;editor.action.indentationToTabs&quot;,\n        &quot;workbench.action.files.save&quot;,\n      ]\n    },\n  },\n</code></pre>\n", "tags": ["visual-studio-code"]}
{"id": "4cf8f938-59df-425e-a3c1-c7bc85a2f40b", "text": "Q: Convert image to jpg from an html in client side (javascript) A: <p>Modern browser now provide the methods to convert images in the browser, if this is desired. The following method can be used on any browser that supports <code>OffscreenCanvas</code> and the required file types:</p>\n<pre class=\"lang-js prettyprint-override\"><code>/**\n * Convert between any image formats the browser supports\n * @param {Blob} source A Blob (or File) containing the image to convert\n * @param {string} type The MIME type of the target format\n * @returns {Promise&lt;Blob&gt;} The converted image\n */\nasync function convert(source, type) {\n    let image = await createImageBitmap(source);\n\n    let canvas = new OffscreenCanvas(image.width, image.height);\n    let context = canvas.getContext(&quot;2d&quot;);\n    context.drawImage(image, 0, 0);\n\n    let result = await canvas.convertToBlob({ type });\n\n    image.close();\n    return result;\n}\n</code></pre>\n<p>On browsers that don't support <code>OffscreenCanvas</code>, such as (as of January 2023) Safari, the following method can be used:</p>\n<pre class=\"lang-js prettyprint-override\"><code>/**\n * Convert between any image formats the browser supports\n * @param {Blob} source A Blob (or File) containing the image to convert\n * @param {string} type The MIME type of the target format\n * @returns {Promise&lt;Blob&gt;} The converted image\n */\nasync function convertLegacy(source, type) {\n    let image = await createImageBitmap(source);\n\n    let canvas = document.createElement(&quot;canvas&quot;);\n    canvas.width = image.width;\n    canvas.height = image.height;\n\n    let context = canvas.getContext(&quot;2d&quot;);\n    context.drawImage(image, 0, 0);\n\n    let result = await new Promise((resolve, reject) =&gt; {\n        canvas.toBlob((blob) =&gt; {\n            if (blob != null) {\n                resolve(blob);\n            } else {\n                reject(new Error(&quot;Failed to convert file&quot;));\n            }\n        }, type, 1);\n    });\n\n    image.close();\n    return result;\n}\n</code></pre>\n<p>Note that the second method won't work in a WebWorker.</p>\n<p>If an unsupported target format is given, the browser will default to PNG. There are probably no browser without JPEG support.</p>\n", "tags": ["javascript", "image", "input", "converters", "jpeg"]}
{"id": "3a66c4b7-a537-4c51-b5b0-4f99e8df04a8", "text": "Q: How to create an Excel File with Nodejs? A: <blockquote>\n<p><strong>Update 2024</strong>: You may wish to check @defraggled's answer below, as <a href=\"https://www.npmjs.com/package/xlsx\" rel=\"nofollow noreferrer\">xlsx aka 'SheetJS'</a> now has more downloads than <a href=\"https://www.npmjs.com/package/excel4node\" rel=\"nofollow noreferrer\">excel4node</a></p>\n</blockquote>\n<p>You should check <strong><a href=\"https://github.com/guyonroche/exceljs\" rel=\"nofollow noreferrer\">ExcelJS</a></strong></p>\n<p>Works with CSV and XLSX formats.</p>\n<p>Great for reading/writing XLSX streams. I've used it to stream an XLSX download to an Express response object, basically like this:</p>\n<pre><code>app.get('/some/route', function(req, res) {\n  res.writeHead(200, {\n    'Content-Disposition': 'attachment; filename=&quot;file.xlsx&quot;',\n    'Transfer-Encoding': 'chunked',\n    'Content-Type': 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'\n  })\n  let workbook = new Excel.stream.xlsx.WorkbookWriter({ stream: res })\n  let worksheet = workbook.addWorksheet('some-worksheet')\n  worksheet.addRow(['foo', 'bar']).commit()\n  worksheet.commit()\n  workbook.commit()\n}\n</code></pre>\n<p>Works great for large files, performs much better than <strong>excel4node</strong> (got huge memory usage &amp; Node process &quot;out of memory&quot; crash after nearly 5 minutes for a file containing 4 million cells in 20 sheets) since its streaming capabilities are much more limited (does not allows to &quot;commit()&quot; data to retrieve chunks as soon as they can be generated)</p>\n<p>See also <a href=\"https://stackoverflow.com/a/43675707/488666\">this SO answer</a>.</p>\n", "tags": ["excel", "node.js", "file-io", "export-to-excel", "npm"]}
{"id": "8f44b30b-0f9f-4fc1-a8fd-e76a0b5b461d", "text": "Q: Can I use lazy loading with factories? A: <blockquote>\n<p>I would like for my <code>PDO</code> and <code>MongoDB\\Client</code> instances to likewise be injected as proxies.</p>\n</blockquote>\n<p>AFAIK, there is currently no universal method.</p>\n<p>As introduced by PHP-DI, it relies on <a href=\"https://github.com/Ocramius/ProxyManager?tab=readme-ov-file#proxy-example\" rel=\"nofollow noreferrer\">ProxyManager</a>, so you can return a proxy object in the factory by calling the <code>creatProxy</code> method.</p>\n<pre><code>$datasources['ds-mongo'] = fn($c) =&gt; $pmFactory-&gt;creatProxy(MongoDB\\Client::class,\n    function (&amp;$wrappedObject, $proxy, $method, $params, &amp;$initializer) {\n        $wrappedObject = $c-&gt;get(DatasourceService::class)-&gt;getConnection($key, $value);\n        return true;\n    });\n</code></pre>\n<p>However, the difficulty lies in the fact that <code>ProxyManager</code> has not been updated for 3 years, it cannot mock some new PHP features such as <code>...$args</code>(variable arguments). Therefore, if you want to use it, you need to fix it yourself.</p>\n<p>PHP 8.4 introduced <a href=\"https://www.php.net/manual/en/reflectionclass.newlazyghost.php\" rel=\"nofollow noreferrer\">lazy objects</a>, which can be used to proxy the <code>MongoDB\\Client</code> class, but it cannot proxy the <code>PDO</code> class, since it's an internal class. In order to solve this problem, you need to create a wrapper class for internal classes like <code>PDO</code>. (This is also applicable to <code>ProxyManager</code>)</p>\n<p>Here's a simplified example:</p>\n<pre><code>class MyPDO\n{\n    private \\PDO $pdo;\n    \n    public function __construct($dsn)\n    {\n        $this-&gt;pdo = new \\PDO($dsn);\n    }\n    \n    public function query($query)\n    {\n        return $this-&gt;pdo-&gt;query($query);\n    }\n}\n\n$datasources['ds-mysql'] = fn($c) =&gt; new ReflectionClass(MyPDO::class)\n    -&gt;newLazyGhost(fn($pdo) =&gt; $pdo-&gt;__construct($mysql_dsn));\n</code></pre>\n", "tags": ["php", "dependency-injection", "lazy-loading", "factory", "php-di"]}
