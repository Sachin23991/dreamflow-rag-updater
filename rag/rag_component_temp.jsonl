{"id": "ded284f8-7eb6-40cf-a926-ff53cce87924", "text": "Q: To extract specific string from txt file and copy the extracted string to json file in batch file A: <p>Simple text replacement may work for simple cases but it'll fail quickly for more complex input. So <strong>don't use normal text replacement to replace structured text</strong> like JSON, YAML, CSV or XML. Use a tool that can parse the structure instead!</p>\n<p>The builtin PowerShell on Windows already has the ability to understand most common text object formats so you just need to do a simple <em>read file/modify data/write result back</em> cycle</p>\n<pre><code># Extract &quot;name&quot; from abc.txt\n$nameValue = (Get-Content &quot;abc.txt&quot; -Raw | ConvertFrom-Json).name\n\n# Parse &amp; update sample.json\n$sampleJson = Get-Content &quot;sample.json&quot; -Raw | ConvertFrom-Json\n$sampleJson.requisite.name = $nameValue\n\n# Save the updated JSON back to sample.json\n$sampleJson | ConvertTo-Json -Depth 10 | Set-Content &quot;sample.json&quot;\n</code></pre>\n<p>It can be called from cmd, but it's better to write everything in PowerShell so that you don't need to deal with any legacy issues in cmd</p>\n<p>For more information read</p>\n<ul>\n<li><a href=\"https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/convertfrom-json?view=powershell-5.1\" rel=\"nofollow noreferrer\">ConvertFrom-Json</a> / <a href=\"https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/convertto-json?view=powershell-5.1\" rel=\"nofollow noreferrer\">ConvertTo-Json</a></li>\n<li><a href=\"https://devblogs.microsoft.com/scripting/working-with-json-data-in-powershell/\" rel=\"nofollow noreferrer\">Working with JSON data in PowerShell</a></li>\n<li><a href=\"https://thinkpowershell.com/powershell-and-json-a-practical-guide/\" rel=\"nofollow noreferrer\">PowerShell and JSON: A Practical Guide</a></li>\n</ul>\n", "tags": ["json", "windows", "batch-file", "cmd", "text-extraction"]}
{"id": "b0bffc6b-9f3c-41af-a700-25cd6f9ed7b9", "text": "Q: Bring window to focus with python periodically A: <p>I know this is a very old post but ...<br>\nIf <code>win32gui.SetForegroundWindow(hwnd)</code> generates an exception or flashes the app on the taskbar you can use this ...</p>\n<pre class=\"lang-py prettyprint-override\"><code>import ctypes\nimport ctypes.wintypes as wintypes\n\nuser32 = ctypes.WinDLL('user32', use_last_error = True)\n\n# https://learn.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-switchtothiswindow\n# [This function is not intended for general use. It may be altered or unavailable in subsequent versions of Windows.]\n# VOID SwitchToThisWindow(\n#   [in] HWND hwnd,\n#   [in] BOOL fUnknown\n# );\n_SwitchToThisWindow = user32.SwitchToThisWindow\n_SwitchToThisWindow.argtypes = [wintypes.HWND, wintypes.BOOL]\n_SwitchToThisWindow.restype = None\n\ndef SwitchToThisWindow(hwnd: int, from_alt_tab: bool = False):\n    &quot;&quot;&quot;\n    Switch to the specified window.\n\n    Args:\n        hwnd: Window handle to switch to\n        from_alt_tab: Whether to simulate Alt+Tab behavior\n    &quot;&quot;&quot;\n    _SwitchToThisWindow(hwnd, from_alt_tab)\n</code></pre>\n<p>This has never failed or generated any exceptions in any of my code.</p>\n<hr />\n<p>You can also move the window to different virtual desktops with pyvda ...</p>\n<pre class=\"lang-py prettyprint-override\"><code>import pyvda\nimport psutil\nfrom  win32gui import GetForegroundWindow, GetWindowText\nfrom win32process import GetWindowThreadProcessId\nfrom os import startfile\nfrom time import sleep\n\n\nclass AppProcess(psutil.Process, pyvda.AppView):\n    def __init__(self, hwnd: int):\n        pyvda.AppView.__init__(self, hwnd = hwnd)\n\n        # thread id and process id\n        _, pid = GetWindowThreadProcessId(self.hwnd)\n        psutil.Process.__init__(self, pid = pid)\n\n    @property\n    def caption(self) -&gt; str: return GetWindowText(self.hwnd)\n\n\ndef get_app_by_z_order(switcher_windows: bool = True, current_desktop: bool = True) -&gt; list[AppProcess]:\n    &quot;&quot;&quot;\n    Get a list of AppProcesses, ordered by their Z position, with the foreground window first.\n\n    Args:\n        switcher_windows (bool, optional): Only include windows which appear in the alt-tab dialogue. Defaults to True.\n        current_desktop (bool, optional): Only include windows which are on the current virtual desktop. Defaults to True.\n\n    Returns:\n        List[AppProcess]: AppProcesses matching the specified criteria.\n    &quot;&quot;&quot;\n    return [AppProcess(app.hwnd) for app in pyvda.get_apps_by_z_order(switcher_windows, current_desktop)]\n\n\napp_process = next((p for p in get_app_by_z_order(current_desktop = False) if p.name() == 'firefox.exe'), None)\nif app_process is None:\n    startfile(r'C:\\Program Files\\Mozilla Firefox\\firefox.exe')\n    while app_process is None:\n        app_process = next((p for p in get_app_by_z_order(current_desktop = False) if p.name() == 'firefox.exe'), None)\n        sleep(0.1)\n\nif app_process is not None:\n    if app_process.desktop.number != pyvda.VirtualDesktop.current().number:\n        app_process.move(pyvda.VirtualDesktop.current())\n\n    if GetForegroundWindow() != app_process.hwnd:\n        SwitchToThisWindow(\n            hwnd = app_process.hwnd,\n            from_alt_tab = True\n        )\n</code></pre>\n", "tags": ["python", "win32gui"]}
{"id": "19e709ac-feb1-46b6-a944-cc58f95c4e9d", "text": "Q: Internal error: X pixel values were NA, even after projection A: <p>The error message comes from code that looks up the pixel value of an image at a location specified by spatial coordinates. An NA value is returned if the query location lies outside the spatial region where the pixel image is defined. So the most likely cause of the error is a mismatch between your spatial point coordinates and your pixel image coordinates. Did you apply the same geographical coordinate transformation to both sets of data?</p>\n", "tags": ["r", "spatstat"]}
{"id": "d8b7528b-a8a7-414a-b4bc-dd47a0b3a187", "text": "Q: Making a interactive wordcloud in Dash + 2 different wordclouds for different clicks A: <p>Here\u2019s how to make interactive wordclouds and show different wordclouds on alternating clicks:</p>\n<h2>Solutions</h2>\n<h3>1. Interactive wordclouds in Dash</h3>\n<p>Yes, it\u2019s possible. The current <strong>px.imshow(wordcloud)</strong> renders a static image. For interactivity, you can:</p>\n<ul>\n<li><p>Use Plotly scatter plots to position words (more interactive)</p>\n</li>\n<li><p>Keep the image approach but add hover/click callbacks</p>\n</li>\n<li><p>Use a custom HTML component with JavaScript</p>\n</li>\n</ul>\n<h3>2. Different wordclouds on alternating clicks</h3>\n<p>Use a <strong>dcc.Store</strong> to track click count and switch between wordclouds.</p>\n<p>Here's the modified code:</p>\n<pre><code>import pandas as pd\nimport dash\nfrom dash import html\nfrom dash import dcc\nfrom dash.dependencies import Input, Output, State\nimport plotly.express as px\nfrom wordcloud import WordCloud\nfrom wordcloud import STOPWORDS\nimport re\nimport plotly.graph_objects as go\nimport os\n\napp = dash.Dash(__name__)\n\ndata_parsed = pd.read_csv(&quot;parsed-data.csv&quot;).sort_values(&quot;Date&quot;)\npresidents = data_parsed[&quot;President name&quot;].unique()\nfiles = os.listdir(&quot;all-speech-txt/&quot;)\n\napp.layout = html.Div(\n    [\n        html.H1(&quot;Presidential speeches&quot;),\n        html.Div(\n            [\n                dcc.Graph(\n                    id=&quot;president_speeches&quot;,\n                    clickAnnotationData=None,\n                    selectedData=[{&quot;label&quot;: i, &quot;value&quot;: i} for i in presidents],\n                ),\n            ]\n        ),\n        # Store component to track click count\n        dcc.Store(id='click-count-store', data={'count': 0, 'last_president': None}),\n        html.Div([\n            dcc.Graph(id=&quot;word_cloud&quot;), \n            dcc.Graph(id=&quot;word_clouds2&quot;)\n        ]),\n    ]\n)\n\n@app.callback(\n    Output(component_id=&quot;president_speeches&quot;, component_property=&quot;figure&quot;),\n    [Input(component_id=&quot;president_speeches&quot;, component_property=&quot;value&quot;)],\n)\ndef display_chart(selected_president):\n    mydata = data_parsed\n    speech_counts = (\n        mydata.groupby(by=[&quot;President name&quot;]).size().reset_index(name=&quot;counts&quot;)\n    )\n    fig = px.bar(\n        speech_counts, x=&quot;President name&quot;, y=&quot;counts&quot;, category_orders=(data_parsed)\n    )\n    return fig\n\n@app.callback(\n    Output('click-count-store', 'data'),\n    [Input(component_id=&quot;president_speeches&quot;, component_property=&quot;clickData&quot;)],\n    [State('click-count-store', 'data')]\n)\ndef update_click_count(clicked_data, store_data):\n    if clicked_data is None:\n        return store_data\n    \n    current_president = clicked_data[&quot;points&quot;][0][&quot;x&quot;]\n    \n    # If same president clicked, increment count; otherwise reset\n    if store_data['last_president'] == current_president:\n        store_data['count'] = (store_data['count'] + 1) % 2  # Toggle between 0 and 1\n    else:\n        store_data['count'] = 0\n        store_data['last_president'] = current_president\n    \n    return store_data\n\n@app.callback(\n    Output(component_id=&quot;word_cloud&quot;, component_property=&quot;figure&quot;),\n    [\n        Input(component_id=&quot;president_speeches&quot;, component_property=&quot;clickData&quot;),\n        Input('click-count-store', 'data')\n    ],\n)\ndef first_wordcloud(clicked_data, store_data):\n    if clicked_data is None or store_data['count'] != 0:\n        return go.Figure()\n\n    president = clicked_data[&quot;points&quot;][0][&quot;x&quot;]\n    \n    df_filtered = open(\n        &quot;all-speech-txt/&quot; + president + &quot;.txt&quot;, &quot;r&quot;, encoding=&quot;utf-8&quot;\n    ).read()\n\n    df_filtered = re.sub(r&quot;[^A-Za-z\\s]&quot;, &quot;&quot;, df_filtered)\n    df_filtered = df_filtered.lower()\n\n    stopwords = set(STOPWORDS)\n    text = &quot; &quot;.join(word for word in df_filtered.split() if word not in stopwords)\n\n    # First wordcloud configuration\n    wordcloud = WordCloud(\n        width=800,\n        height=500,\n        margin=2,\n        max_words=25,\n        min_word_length=5,\n        background_color=&quot;white&quot;,\n        colormap=&quot;viridis&quot;,  # Different color scheme\n    ).generate(text)\n\n    fig = px.imshow(wordcloud)\n    fig.update_layout(title=f&quot;{president} - Wordcloud 1&quot;, xaxis_visible=False, yaxis_visible=False)\n    return fig\n\n@app.callback(\n    Output(component_id=&quot;word_clouds2&quot;, component_property=&quot;figure&quot;),\n    [\n        Input(component_id=&quot;president_speeches&quot;, component_property=&quot;clickData&quot;),\n        Input('click-count-store', 'data')\n    ],\n)\ndef second_wordcloud(clicked_data, store_data):\n    if clicked_data is None or store_data['count'] != 1:\n        return go.Figure()\n\n    president = clicked_data[&quot;points&quot;][0][&quot;x&quot;]\n    \n    df_filtered = open(\n        &quot;all-speech-txt/&quot; + president + &quot;.txt&quot;, &quot;r&quot;, encoding=&quot;utf-8&quot;\n    ).read()\n\n    df_filtered = re.sub(r&quot;[^A-Za-z\\s]&quot;, &quot;&quot;, df_filtered)\n    df_filtered = df_filtered.lower()\n\n    stopwords = set(STOPWORDS)\n    text = &quot; &quot;.join(word for word in df_filtered.split() if word not in stopwords)\n\n    # Second wordcloud configuration - different settings\n    wordcloud = WordCloud(\n        width=800,\n        height=500,\n        margin=2,\n        max_words=50,  # More words\n        min_word_length=3,  # Shorter words\n        background_color=&quot;black&quot;,  # Different background\n        colormap=&quot;plasma&quot;,  # Different color scheme\n    ).generate(text)\n\n    fig = px.imshow(wordcloud)\n    fig.update_layout(title=f&quot;{president} - Wordcloud 2&quot;, xaxis_visible=False, yaxis_visible=False)\n    return fig\n\nif __name__ == &quot;__main__&quot;:\n    app.run(debug=False, port=8070)\n</code></pre>\n<p>Changes</p>\n<ol>\n<li><p>Added <strong>dcc.Store</strong> to track click count and the last clicked president.</p>\n</li>\n<li><p>Added <strong>update_click_count</strong> callback to increment count on each click (toggles 0/1).</p>\n</li>\n<li><p>Modified both wordcloud callbacks to:</p>\n</li>\n</ol>\n<ul>\n<li><p>Accept the store data as input</p>\n</li>\n<li><p>Show only when the count matches (0 for first, 1 for second)</p>\n</li>\n<li><p>Use different WordCloud settings to make them distinct</p>\n</li>\n</ul>\n<h2>How it works</h2>\n<ul>\n<li><p>First click: count = 0 \u2192 shows word_cloud</p>\n</li>\n<li><p>Second click: count = 1 \u2192 shows word_clouds2</p>\n</li>\n<li><p>Third click: count = 0 \u2192 shows word_cloud again</p>\n</li>\n<li><p>Clicking a different president resets the count to 0</p>\n</li>\n</ul>\n<h2>Making wordclouds more interactive</h2>\n<p>For clickable/hoverable words, consider:</p>\n<ul>\n<li><p>Using a scatter plot with word positions (more complex)</p>\n</li>\n<li><p>Using <strong>dash_leaflet</strong> or custom HTML/JavaScript</p>\n</li>\n<li><p>Adding hover callbacks on the image</p>\n</li>\n</ul>\n<p>The current image-based approach works for display, but true word-level interactivity requires a different rendering method.</p>\n", "tags": ["python", "nlp", "plotly", "plotly-dash"]}
{"id": "253704bc-35d1-437e-8947-8e0f2510cbd6", "text": "Q: Spatial randomnes of observations (point pattern) A: <p>In your example, <code>coords.ppp</code> is a point pattern whose observation window is a rectangle, while evaluating the expression <code>ex</code> defined by <code>ex = expression(runifpoint( n , sw))</code> will produce a point pattern inside the window <code>sw</code>, which is a region representing Sweden. The <code>envelope</code> code is correctly detecting that these windows are different, so that the envelope will be invalid (I mean that statistical inference based on the envelope will be invalid).</p>\n<p>Simply set <code>coords.ppp &lt;- coords.ppp[sw]</code> and the rest of the code should work correctly.</p>\n", "tags": ["r", "owin", "spatial", "r-sp", "spatstat"]}
{"id": "935c7aa9-061e-4d37-a7e0-63c26a8c1799", "text": "Q: Is there a way to &quot;npm init&quot; an ES module? A: <p>The standard init script now includes type.</p>\n<ol>\n<li>Run <code>npm init</code></li>\n<li>When prompted for <code>type</code>, write <code>module</code></li>\n</ol>\n<p>Selecting all defaults otherwise gives you:</p>\n<pre><code>{\n  &quot;name&quot;: &quot;demo&quot;,\n  &quot;version&quot;: &quot;1.0.0&quot;,\n  &quot;description&quot;: &quot;&quot;,\n  &quot;main&quot;: &quot;index.js&quot;,\n  &quot;scripts&quot;: {\n    &quot;test&quot;: &quot;echo \\&quot;Error: no test specified\\&quot; &amp;&amp; exit 1&quot;\n  },\n  &quot;author&quot;: &quot;&quot;,\n  &quot;license&quot;: &quot;ISC&quot;,\n  &quot;type&quot;: &quot;module&quot;\n}\n</code></pre>\n<p>Note that currently (2025-Dec) <code>type</code> still defaults to <code>commonjs</code>.</p>\n", "tags": ["javascript", "node.js", "npm", "yarnpkg", "es6-modules"]}
{"id": "dad670d1-31df-46f0-bffa-d395aeb2a93f", "text": "Q: In C#, how to define a property that accept parameters or a function that return reference as in C++? A: <p>You can use multiple parameters as part of an <a href=\"https://learn.microsoft.com/en-us/dotnet/csharp/programming-guide/indexers/\" rel=\"nofollow noreferrer\">indexer property</a>:</p>\n<pre class=\"lang-cs prettyprint-override\"><code>public uint this[int from, int to]\n{\n    get\n    {\n        int shiftLeft = 8 * sizeof(uint) - 1 - from;\n        int shiftRight = shiftLeft + to;\n        uint nX = (_value &lt;&lt; shiftLeft) &gt;&gt; shiftRight;\n        return nX;\n    }\n}\n</code></pre>\n<p>It's probably best to make your struct immutable and not have any setters at all. Also the C# convention is that fields are prefixed with <code>_</code> only, and local variables are not prefixed at all and both start lowercase.</p>\n", "tags": ["c#", "properties", "assign"]}
