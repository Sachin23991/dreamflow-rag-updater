{"id": "b8c4af01-f8b6-4d4c-b36c-5eda0a2183ee", "text": "Q: Where to find semantic model size A: <p>An update for those who have the same question now.\nAssuming you're using Microsoft Fabric then when viewing the semantic model there's now a model health option in the menu bar:\n<a href=\"https://i.sstatic.net/51U9Ki1H.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/51U9Ki1H.png\" alt=\"screen shot of the model health option\" /></a></p>\n<p>This includes a memory analyser option that will create a python notebook with a pre defined script (uses the sempy library) that will generate a report for you with a number of tabs giving details at table and column level.</p>\n", "tags": ["microsoft-fabric"]}
{"id": "12e440d4-d283-4568-b04b-9e17586e003e", "text": "Q: Setup global providers for Angular unit tests A: <p>There are to approaches to solve this issue:</p>\n<ol>\n<li>Migrate to the <code>unit-test</code> builder and add a <code>providersFile</code></li>\n<li>Setup a <code>test.ts</code> file</li>\n</ol>\n<h2>1. Setup a <code>providersFile</code> in the <code>unit-test</code> builder</h2>\n<p>In Angular v20, experimental support for a <a href=\"https://angular.dev/guide/testing/unit-tests\" rel=\"nofollow noreferrer\">new unit testing system</a> was added. In v21 it was advanced to stable and is now the default for newly generated projects.\nThe main goal of this system is to provide support for other unit test runners such as vitest.\nBut it also has a feature that helps setting up global providers.</p>\n<p>Create a new file <code>src/test-providers.ts</code> and export an array with the providers that you want to have in all unit tests:</p>\n<pre class=\"lang-js prettyprint-override\"><code>import { provideZonelessChangeDetection } from '@angular/core';\n\nexport default [provideZonelessChangeDetection()];\n</code></pre>\n<p>Now update your <code>angular.json</code> and set the <code>providersFile</code> option of the <code>unit-test</code> runner:</p>\n<pre class=\"lang-json prettyprint-override\"><code>{\n  &quot;projects&quot;: {\n    &quot;your-project&quot;: {\n      &quot;architect&quot;: {\n        &quot;test&quot;: {\n          &quot;builder&quot;: &quot;@angular/build:unit-test&quot;,\n          &quot;options&quot;: {\n            &quot;buildTarget&quot;: &quot;::development&quot;,\n            &quot;runner&quot;: &quot;vitest&quot;,\n            &quot;providersFile&quot;: &quot;src/test-providers.ts&quot;,\n            &quot;tsConfig&quot;: &quot;tsconfig.spec.json&quot;\n          }\n        }\n      }\n    }\n  }\n}\n</code></pre>\n<p>Finally, make sure that the file is included in the <code>files</code> array of the <code>tsconfig.spec.json</code>:</p>\n<pre class=\"lang-json prettyprint-override\"><code>{\n  &quot;extends&quot;: &quot;./tsconfig.json&quot;,\n  &quot;compilerOptions&quot;: {\n    &quot;outDir&quot;: &quot;./out-tsc/spec&quot;,\n    &quot;types&quot;: [&quot;@angular/localize&quot;]\n  },\n  &quot;files&quot;: [&quot;src/test-providers.ts&quot;],\n  &quot;include&quot;: [&quot;src/**/*.spec.ts&quot;, &quot;src/**/*.d.ts&quot;]\n}\n</code></pre>\n<h2>2. Setup a <code>test.ts</code> file</h2>\n<p>Older Angular projects used to have a <code>test.ts</code> file where the modules for all tests can be configured.\nApparently in newer Angular projects, this file is not automatically generated anymore.\nHowever, it can be created manually.</p>\n<p>The next challenge is that <code>initTestEnvironment()</code> only accepts modules, no providers.\nTo solve this issue, I created a module with a provider:</p>\n<pre class=\"lang-js prettyprint-override\"><code>import { NgModule, provideZonelessChangeDetection } from '@angular/core';\nimport { getTestBed } from '@angular/core/testing';\nimport {\n  BrowserTestingModule,\n  platformBrowserTesting,\n} from '@angular/platform-browser/testing';\n\n@NgModule({\n  // pre Angular v20, use provideExperimentalZonelessChangeDetection\n  providers: [provideZonelessChangeDetection()],\n})\nclass ZonelessModule {}\n\ngetTestBed().initTestEnvironment(\n  [BrowserTestingModule, ZonelessModule],\n  platformBrowserTesting(),\n);\n</code></pre>\n<p>Now this file needs to be registered in the <code>angular.json</code> via the <code>main</code> option:</p>\n<pre class=\"lang-json prettyprint-override\"><code>{\n  &quot;projects&quot;: {\n    &quot;my-project&quot;: {\n      &quot;architect&quot;: {\n        // ...\n        &quot;test&quot;: {\n          &quot;builder&quot;: &quot;@angular-devkit/build-angular:karma&quot;,\n          &quot;options&quot;: {\n            &quot;main&quot;: &quot;src/test.ts&quot;,\n            &quot;tsConfig&quot;: &quot;tsconfig.spec.json&quot;,\n            &quot;inlineStyleLanguage&quot;: &quot;scss&quot;,\n            &quot;assets&quot;: [\n              {\n                &quot;glob&quot;: &quot;**/*&quot;,\n                &quot;input&quot;: &quot;public&quot;\n              }\n            ],\n            &quot;styles&quot;: [&quot;src/styles.scss&quot;],\n            &quot;scripts&quot;: [],\n            &quot;polyfills&quot;: [&quot;@angular/localize/init&quot;]\n          }\n        }\n      }\n    }\n  }\n}\n</code></pre>\n<p>Finally, the file needs to be added to to the <code>files</code> of the <code>tsconfig.spec.json</code>:</p>\n<pre class=\"lang-json prettyprint-override\"><code>{\n  &quot;extends&quot;: &quot;./tsconfig.json&quot;,\n  &quot;compilerOptions&quot;: {\n    &quot;outDir&quot;: &quot;./out-tsc/spec&quot;,\n    &quot;types&quot;: [&quot;jasmine&quot;, &quot;@angular/localize&quot;]\n  },\n  &quot;files&quot;: [&quot;src/test.ts&quot;],\n  &quot;include&quot;: [&quot;src/**/*.spec.ts&quot;, &quot;src/**/*.d.ts&quot;]\n}\n</code></pre>\n", "tags": ["angular", "unit-testing", "karma-jasmine", "angular-unit-test", "angular-zoneless"]}
{"id": "40ba4449-be1d-4eab-9ff3-58c083fe05f7", "text": "Q: How To Handle Generic Type Changing As You Move Up The Call Stack When Using The Result Pattern A: <p>I think the Result Type is a good fit for the outmost layer. Although it might not be the perfect choice as general decorator for the return values downstream.</p>\n<p>If you want a more functional approach in your code (which I would totally recommend) I would suggest to consider the other well established types (monads) like Maybe&lt;T&gt;, Eighter&lt;T1,T2&gt;.</p>\n<p>Having to map values in the controller is independently a good idea as using DTOs serves as a layer of abstraction that comes very handy when you need to handle breaking changes.</p>\n", "tags": ["c#", ".net", "error-handling"]}
{"id": "d2dfb0b6-24bc-49d0-a8ed-c49160cee475", "text": "Q: How to change theme style (User Interface Style) immediately in Swift in iOS 13 A: <h5>The SwiftUI way (No UIKit)</h5>\n<p>3 simple steps:</p>\n<ol>\n<li>Make an storable theme</li>\n<li>Feed the app entrance with this value</li>\n<li>Make the change from anywhere you like</li>\n</ol>\n<pre><code>enum SupportingThemes: String, CaseIterable { // \ud83d\udc48 Define your supporting schemes\n    case light\n    case dark\n    case system\n\n    var colorScheme: ColorScheme? { // \ud83d\udc48 A helper for ease of use\n        switch self {\n        case .light: .light\n        case .dark: .dark\n        case .system: nil \n        }\n    }\n}\n\n@main\nstruct SUPlaygroundApp: App {\n    @AppStorage(&quot;Theme&quot;) var theme: SupportingThemes = .system // \ud83d\udc48 Depend on a single source of truth\n\n    var body: some Scene {\n        WindowGroup {\n            ContentView()\n                .preferredColorScheme(theme.colorScheme) // \ud83d\udc48 Feed the root view\n        }\n    }\n}\n</code></pre>\n<p>You can now change it from anywhere using the <code>AppStorage</code> or directly with the <code>UserDefaults</code>:</p>\n<pre><code>UserDefaults.standard.set(&quot;dark&quot;, forKey: &quot;Theme&quot;)\n</code></pre>\n<hr />\n<h5>Original Answer</h5>\n<p>This code is instant and there is no need to restart the app!</p>\n<p>You just need to call the code on user interaction with <strong>notification observer</strong> pattern or directly call the function.</p>\n<p>But the point is to access the visible window and <code>overrideUserInterfaceStyle</code> there. So for example you can set it from any visible <code>view</code> like:</p>\n<pre><code>view.window?.overrideUserInterfaceStyle = .dark\n</code></pre>\n<h3>Deprecated but working method</h3>\n<pre><code>// Because you are using AppDelegate for this: (But it is going to be deprecated. read the following Note)\n(UIApplication.shared.delegate as! AppDelegate).myFunctionThatChangesTheUserInterfaceStyle()\n</code></pre>\n<p>Also <strong>note that</strong> since iOS 13, the key window is not a part of appDelegate anymore and you should <a href=\"https://stackoverflow.com/questions/58547907/swift-ios13-access-scenedelegate-window-variable-in-a-viewcontroller/58547992#58547992\">access it from sceneDelegate</a></p>\n", "tags": ["ios", "swift", "ios-darkmode"]}
{"id": "d36825e2-0381-41b3-b175-7ebb3570ea7c", "text": "Q: VBA Excel: How to assign range of cells to another range of cells? A: <p>Use <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196261.aspx\" rel=\"nofollow\">Application.Transpose()</a>:</p>\n\n<pre><code>Worksheets(\"Master\").Range(\"D14:F14\").Value = Application.Transpose(Worksheets(\"Temp\").Range(\"B12:B14\").Value)\n</code></pre>\n\n<p>Or <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839476.aspx\" rel=\"nofollow\">PasteSpecial</a>:</p>\n\n<pre><code>Worksheets(\"Temp\").Range(\"B12:B14\").Copy\nWorksheets(\"Master\").Range(\"D14\").PasteSpecial xlPasteAll, , , True\n</code></pre>\n\n<p>If you only want values then the first is best.  When transposing with <code>PasteSpecial</code> one must use the <code>xlPasteAll</code>.  It will throw an error if one tries to paste values only with transpose as true.</p>\n", "tags": ["vba", "excel"]}
{"id": "8890048e-ffc3-4641-9a61-293eeefa0a19", "text": "Q: SUM above x Cells based on value in Reference Cell A: <p>or from top:</p>\n\n<pre><code>=INDEX(QUERY(QUERY(C1:C9, \"limit \"&amp;C10), \"select sum(Col1)\"), 2)\n</code></pre>\n\n<p><a href=\"https://i.sstatic.net/lbKiR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/lbKiR.png\" alt=\"0\"></a></p>\n\n<p>and bottom:</p>\n\n<pre><code>=INDEX(QUERY(QUERY(C1:C9, \"offset \"&amp;9-C10), \"select sum(Col1)\"), 2)\n</code></pre>\n\n<p><a href=\"https://i.sstatic.net/Tyecu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/Tyecu.png\" alt=\"enter image description here\"></a></p>\n\n<h2>___________________________________________________</h2>\n\n<h2>also doable as:</h2>\n\n<p>from top:</p>\n\n<pre><code>=SUM(QUERY(C1:C9, \"limit \"&amp;C10))\n</code></pre>\n\n<p>from bottom:</p>\n\n<pre><code>=SUM(QUERY(C1:C9, \"offset \"&amp;9-C10))\n</code></pre>\n", "tags": ["google-sheets", "sum", "google-sheets-formula", "google-sheets-query", "gs-vlookup"]}
{"id": "1eba1f33-b095-4eba-9d67-2515bdfa098e", "text": "Q: Saving content of TPaintBox Canvas to a Bitmap (and/or a file) in Delphi 10.3 Firemonkey A: <p>If you just want to save &quot;everything you see&quot; to a file, use this function and pass the Form</p>\n<p>( Solves the issue of paintbox drawing, Shapes and ComboBox content not saving using simple Form.SavetoFile() )</p>\n<pre><code> function TForm2.SaveComponentToJPeg(mControl: TWinControl): TJpegImage;\nvar\n  bmp: TPicture;\n  jpg : TJpegImage;\n  dc: HDC;\n  wnd: HWND;\nbegin\n  bmp:=TPicture.Create;\n  jpg := TJpegImage.create;\n  jpg.CompressionQuality:= 100; //highest, going to see on BIG screen\n  jpg.Performance:= jpBestQuality;\n  jpg.ProgressiveEncoding:= True;\n  jpg.ProgressiveDisplay:= True;\n  // (Fullscreen HD filesize approx 1MB)\n  try\n    bmp.Bitmap.Width  := mControl.ClientWidth;\n    bmp.Bitmap.Height := mControl.ClientHeight;  // Deduct for border.\n    wnd               := mControl.Handle;  //ActiveWindow;\n    dc                := GetDc(wnd);\n    // save everything visible to bmp\n    BitBlt(bmp.Bitmap.Canvas.Handle,0,0,bmp.Width,bmp.Height,dc,0,0,SrcCopy);\n    ReleaseDc(wnd, dc);\n    // and convert to high quality jpg\n    jpg.assign(bmp.bitmap);\n    result := jpg\n  finally\n    bmp.Free;\n  end;\nend;\n</code></pre>\n", "tags": ["delphi", "canvas", "bitmap", "firemonkey"]}
