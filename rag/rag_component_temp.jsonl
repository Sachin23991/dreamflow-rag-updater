{"id": "f5a92078-abb6-44ae-9fed-cb4f58453312", "text": "Q: How to hide UI elements in a custom frontend based on Dataverse security roles when using MSAL authentication? A: <p>Dataverse doesn\u2019t expose a supported API for client apps to enumerate a user\u2019s role privileges, and Microsoft explicitly discourages using system tables like `roleprivileges` or `privilege` from unprivileged clients. Those tables are reserved for administrative operations and require elevated permissions that a normal user token should never hold. The [Dataverse security model](<a href=\"https://learn.microsoft.com/power-platform/admin/security-model\" rel=\"nofollow noreferrer\">https://learn.microsoft.com/power-platform/admin/security-model</a>) is enforced server\u2011side, not meant to drive UI logic directly. The platform guarantees that any operation attempted through the Web API will be authorized according to the user\u2019s roles, so the secure pattern is to let Dataverse enforce access and have your frontend infer capability from allowed API responses rather than from raw privilege data.</p>\n<p>In practice, the common approach is to introduce a lightweight backend or API layer that calls Dataverse using the user\u2019s delegated token, attempts a metadata query or a minimal \u201cwho\u2011am\u2011I\u201d style check, and returns coarse\u2011grained capability flags to the SPA (for example, `{ canCreateProject: true }`). The frontend then hides or shows controls based on those flags. This keeps Dataverse as the single source of truth while avoiding privilege leakage. If you want richer claims in tokens, you can map Dataverse roles to [Azure AD app roles or custom claims](<a href=\"https://learn.microsoft.com/entra/identity-platform/howto-add-app-roles-in-apps\" rel=\"nofollow noreferrer\">https://learn.microsoft.com/entra/identity-platform/howto-add-app-roles-in-apps</a>) through your own backend logic, but that mapping must be maintained outside Dataverse. There\u2019s no built\u2011in way for MSAL or Entra ID to emit Dataverse role data in tokens. In short, don\u2019t read privilege metadata from the browser; proxy or infer permissions through a trusted backend and let Dataverse continue to enforce authorization.</p>\n", "tags": ["authentication", "security", "azure-active-directory", "azure-ad-msal", "dataverse"]}
{"id": "4da5f211-ecec-42ba-8b70-88994bc85d5a", "text": "Q: Jest Typescript with ES Module in node_modules error - Must use import to load ES Module: A: <p>For me, I was using jest with typescript, and es module.</p>\n<p>I got a fix:</p>\n<p>The &quot;type&quot;: &quot;module&quot; in package.json, makes Node.js treat .js files as ES modules, but Jest isn't configured to handle this properly with TypeScript.</p>\n<h2>Step 1: Rename the config file</h2>\n<p>Rename <code>jest.config.js</code> to <code>jest.config.mjs</code> (the <code>.mjs</code> extension tells Node.js it's an ES module)</p>\n<h2>Step 2: Update jest.config.mjs</h2>\n<pre class=\"lang-js prettyprint-override\"><code>/** @type {import(&quot;jest&quot;).Config} **/\nexport default {\n  preset: &quot;ts-jest/presets/default-esm&quot;,\n  testEnvironment: &quot;node&quot;,\n  roots: [&quot;./tests&quot;],\n  extensionsToTreatAsEsm: [&quot;.ts&quot;],\n  moduleNameMapper: {\n    &quot;^(\\\\.{1,2}/.*)\\\\.js$&quot;: &quot;$1&quot;,\n  },\n  transform: {\n    &quot;^.+\\\\.ts$&quot;: [\n      &quot;ts-jest&quot;,\n      {\n        useESM: true,\n      },\n    ],\n  },\n  moduleFileExtensions: [&quot;ts&quot;, &quot;js&quot;, &quot;json&quot;, &quot;node&quot;],\n  testMatch: [&quot;**/tests/**/*.test.ts&quot;],\n  verbose: true,\n};\n</code></pre>\n<h2>Step 3: Update package.json scripts</h2>\n<p>(I used tsx instead of ts-node, and pnpm instead of npm)</p>\n<pre class=\"lang-json prettyprint-override\"><code>{\n  &quot;scripts&quot;: {\n    &quot;dev&quot;: &quot;tsx src/server.ts&quot;,\n    &quot;build&quot;: &quot;tsc&quot;,\n    &quot;start&quot;: &quot;node dist/server.js&quot;,\n    &quot;test&quot;: &quot;node --experimental-vm-modules node_modules/jest/bin/jest.js&quot;,\n    &quot;test:watch&quot;: &quot;node --experimental-vm-modules node_modules/jest/bin/jest.js --watch&quot;,\n    &quot;test:coverage&quot;: &quot;node --experimental-vm-modules node_modules/jest/bin/jest.js --coverage&quot;\n  }\n}\n</code></pre>\n<h2>Step 4: Add/update tsconfig.json</h2>\n<p>Make sure your <code>tsconfig.json</code> has these settings:</p>\n<pre class=\"lang-json prettyprint-override\"><code>{\n  &quot;compilerOptions&quot;: {\n    &quot;target&quot;: &quot;ES2022&quot;,\n    &quot;module&quot;: &quot;ES2022&quot;,\n    &quot;moduleResolution&quot;: &quot;node&quot;,\n    &quot;esModuleInterop&quot;: true,\n    &quot;allowSyntheticDefaultImports&quot;: true,\n    &quot;strict&quot;: true,\n    &quot;skipLibCheck&quot;: true,\n    &quot;outDir&quot;: &quot;./dist&quot;,\n    &quot;rootDir&quot;: &quot;./src&quot;\n  },\n  &quot;include&quot;: [&quot;src/**/*&quot;],\n  &quot;exclude&quot;: [&quot;node_modules&quot;, &quot;dist&quot;, &quot;tests&quot;]\n}\n</code></pre>\n<p>Hopefully this should resolve the issue!</p>\n", "tags": ["node.js", "typescript", "jestjs", "es6-modules"]}
{"id": "facfc5e1-253b-4644-b660-4a949a94431e", "text": "Q: Include Key AND salt for signing JWT in NestJS A: <p>\ud83d\udc4b</p>\n<h2><strong>Short anwser :</strong></h2>\n<p>For anyone still wandering, there is no salt option for the jwt signature. The reason is simple : the signature is already salted by the <code>iat</code> property in the payload (see <a href=\"https://datatracker.ietf.org/doc/html/rfc7519#section-4.1.6\" rel=\"nofollow noreferrer\">RFC7519 at section 4.1.6</a>).</p>\n<h2><strong>Explanation :</strong></h2>\n<p>The point of a salt is to prevent comparison between 2 hashes hashing the same value.</p>\n<blockquote>\n<p>For example, if a company gets its database full of password hashes leaked. The attackers can take a hash, and compare it to every other hashes :</p>\n<ul>\n<li><p>My password is <code>abc</code>, hashed with an unknown algorithm, it becomes <code>60a0cc995ee7305be8</code></p>\n</li>\n<li><p>The password of my friend is also <code>abc</code>, so its hash is also <code>60a0cc995ee7305be8</code></p>\n</li>\n<li><p>The attackers see in the leaked database 2 same hashes. They know that if they can break one (e.g. by bruteforce or lookup tables), they'll be able to login to both accounts.</p>\n</li>\n</ul>\n</blockquote>\n<p>To avoid that, we add a &quot;salt&quot; : a little bit of random data that will completely change the hash. We store it with the hash.</p>\n<blockquote>\n<p>For example, my password <code>abc</code> with the salt <code>1a7af606</code> becomes <code>a2a73afe8902258cb4</code><br />\nMy friend's with the salt <code>f614085c</code> becomes <code>ce1b1758d685f833cb</code></p>\n<p>Theses hashes are completely different. So for our server to be able to verify the passwords, we store the salts as well in the database. We will use the syntax <code>hash:salt</code> but for example bcrypt, a hash algorithm created in 1999 and still secure today, uses the syntax <code>$algorithm$rounds$salt.hash</code> (see <a href=\"https://en.wikipedia.org/wiki/Bcrypt\" rel=\"nofollow noreferrer\">Bcrypt</a>).<br />\nSo we get : <code>a2a73afe8902258cb4:1a7af606</code> for me, and <code>ce1b1758d685f833cb:f614085c</code> for my friend.</p>\n<p>It's impossible for an attacker to tell that these two hashes are the &quot;same&quot;. But for the server, there is no problem to verify the authenticity of a password. It is more secured.</p>\n</blockquote>\n<p>In every jwt payload (unless if you edited it), there is a field called <code>iat</code> (for &quot;Issued At&quot;). It is the timestamp of the creation of the token. --&gt; Because it is changing all the time, making the signature completely different, <strong>it is our salt</strong> <strong>!</strong> So there is no need for another. \ud83d\udc4d</p>\n<hr />\n", "tags": ["phoenix-framework", "nestjs", "jwt"]}
{"id": "7ab94720-68d4-4b8a-902b-e3614191bf97", "text": "Q: Postgres: Inserting rows into table with foreign key A: <p>in my case, the owner with which the schema dump was imported into database was not having rds_superuser role. 'grant rds_superuser to &lt;owner&gt;;' fixed the permission denied error</p>\n", "tags": ["sql", "postgresql"]}
{"id": "dcebb113-1cbd-4e80-881d-416b4eeb0e5f", "text": "Q: C++ convert integer to string at compile time A: <p>Starting from C++23, <a href=\"https://en.cppreference.com/w/cpp/utility/to_chars.html\" rel=\"nofollow noreferrer\"><code>std::to_chars</code></a> is <code>constexpr</code>.</p>\n<p>You can do (<a href=\"https://godbolt.org/z/scfrMEa47\" rel=\"nofollow noreferrer\">https://godbolt.org/z/scfrMEa47</a>)</p>\n<pre><code>constexpr std::string my_to_string(auto n) {\n    std::array&lt;char, 30&gt; buffer;\n    auto [ptr, ec] = std::to_chars(buffer.begin(), buffer.end(), n);\n    assert(ec == std::errc{});\n    return std::string(buffer.begin(), ptr);\n}\n</code></pre>\n<p>but in order to guarantee that the string is computed in compile-time, you need <code>make_string_view</code> as below (or <a href=\"https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2025/p3491r1.html\" rel=\"nofollow noreferrer\"><code>define_static_string</code></a>, but it's not available yet).</p>\n<hr />\n<p><strong>Old answer:</strong></p>\n<p>With static constexpr member of function, <a href=\"https://stackoverflow.com/a/62596471/5267751\">this answer</a> can be simplified to</p>\n<pre><code>#include &lt;array&gt;\n#include &lt;string&gt;\n#include &lt;vector&gt;\n#include &lt;algorithm&gt;\n#include &lt;iostream&gt;\n\ntemplate &lt;auto string_producer&gt;\nconstexpr /* strangely, if this is changed to consteval, clang outputs null */ auto make_string_view() {\n    static constexpr auto result = []{\n        std::array&lt;char, string_producer().length() + 1&gt; result {};\n        std::copy_n(string_producer().data(), result.size() - 1, result.begin());\n        return result;\n    }();\n    return std::string_view(result.begin(), result.end() - 1);\n}\n\nconstexpr std::string my_to_string(auto N) {\n    // return std::to_string(N); // doesn't work\n    if (N == 0) return &quot;0&quot;;\n    if constexpr (std::is_signed_v&lt;decltype(N)&gt;) if (N &lt; 0) return &quot;-&quot; + my_to_string(-static_cast&lt;std::make_unsigned_t&lt;decltype(N)&gt;&gt;(N));\n    return my_to_string(N / 10) + char('0' + N % 10);\n}\n\ntemplate&lt;int N&gt;\nconstexpr const char* foo =  make_string_view&lt;[]{ return my_to_string(N); }&gt;().data();\n\nint main() {\n    std::cout &lt;&lt; foo&lt;123456&gt;;\n}\n</code></pre>\n<p>Godbolt link for disaassembly, proving that everything is computed in compile time: <a href=\"https://godbolt.org/z/Kdx9Ka8vf\" rel=\"nofollow noreferrer\">https://godbolt.org/z/Kdx9Ka8vf</a></p>\n<p>note that the data is put in <code>result</code> static constexpr variable inside <code>make_string_view()</code>. If you want to return a <code>string_view</code> instead, just delete the <code>.data()</code>.</p>\n", "tags": ["c++", "string", "templates", "boost", "boost-mpl"]}
{"id": "a52552ad-2de9-4729-8a2e-913964eff073", "text": "Q: Flutter Code Coverage Not Working When Running Appium Automation (Port Not Free) A: <p>Thanks for the Response Md Yeasin.. tried killing port 4726 not helped but my problem solved just just by changing the Execution Sequence .</p>\n<p>.1&gt; first started Appium Automation test Setup</p>\n<p>2&gt; start Flutter app</p>\n<p>3&gt; start code coverage</p>\n", "tags": ["flutter", "unit-testing", "automation", "code-coverage", "appium-android"]}
{"id": "9541c265-81fa-416d-8dbe-4cf8a71e39bd", "text": "Q: FFmpeg: How to convert horizontal video 16:9 to vertical video 9:16, with blurred background on top and bottom sides A: <p>How do I do this with 16:9 with black bars on the sides?</p>\n", "tags": ["video", "ffmpeg"]}
{"id": "75c158a7-c8d1-4aa7-814a-dd39b02a420f", "text": "Q: Not a valid origin for the client from Google API Oauth A: <p>I waited a few minutes after adding my origin and tried again, and it worked.</p>\n<p>It says in on the &quot;Client ID for Web application&quot; page:</p>\n<blockquote>\n<p>Note: It may take 5 minutes to a few hours for settings to take effect</p>\n</blockquote>\n<p>I hadn't seen that at first and got very confused why I was getting origin mismatch errors.</p>\n<p>I never got localhost working though - I had to use <code>ngrok</code> as explained in this answer: <a href=\"https://stackoverflow.com/a/71699545/345648\">https://stackoverflow.com/a/71699545/345648</a></p>\n", "tags": ["javascript", "oauth-2.0", "google-oauth"]}
