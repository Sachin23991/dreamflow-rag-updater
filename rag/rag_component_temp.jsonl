{"id": "85743e9d-6953-430c-bfe7-cfa93e59ea74", "text": "Q: Insert output from asynchronous process into buffer without scrolling to the end A: <p>Based on the answer from @nslamberth, I've made this function to create a non-scrolling process filter, taking an argument to configure the behaviour at the beginning of the buffer. I've also ensured the process can write to read-only buffers.</p>\n<pre><code>(defun make-sticky-process-filter (&amp;optional initially-stay)\n  &quot;Create a process filter that outputs to buffer without moving point.\nIf INITIALLY-STAY is non-nil, point stays in place if it is at `bobp' even if this is also the position of the `process-mark'&quot;\n  (lambda (proc string)\n    (:documentation (format &quot;Process filter that outputs to buffer without moving point. If point %s, it follows the insertion. Otherwise it stays in place.&quot;\n                            (if initially-stay\n                                &quot;is at the position that text is inserted, and is not at the beginning of the buffer&quot;\n                              &quot;is at the position that text is inserted&quot;)))\n    (when (buffer-live-p (process-buffer proc))\n      (with-current-buffer (process-buffer proc)\n        (let ((moving (and (= (point) (process-mark proc))\n                           (not (and initially-stay (bobp))))))\n          (save-excursion\n            (goto-char (process-mark proc))\n            (let ((inhibit-read-only t))\n              (insert string))\n            (set-marker (process-mark proc) (point)))\n          (when moving (goto-char (process-mark proc))))))))\n</code></pre>\n<p>If you call <code>(make-sticky-process-filter nil)</code>, you get a filter that keeps point in place unless point is exactly where the process is inserting new text. This means if you start a process in an empty buffer, point will be at the end as the process runs, because in an empty buffer, point is guaranteed to be at the insertion position.</p>\n<p>If you call  <code>(make-sticky-process-filter t)</code>, you get a filter just like the above, except it also keeps point in place if it's at the beginning of the buffer. This means if you start a process in an empty buffer, point will stay at the beginning until the user manually moves it. Unfortunately this could be inconsistent if the process inserts text before the filter is attached, so make sure you use <code>make-process</code> rather than <code>start-process</code> to guarantee the filter is there from the start.</p>\n", "tags": ["elisp"]}
{"id": "94390686-ed5a-4745-8cd8-e1924afc09c6", "text": "Q: how do you get a deep partial of a Zod nested schema, such that all feilds and nested objects are optional? A: <p>This problem has already been discussed in the Zod community (see issue <a href=\"https://github.com/colinhacks/zod/issues/2854\" rel=\"nofollow noreferrer\">#2854</a> and discussion <a href=\"https://github.com/colinhacks/zod/discussions/2527\" rel=\"nofollow noreferrer\">#2527</a>). Several workarounds were proposed, but the most robust solution so far is the <strong><code>zod-deep-partial</code></strong> package, which is specifically designed to solve this exact problem.</p>\n<p>The package is under active development, supports <strong>Zod v4</strong>, and importantly, correctly updates both the <strong>runtime schema</strong> and the <strong>inferred TypeScript types</strong>, so everything stays in sync.</p>\n<p>You can install it from npm:\n<a href=\"https://www.npmjs.com/package/zod-deep-partial\" rel=\"nofollow noreferrer\">https://www.npmjs.com/package/zod-deep-partial</a></p>\n<h3>Example usage</h3>\n<pre class=\"lang-ts prettyprint-override\"><code>import { z } from &quot;zod&quot;;\nimport { zodDeepPartial } from &quot;zod-deep-partial&quot;;\n\n// 1. Define your base schema\nconst userSchema = z.object({\n  name: z.string(),\n  email: z.string().email(),\n  profile: z.object({\n    bio: z.string(),\n    avatar: z.string().url(),\n  }),\n  tags: z.array(z.string()),\n});\n\n// 2. Create the deep partial schema\nconst partialUserSchema = zodDeepPartial(userSchema);\n\n// 3. Use the partial schema for validation\n\n// All of these are now valid:\npartialUserSchema.parse({}); // \u2705\npartialUserSchema.parse({ name: &quot;John Doe&quot; }); // \u2705\npartialUserSchema.parse({ profile: {} }); // \u2705\npartialUserSchema.parse({ profile: { bio: &quot;A developer&quot; } }); // \u2705\npartialUserSchema.parse({ tags: [&quot;developer&quot;] }); // \u2705\n\n// Type inference is preserved\ntype PartialUser = z.infer&lt;typeof partialUserSchema&gt;;\n/*\n{\n  name?: string | undefined;\n  email?: string | undefined;\n  profile?: {\n    bio?: string | undefined;\n    avatar?: string | undefined;\n  } | undefined;\n  tags?: (string | undefined)[] | undefined;\n}\n*/\n</code></pre>\n<h3>Links</h3>\n<ul>\n<li>npm: <a href=\"https://www.npmjs.com/package/zod-deep-partial\" rel=\"nofollow noreferrer\">https://www.npmjs.com/package/zod-deep-partial</a></li>\n<li>GitHub: <a href=\"https://github.com/amirfarzamnia/zod-deep-partial\" rel=\"nofollow noreferrer\">https://github.com/amirfarzamnia/zod-deep-partial</a></li>\n<li>Docs: <a href=\"https://amirfarzamnia.github.io/zod-deep-partial/\" rel=\"nofollow noreferrer\">https://amirfarzamnia.github.io/zod-deep-partial/</a></li>\n</ul>\n", "tags": ["node.js", "typescript", "zod"]}
{"id": "ee4107f4-10e8-4261-acb6-d7402f55dcde", "text": "Q: How to change color of TEdit when focused A: <p>You can use OnEnter and OnExit methods of the TEdit</p>\n<p>in OnEnter method</p>\n<pre><code>(Sender as TEdit).Color :=  clSelectedColor\n</code></pre>\n<p>in OnExit method</p>\n<pre><code>(Sender as TEdit).Color := TStyleManager.ActiveStyle.GetSystemColor(clWindow);\n</code></pre>\n", "tags": ["background-color", "firemonkey", "onfocus"]}
{"id": "644c66d8-ebdb-4f5f-a6dc-fdddf0308fad", "text": "Q: Styling input range for webkit with pure CSS A: <p>I got a solution that does not use a style tag but a <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/Using_CSS_custom_properties\" rel=\"nofollow noreferrer\">CSS variable</a>:</p>\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\" data-babel-preset-react=\"false\" data-babel-preset-ts=\"false\">\n<div class=\"snippet-code\">\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>const input = document.querySelector(\"input\");\n\nfunction setBackgroundSize(input) {\n  input.style.setProperty(\"--background-size\", `${getBackgroundSize(input)}%`);\n}\n\nsetBackgroundSize(input);\n\ninput.addEventListener(\"input\", () =&gt; setBackgroundSize(input));\n\nfunction getBackgroundSize(input) {\n  const min = +input.min || 0;\n  const max = +input.max || 100;\n  const value = +input.value;\n\n  const size = (value - min) / (max - min) * 100;\n\n  return size;\n}</code></pre>\n<pre class=\"snippet-code-css lang-css prettyprint-override\"><code>input[type='range'] {\n  width: 400px;\n}\n\ninput[type='range'],\ninput[type='range']::-webkit-slider-runnable-track,\ninput[type='range']::-webkit-slider-thumb {\n  -webkit-appearance: none;\n}\n\ninput[type='range']::-webkit-slider-runnable-track {\n  height: 3px;\n  background: linear-gradient(to right, #293043, #293043), #D7D7D7;\n  background-size: var(--background-size, 0%) 100%;\n  background-repeat: no-repeat;\n  border-radius: 5px;\n\n}\n\ninput[type='range']::-webkit-slider-thumb {\n  width: 15px;\n  height: 15px;\n  cursor: pointer;\n  background: #293043;\n  border: solid white 1px;\n  border-radius: 50%;\n  margin-top: -6px;\n  box-shadow: 0px 1px 3px rgba(0, 0, 0, 0.4);\n}\n\n/** FF*/\n\ninput[type=\"range\"]::-moz-range-progress {\n  background-color: #293043;\n  border-radius: 5px;\n}\n\ninput[type=\"range\"]::-moz-range-track {\n  background-color: #D7D7D7;\n  border-radius: 5px;\n}\n\ninput[type=\"range\"]::-moz-range-thumb {\n  width: 15px;\n  height: 15px;\n  cursor: pointer;\n  background: #293043;\n  border: solid white 1px;\n  border-radius: 50%;\n  margin-top: -6px;\n  box-shadow: 0px 1px 3px rgba(0, 0, 0, 0.4);\n}</code></pre>\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;input type=\"range\" min=\"5\" max=\"95\" step=\"1\" value=\"15\"&gt;</code></pre>\n</div>\n</div>\n</p>\n<p>This works on Chrome and Firefox :).</p>\n", "tags": ["css", "html", "pseudo-element", "input-type-range"]}
