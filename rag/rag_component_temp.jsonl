{"id": "ba32d370-6546-404a-9581-177d46961130", "text": "Q: Installing Jenkins Plugins to Docker Jenkins A: <p>I can't read your screenshots, but you don't seem to be following the official instructions. See <a href=\"https://github.com/jenkinsci/docker\" rel=\"nofollow noreferrer\">https://github.com/jenkinsci/docker</a> under &quot;Installing more tools&quot;. Note:</p>\n<ul>\n<li>You should save the plugins to <code>/usr/share/jenkins/ref/plugins</code></li>\n<li>You could use a <code>plugins.txt</code> file instead, which contains the names of your plug-ins, and you can process with the provided <code>jenkins-plugin-cli</code> CLI tool. This looks like:</li>\n</ul>\n<pre class=\"lang-none prettyprint-override\"><code>COPY plugins.txt /usr/share/jenkins/ref/plugins.txt\nRUN jenkins-plugin-cli -f /usr/share/jenkins/ref/plugins.txt\n</code></pre>\n<p>I think the reason your approach wasn't working was to do with some processing in the start-up script.</p>\n", "tags": ["linux", "jenkins", "docker", "dockerfile"]}
{"id": "0c79e3f7-0d4b-4c5d-8c18-37f470160200", "text": "Q: How and why would I write a class that extends null? A: <p>A class that <code>extends null</code> is a perfectly ordinary class with its own instance prototype, where it can define instance methods and accessors.  It just happens not to inherit from <code>Object.prototype</code>.  As for why you would want to have such a thing in the first place, I can think of two benefits:</p>\n<ul>\n<li>to withhold primitive conversions like <code>toString</code>, <code>valueOf</code>, and implicit conversions (those will throw <code>TypeError</code>)</li>\n<li>to detect bugs such as code doing <code>obj.hasOwnProperty(key)</code> instead of <code>Object.hasOwn(obj, key)</code>, or <code>obj instanceof Object</code> instead of <code>typeof obj === 'function' || typeof obj === 'object' &amp;&amp; obj !== null</code>, etc.</li>\n</ul>\n<p>It\u2019s rather silly to treat an <code>extends null</code> class as a key-value mapping.  For that, an ordinary <code>Object.create(null)</code> should suffice (it does not have an extraneous prototype), if for whatever reason you cannot just use a <code>Map</code>.</p>\n<hr />\n<p>Using <code>null</code> in the <code>extends</code> clause was <em>meant</em> to work, and this is evident from reading the original ECMAScript 6 specification, where there is a specific carve-out that allows <code>extends null</code> classes to be declared (<a href=\"https://262.ecma-international.org/6.0/#sec-runtime-semantics-classdefinitionevaluation\" rel=\"nofollow noreferrer\">ECMA-262 6th Ed. \u00a714.5.4</a>, steps 6.e\u2013f), where it would otherwise have been a <code>TypeError</code>.  That such classes cannot be normally <em>constructed</em> was an oversight on the part of the committee.  The reason is rather subtle and tedious, and has to do with the details of how inheritance works in ECMAScript.</p>\n<p>ECMAScript divides classes into two kinds: \u201cbase\u201d (those declared without an <code>extends</code> clause) and \u201cderived\u201d (those declared <em>with</em> one).  \u201cDerived\u201d classes must invoke the superclass constructor in their own constructor, either by using <code>super(...)</code> or implicitly, when the constructor declaration is omitted; \u201cbase\u201d classes have no superclass constructor to invoke and <em>must not</em> perform a <code>super(...)</code> call.</p>\n<p>Now, inheritance works along two lanes:</p>\n<ul>\n<li><p>On one lane, the instance prototype of the subclass (the object held in its <code>.prototype</code> property) has as its own prototype the instance prototype of the superclass.  This ensures that:</p>\n<ul>\n<li>Subclass instances inherit instance methods from the superclass, and</li>\n<li>Subclass instances are considered instances of the superclass (in the sense of the <code>instanceof</code> operator).</li>\n</ul>\n<p>\u201cBase\u201d classes have <code>Object.prototype</code> as their instance prototype prototype (and their instances are therefore <code>instanceof Object</code>).</p>\n</li>\n<li><p>On the other lane, the subclass object <em>itself</em> has the superclass object as its prototype.  This ensures that:</p>\n<ul>\n<li>Static methods of the superclass are inherited by the subclass, and</li>\n<li>The subclass is able to locate and invoke the superclass constructor.</li>\n</ul>\n<p>The invocation of the superclass constructor only happens for \u201cderived\u201d classes (those with an <code>extends</code> clause).  Classes without an <code>extends</code> clause skip the superclass constructor call, and have <code>Function.prototype</code> (which is not a constructor) as their prototype, like normal functions.</p>\n</li>\n</ul>\n<p>The above prose may have been hard to follow; it\u2019s probably much clearer on a diagram.  A series of declarations like this:</p>\n<pre class=\"lang-js prettyprint-override\"><code>class Base {}\nclass Derived extends Base {}\nclass Further extends Derived {}\n</code></pre>\n<p>results in an object graph illustrated below:</p>\n<pre class=\"lang-none prettyprint-override\"><code>LEGEND:\n\u2550\u2550\u2550\u25b6  [[Prototype]] slot\n\u2500\u2500\u2500\u2192  .prototype property\n\u254c\u254c\u254c\u2192  constructor for                             null\n                                                   \u25b2\n     \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e          \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2568\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n     \u2502  Function.prototype  \u255e\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u25b6  Object.prototype  \u2502\n     \u2570\u2500\u2500\u2500\u2500\u25b2\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f          \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b2\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\n          \u2551                                        \u2551\n     \u256d\u2500\u2500\u2500\u2500\u2568\u2500\u2500\u2500\u256e                          \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2568\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n     \u2502  Base  \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2192  Base.prototype  \u2502\n     \u2570\u2500\u2500\u2500\u2500\u25b2\u2500\u252c\u2500\u256f                          \u2570\u2500\u2500\u25b2\u2500\u2500\u2500\u2500\u2500\u2500\u25b2\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\n          \u2551 \u2506                 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2568\u2500\u2500\u2500\u256e  \u2551\n          \u2551 \u2570\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u2192  new Base(...)  \u2502  \u2551\n  super() \u2551                   \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f  \u2551\n     \u256d\u2500\u2500\u2500\u2500\u2568\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e               \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2568\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n     \u2502    Derived     \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2192  Derived.prototype  \u2502\n     \u2502  extends Base  \u2502               \u2570\u2500\u2500\u2500\u2500\u2500\u25b2\u2500\u2500\u2500\u2500\u2500\u2500\u25b2\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\n     \u2570\u2500\u2500\u2500\u2500\u25b2\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f    \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2568\u2500\u2500\u2500\u256e  \u2551\n          \u2551 \u2570\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u2192  new Derived(...)  \u2502  \u2551\n  super() \u2551                \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f  \u2551\n     \u256d\u2500\u2500\u2500\u2500\u2568\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e            \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2568\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n     \u2502      Further      \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2192  Further.prototype  \u2502\n     \u2502  extends Derived  \u2502            \u2570\u2500\u2500\u2500\u2500\u2500\u25b2\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\n     \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2568\u2500\u2500\u2500\u256e\n            \u2570\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u2192  new Further(...)  \u2502\n                           \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\n</code></pre>\n<p>The <code>extends null</code> case is handled specially, but\u2026 not specially enough.  The prototype of the instance prototype is made <code>null</code>, and the prototype of the class is <code>Function.prototype</code>, but the class is still treated as a \u201cderived\u201d class that should invoke its superclass constructor\u2026 which is not a constructor at all.  And <em>this</em> is what causes problems.</p>\n<pre class=\"lang-none prettyprint-override\"><code>                                                         null\n                                                         \u25b2  \u25b2\n         \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e    \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2568\u256e \u2551\n  \u256d\u254c\u254c\u254c\u254c\u254c\u254c\u2524  Function.prototype  \u255e\u2550\u2550\u2550\u2550\u25b6  Object.prototype  \u2502 \u2551\n  \u2506      \u2570\u2500\u2500\u2500\u2500\u25b2\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f    \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2551\n  \u2506           \u2551                                             \u2551\n  \u2506           \u2551                                             \u2551\n  \u2506   super() \u2551                                             \u2551\n  \u2506      \u256d\u2500\u2500\u2500\u2500\u2568\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e                  \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2568\u2500\u2500\u256e\n  \u2506      \u2502      Foo       \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2192  Foo.prototype  \u2502\n  \u2506      \u2502  extends null  \u2502                  \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\n  \u2506      \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f  \n  \u2506              \u2570\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u2192 \ud83d\udca3 TypeError because\n  \u2570\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u2192 Function.prototype\n                                 is not a constructor\n</code></pre>\n<p>But knowing how the error happens also allows us to create a workaround.  We actually have a choice of two, either requiring a call to <code>Object.setPrototypeOf</code>:</p>\n<ul>\n<li><p>Pseudo-superclass implantation: use the <code>extends null</code> clause, and implant a dummy pseudo-superclass as a prototype of the constructor;</p>\n<pre class=\"lang-js prettyprint-override\"><code>class Foo extends null {\n  static {\n    Object.setPrototypeOf(this, class {});\n  }\n}\n</code></pre>\n<pre class=\"lang-none prettyprint-override\"><code>LEGEND:\n\u254c\u254c\u254c\u25b7  prototype before Object.setPrototypeOf         null\n                                                     \u25b2  \u25b2\n     \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e    \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2568\u256e \u2551\n     \u2502  Function.prototype  \u255e\u2550\u2550\u2550\u2550\u25b6  Object.prototype  \u2502 \u2551\n     \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b2\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f    \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2551\n          \u25b3        \u2551                                    \u2551\n          \u254e  \u256d\u2500\u2500\u2500\u2500\u2500\u2568\u2500\u2500\u2500\u2500\u2500\u2500\u256e                             \u2551\n          \u254e  \u2502  class {}  \u251c\u2500\u2500\u2192 [irrelevant]             \u2551\n          \u254e  \u2570\u2500\u2500\u2500\u2500\u2500\u25b2\u2500\u2500\u2500\u2500\u2500\u2500\u256f                             \u2551\n          \u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d                                    \u2551\n  super() \u2551                                             \u2551\n     \u256d\u2500\u2500\u2500\u2500\u2568\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e                  \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2568\u2500\u2500\u256e\n     \u2502      Foo       \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2192  Foo.prototype  \u2502\n     \u2502  extends null  \u2502                  \u2570\u2500\u2500\u25b2\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\n     \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f        \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2568\u2500\u2500\u2500\u256e\n            \u2570\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u2192  new Foo(...)  \u2502\n                               \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\n</code></pre>\n<p>This technique can be easily combined with <a href=\"/a/79855018/3840170\"><code>super</code> trickery</a> in case you need instances to be exotic objects.</p>\n</li>\n<li><p>Prototype surgery on a base class: omit the <code>extends</code> clause entirely, and transplant away <code>Object.prototype</code> as the prototype of the instance prototype.</p>\n<pre class=\"lang-js prettyprint-override\"><code>class Bar {\n  static {\n    Object.setPrototypeOf(this.prototype, null);\n  }\n}\n</code></pre>\n<pre class=\"lang-none prettyprint-override\"><code>                                                     null\n                                                     \u25b2  \u25b2\n     \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e    \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2568\u256e \u2551\n     \u2502  Function.prototype  \u255e\u2550\u2550\u2550\u2550\u25b6  Object.prototype  \u2502 \u2551\n     \u2570\u2500\u2500\u2500\u25b2\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f    \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2551\n         \u2551                                           \u25b3  \u2551\n         \u2551                                           \u254e  \u2551\n         \u2551                                           \u2554\u2550\u2550\u255d\n     \u256d\u2500\u2500\u2500\u2568\u2500\u2500\u2500\u256e                           \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2568\u2500\u2500\u2500\u2500\u2500\u256e\n     \u2502  Bar  \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2192  Bar.prototype  \u2502\n     \u2570\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u256f                           \u2570\u2500\u2500\u25b2\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\n         \u2506                     \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2568\u2500\u2500\u2500\u256e\n         \u2570\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u254c\u2192  new Bar(...)  \u2502\n                               \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\n</code></pre>\n</li>\n</ul>\n<p>You can see how either works below:</p>\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\" data-babel-preset-react=\"false\" data-babel-preset-ts=\"false\">\n<div class=\"snippet-code\">\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>class Bad extends null {}\n\n// separately declared for demonstrative purposes\nclass Null {}\n\n// transplant a dummy constructor prototype\nclass Good extends null {\n  static {\n    Object.setPrototypeOf(this, Null);\n  }\n}\n\n// transplant away instance prototype\u2019s prototype\nclass AlsoGood {\n  static {\n    Object.setPrototypeOf(this.prototype, null);\n  }\n}\n\nconsole.log(new Good() instanceof Object);         // false\nconsole.log(new Good() instanceof Null);           // false\nconsole.log(new Good() instanceof Good);           // true\n\nconsole.log(new AlsoGood() instanceof Object);     // false\nconsole.log(new AlsoGood() instanceof AlsoGood);   // true\n\nconsole.log(new Bad());                            // throws TypeError</code></pre>\n</div>\n</div>\n</p>\n<p><code>static</code> blocks are a new feature in ES2022 (ECMA-262 13th Ed.); if you are targetting older versions of JS, you can replace it with <code>Object.setPrototypeOf(Good, class {});</code> (or <code>Object.setPrototypeOf(AlsoGood.prototype, null);</code>) outside the class body.</p>\n<p>You may be tempted to use a <a href=\"/a/79855018/3840170\">return override</a> in the constructor, as some answers, and <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes/extends#extending_null\" rel=\"nofollow noreferrer\">even MDN</a> suggests, instead of transplanting prototypes.  Better <strong>disregard that advice</strong>; direct return override is incompatible with instance fields, both public and private:</p>\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\" data-babel-preset-react=\"false\" data-babel-preset-ts=\"false\">\n<div class=\"snippet-code\">\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>class Bad extends null {\n  constructor() {\n    return Object.create(new.target.prototype);\n  }\n\n  #value = 42;\n  token = 69;\n\n  get() {\n    return this.#value;\n  }\n}\n\nclass Good extends null {\n  static {\n    Object.setPrototypeOf(this, class {});\n  }\n\n  #value = 42;\n  token = 69;\n\n  get() {\n    return this.#value;\n  }\n}\n\nconsole.log(new Good().token);   // 69\nconsole.log(new Good().get());   // 42\nconsole.log(new Bad().token);    // undefined\nconsole.log(new Bad().get());    // throws TypeError</code></pre>\n</div>\n</div>\n</p>\n<p>If you define an explicit constructor for your class that <code>extends null</code>, you will have to invoke <code>super()</code> in it, just like with every other class declared with an <code>extends</code> clause.  This does not apply if you choose prototype surgery on a base class instead.</p>\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\" data-babel-preset-react=\"false\" data-babel-preset-ts=\"false\">\n<div class=\"snippet-code\">\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>class Wrapper extends null {\n  static {\n    Object.setPrototypeOf(this, class {});\n  }\n\n  #value;\n\n  constructor(value) {\n    super();\n    this.#value = value;\n  }\n\n  get() {\n    return this.#value;\n  }\n}\n\nclass WrapperAlt {\n  static {\n    Object.setPrototypeOf(this.prototype, null);\n  }\n\n  #value;\n\n  constructor(value) {\n    // no extends, no super()\n    this.#value = value;\n  }\n\n  get() {\n    return this.#value;\n  }\n}</code></pre>\n</div>\n</div>\n</p>\n", "tags": ["javascript", "ecmascript-6", "es6-class"]}
{"id": "11826521-9348-4866-9c26-efbd96c69db6", "text": "Q: Slow numpy and pandas imports on Google Cloud Run A: <p>I will answer this question a few years after asking it...</p>\n<p>First I dropped the idea of using alpine images altogether as it was not necessary.</p>\n<p>I started using `uv` from astral, and it has a <a href=\"https://docs.astral.sh/uv/reference/settings/#compile-bytecode\" rel=\"nofollow noreferrer\">compile-bytecode</a> option which I quote:</p>\n<p>&quot;Compile Python files to bytecode after installation.</p>\n<p>By default, uv does not compile Python (<code>.py</code>) files to bytecode (<code>__pycache__/*.pyc</code>); instead, compilation is performed lazily the first time a module is imported. For use-cases in which start time is critical, such as CLI applications and Docker containers, this option can be enabled to trade longer installation times for faster start times.</p>\n<p>When enabled, uv will process the entire site-packages directory (including packages that are not being modified by the current operation) for consistency.&quot;</p>\n<p>This option dramatically improved our starting time, a dependency like <code>numpy</code> and <code>pandas</code> ended up being loaded in milliseconds in  `docker`-ized (`kubernetes`) environment.</p>\n<p>Voil\u00e0,  hope that it helps someone.</p>\n<p>P.-S.: I recently had upvote which reminded me that I had this question left unanswered.</p>\n", "tags": ["python", "pandas", "docker", "google-cloud-platform", "alpine-linux"]}
{"id": "8a77852b-dde0-486b-8c9f-c7e37a989dc0", "text": "Q: What is the Python &quot;with&quot; statement designed for? A: <p>I have seen a few answers to this question using <code>@contextmanager</code>, and they are correct in their design patterns, and they are also correct to explain the concept of the &quot;<code>context managers</code> (the internal mechanics of python itself)&quot; when you use the <code>with</code> statement.</p>\n<pre class=\"lang-py prettyprint-override\"><code>from contextlib import contextmanager\n\n@contextmanager\ndef func():\n    var = 'yielding string'\n    \n    try:\n        yield var\n    finally:\n        print('Cleaning up.')\n        del var\n\nwith func() as f:\n    print(f)\n\n</code></pre>\n<p>But, they have miss the underlying point that makes <code>@contextmanager</code> work: the <code>__enter__</code> and <code>__exit__</code> methods. A class with the <code>__enter__</code> and <code>__exit__</code> methods is a context manager object.</p>\n<p>What <code>@contextmanager</code> is doing is wrapping your generator function in a class (<code>_GeneratorContextManager</code>) that  has <code>__enter__</code> and <code>__exit__</code> methods.</p>\n<p><strong>A simplified example</strong> of what is going on internally with <code>@contextmanager</code>:</p>\n<pre class=\"lang-py prettyprint-override\"><code>class _GeneratorContextManager:\n    &quot;&quot;&quot;simplified example of the _GeneratorContextManager class&quot;&quot;&quot;\n\n    def __init__(self, generator_func):\n        self.gen = generator_func\n\n    def __enter__(self):\n        return next(self.gen)\n\n    def __exit__(self, exc_type, exc_val, exc_tb):\n        try:\n            next(self.gen)\n        except StopIteration:\n            pass\n\n        \ndef contextmanager(func):\n    &quot;&quot;&quot;simplified example of the @contextmanager decorator&quot;&quot;&quot;\n    def wrapper(*args, **kwargs):\n        return _GeneratorContextManager(func(*args, **kwargs))\n    return wrapper\n\n\n@contextmanager\ndef func():\n    var = 'yielding string'\n    try:\n        yield var\n    finally:\n        print('Cleaning up.')\n        del var\n\n        \nwith func() as f:\n    print(f)\n\n</code></pre>\n<hr />\n<p>To answer the question: the <code>with</code> statement is designed to work with any class that implements the <code>__enter__</code> and <code>__exit__</code> methods.</p>\n<p>An example is the <code>open()</code> function. It returns an <code>io.TextIOWrapper</code> class, inheriting the base <code>io.IO</code> class containing the <code>__enter__</code> and <code>__exit__</code> methods. When you use <code>with open(file_path) as f:</code>, the <code>__exit__</code> method ensures <code>f.close()</code> is called automatically, whether your code finishes successfully or an <strong>exception</strong> occurs.</p>\n<p><strong>Exceptions</strong> are a key reason the <code>with</code> statement exists. It acts as a guaranteed safety net:</p>\n<pre class=\"lang-py prettyprint-override\"><code>import itertools\nfrom threading import Thread, Event\nfrom time import sleep\n\n\nclass ThreadManager:\n    def __init__(self):\n        self.stop_event = Event()\n        self.thread = Thread(target = self.worker)\n\n    def __enter__(self):\n        self.thread.start()\n        return self\n\n    def __exit__(self, exc_type, exc_val, exc_tb):\n        # This is the &quot;Guarantee&quot;: This runs even if the 'with' block crashes\n        print('Cleaning up the thread and exiting.')\n        self.close()\n\n        # Return False to let any exceptions propagate (crash) normally\n        return False\n\n    def worker(self):\n        for i in itertools.count(1):  # infinite loop\n            if self.stop_event.is_set(): break\n\n            # each iteration prints on the same line\n            print(f&quot;Thread Heartbeat: {i}&quot;, end = '\\r', flush = True)\n            sleep(1)\n\n        # clear the line\n        print(' ' * 30)\n\n    def close(self):\n        self.stop_event.set()\n        self.thread.join()\n\n\nwith ThreadManager():\n    sleep(3)\n    raise InterruptedError('A demonstration of the &quot;__exit__&quot; method when an exception occurs.')\n\n</code></pre>\n<p>If you run a class like this without the <code>with</code> statement and a crash occurs, the <code>close()</code> method is never called. You end up with an orphaned thread that continues to run in the background even though your main script has crashed. The with statement ensures <code>__exit__</code> method runs, and cleans up the thread.</p>\n", "tags": ["python", "language-features", "with-statement"]}
{"id": "515ab030-9fb7-4f82-af0d-65ee351e2987", "text": "Q: Using AspectJ in a plugin Java project A: <p>In Eclipse there does not seem to be a GUI option to add natures to a project, only to convert the project into a nature. You need the AspectJ nature, though. You can edit the project files like this and see if it works. It seems to, at least. I tried really quickly, without actually adding aspects to the sample plugin project I opened after editing the files. I saw the little &quot;AJ&quot; icon and AspectJ-related menu entries, though.</p>\n<p>I am just showing what you need to add. I guess there is nothing you need to remove, only maybe the <code>&lt;buildCommand&gt;</code> for the <code>javabuilder</code> because in a fresh AspectJ project there is just the <code>ajbuilder</code> (it also compiles plain Java files).</p>\n<p><em><strong>.project</strong></em></p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;projectDescription&gt;\n    &lt;name&gt;...&lt;/name&gt;\n    &lt;!-- ... --&gt;\n    &lt;buildSpec&gt;\n        &lt;buildCommand&gt;\n            &lt;name&gt;org.eclipse.ajdt.core.ajbuilder&lt;/name&gt;\n            &lt;arguments&gt;\n            &lt;/arguments&gt;\n        &lt;/buildCommand&gt;\n        &lt;!-- ... --&gt;\n    &lt;/buildSpec&gt;\n    &lt;natures&gt;\n        &lt;nature&gt;org.eclipse.ajdt.ui.ajnature&lt;/nature&gt;\n        &lt;!-- ... --&gt;\n    &lt;/natures&gt;\n&lt;/projectDescription&gt;\n</code></pre>\n<p><em><strong>.classpath</strong></em></p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;classpath&gt;\n    &lt;!-- ... --&gt;\n    &lt;classpathentry kind=&quot;con&quot; path=&quot;org.eclipse.ajdt.core.ASPECTJRT_CONTAINER&quot;/&gt;\n    &lt;!-- ... --&gt;\n&lt;/classpath&gt;\n</code></pre>\n", "tags": ["java", "eclipse", "eclipse-plugin", "aspectj"]}
{"id": "1513feef-03ba-4893-bba1-a303b0265047", "text": "Q: Azure Functions SQL trigger delete operation - how to get id of deleted record? A: <p>Exactamundo.  What's the point of an SQL trigger azure function in the first place?   Because some app needs to be aware of a change that has been made in a database in the cloud.</p>\n<p>Anyway, my problem turned out to be that I was playing around with a test table.  I changed the name of the primary key.  This seems to break the SQL trigger azure function.  Oh well.</p>\n", "tags": ["c#", "azure", "azure-functions", "tsqlt"]}
{"id": "cc9b998e-6fa8-4dcd-b858-b8303898b392", "text": "Q: Embedded Apache Artemis not starting with Spring Boot A: <p>The application exits immediately because there's nothing keeping it alive. The embedded Artemis server starts but Spring Boot shuts down since there's no blocking component (web server, JMS listener, etc.). Add a web server or keep-alive mechanism.</p>\n<pre class=\"lang-none prettyprint-override\"><code>dependencies {\n    implementation 'org.springframework.boot:spring-boot-starter-artemis'\n    implementation 'org.springframework.boot:spring-boot-starter-web'  // keeps app alive\n    implementation 'org.apache.activemq:artemis-server'\n}\n</code></pre>\n", "tags": ["java", "spring", "spring-boot", "activemq-artemis"]}
