{"id": "3a6a3f37-826a-4cd1-bbd3-43ca4a7a295c", "text": "Q: Include Key AND salt for signing JWT in NestJS A: <p>For anyone still wandering, there is no salt option for the jwt signature. The reason is simple : the signature is already salted by the <code>iat</code> property in the payload (see <a href=\"https://datatracker.ietf.org/doc/html/rfc7519#section-4.1.6\" rel=\"nofollow noreferrer\">RFC7519 at section 4.1.6</a>).</p>\n<p>The point of a salt is to prevent comparison between 2 hashes hashing the same value.</p>\n<blockquote>\n<p>For example, if a company gets its database full of password hashes leaked. The attackers can take a hash, and compare it to every other hashes :</p>\n<ul>\n<li><p>My password is <code>abc</code>, hashed with an unknown algorithm, it becomes <code>60a0cc995ee7305be8</code></p>\n</li>\n<li><p>The password of my friend is also <code>abc</code>, so its hash is also <code>60a0cc995ee7305be8</code></p>\n</li>\n<li><p>The attackers see in the leaked database 2 same hashes. They know that if they can break one (e.g. by bruteforce or lookup tables), they'll be able to login to both accounts.</p>\n</li>\n</ul>\n</blockquote>\n<p>To avoid that, we add a &quot;salt&quot; : a little bit of random data that will completely change the hash. We store it with the hash.</p>\n<blockquote>\n<p>For example, my password <code>abc</code> with the salt <code>1a7af606</code> becomes <code>a2a73afe8902258cb4</code><br />\nMy friend's with the salt <code>f614085c</code> becomes <code>ce1b1758d685f833cb</code></p>\n<p>Theses hashes are completely different. So for our server to be able to verify the passwords, we store the salts as well in the database. We will use the syntax <code>hash:salt</code> but for example bcrypt, a hash algorithm created in 1999 and still secure today, uses the syntax <code>$algorithm$rounds$salt.hash</code> (see <a href=\"https://en.wikipedia.org/wiki/Bcrypt\" rel=\"nofollow noreferrer\">Bcrypt</a>).<br />\nSo we get : <code>a2a73afe8902258cb4:1a7af606</code> for me, and <code>ce1b1758d685f833cb:f614085c</code> for my friend.</p>\n<p>It's impossible for an attacker to tell that these two hashes are the &quot;same&quot;. But for the server, there is no problem to verify the authenticity of a password. It is more secured.</p>\n</blockquote>\n<p>In every jwt payload (unless if you edited it), there is a field called <code>iat</code> (for &quot;Issued At&quot;). It is the timestamp of the creation of the token. --&gt; Because it is changing all the time, making the signature completely different, <strong>it is our salt</strong> <strong>!</strong> So there is no need for another.</p>\n", "tags": ["phoenix-framework", "nestjs", "jwt"]}
{"id": "2098bcc3-35c7-4865-96bd-cdf16cac138e", "text": "Q: Incorrect release_date in Spotify API for tracks added from an album instead of the original single A: <p>You can use the ISRC of the track and do a search by ISRC (&quot;isrc:XXXXXXXX&quot;); this will return all the track versions appearing in album/singles/compilations, so you can use the minimum release date as original release date.</p>\n<p>See below for an example using the track <code>spotify:track:3M8bJdRfYj1S5iKZIgwAnH.</code></p>\n<ol>\n<li><p>First you retrieve the ISRC by using the Track attribute:</p>\n<pre><code>&quot;external_ids&quot;: {          &quot;isrc&quot;: &quot;QZVM32200343&quot;        }\n</code></pre>\n</li>\n<li><p>Then you use the ISRC to perform a <a href=\"https://developer.spotify.com/documentation/web-api/reference/search\" rel=\"nofollow noreferrer\">track search</a> using the query &quot;isrc:QZVM32200343&quot;, like below</p>\n<pre><code>curl --request GET \\\n  --url 'https://api.spotify.com/v1/search?q=isrc%3AQZVM32200343&amp;type=track' \\\n  --header 'Authorization: Bearer XXXXXX'\n</code></pre>\n</li>\n<li><p>This will return a list of Track objects, each associated to an album/single/compilation object and a specific <code>release_date</code> attribute. Pick the minimum date between those and you'll have the original release date.</p>\n</li>\n</ol>\n", "tags": ["spotify"]}
{"id": "1e8a1210-b825-46c5-98f7-1ef7ddc3134c", "text": "Q: How to see changes in django admin base.css A: <p>The way you can do this is to make a custom file of your own called something like <code>admin_custom.css</code> in the <code>static</code> folder. Then in your <code>templates</code> folder, make a folder called <code>admin</code> with <code>base_site.html</code> inside it. Then edit <code>base_site.html</code> to add a <code>&lt;link&gt;</code> tag to your own custom stylesheet.</p>\n", "tags": ["python", "css", "django"]}
{"id": "4e9fe148-4b75-47ec-856e-6b180df29cb7", "text": "Q: EnvDTE Framework informations programmatically A: <p>This can be done via the <a href=\"https://github.com/dotnet/project-system/blob/b84a07bb04612eb66c301e01bde47b82e9d4b216/src/Microsoft.VisualStudio.ProjectSystem.Managed/ProjectSystem/Debug/ActiveDebugFrameworkServices.cs#L27\" rel=\"nofollow noreferrer\">GetProjectFrameworksAsync</a> from <code>public interface IActiveDebugFrameworkServices</code> from <code>Microsoft.VisualStudio.ProjectSystem.Managed</code>.</p>\n<p>The main issue is that Microsoft doesn't publish it to nuget, so you need to add the <a href=\"https://pkgs.dev.azure.com/azure-public/vside/_packaging/vs-impl/nuget/v3/index.json\" rel=\"nofollow noreferrer\">vs-impl feed</a> to your Nuget sources.</p>\n", "tags": ["frameworks", "visual-studio-2022", "vsix", "envdte"]}
{"id": "b1341f25-776f-4987-ba33-1796f2461f1c", "text": "Q: Can nested WHERE condition grouping be achieved with CodeIgniter query builder? A: <p>Try this syntax</p>\n\n<pre><code>$this-&gt;db-&gt;select(\"*\")-&gt;from(\"table\");\n    $this-&gt;db-&gt;group_start();\n        $this-&gt;db-&gt;group_start();\n            $this-&gt;db-&gt;where(\"val &lt;\",'col');\n            $this-&gt;db-&gt;where(\"val &lt;\",'col');\n        $this-&gt;db-&gt;group_end();\n        $this-&gt;db-&gt;or_group_start();\n            $this-&gt;db-&gt;or_where(\"val &lt;\",'col');\n            $this-&gt;db-&gt;where(\"val &lt;\",'col');\n        $this-&gt;db-&gt;group_end();\n        $this-&gt;db-&gt;or_group_start();\n            $this-&gt;db-&gt;or_where(\"val \",'col');\n            $this-&gt;db-&gt;where(\"val \",'col');\n        $this-&gt;db-&gt;group_end();\n    $this-&gt;db-&gt;group_end();\n    $this-&gt;db-&gt;where(\"incol \",'intval');\n    $this-&gt;db-&gt;where(\"incol \",'intval');\n    $this-&gt;db-&gt;get();\n    $last_query = $this-&gt;db-&gt;last_query();\n\n    $this-&gt;db-&gt;select('*')-&gt;from('table2');\n    $this-&gt;db-&gt;where_not_in('serial',$last_query);\n    $this-&gt;db-&gt;get();\n    echo $this-&gt;db-&gt;last_query();\n</code></pre>\n\n<p>The query string produced by the above is</p>\n\n<pre><code>SELECT * FROM `table2` WHERE\n     `serial` NOT IN(\n    SELECT columnname FROM `table` WHERE\n    (\n        (`val` &lt; 'col' AND `val` &lt; 'col') OR\n        (`val` &lt; 'col' AND `val` &lt; 'col') OR\n        (`val` = 'col' AND `val` = 'col') \n    ) AND `incol` = 'intval' AND `incol` = 'intval'\n);\n</code></pre>\n", "tags": ["php", "codeigniter", "where-clause", "query-builder", "logical-grouping"]}
{"id": "f6e739b7-23ae-4cdb-9468-8fa06dcd246b", "text": "Q: How to handle database schema migrations in a Kubernetes rolling update without downtime? A: <p>In a rolling deploy scenario, you will by definition have a period of time where multiple versions of your application will be running at the same time. Therefore the key to a zero downtime migration is less about how you invoke the migration and more about how you write the migration.</p>\n<p>As mentioned in a <a href=\"https://stackoverflow.com/questions/79842158/how-to-handle-database-schema-migrations-in-a-kubernetes-rolling-update-without#comment140894650_79842158\">comment above</a>, the goal is to not make any breaking data or schema changes from the perspective of any running code. Some changes may need to be made in multiple deploys. For example, the renaming of a column might be accomplished <a href=\"https://stackoverflow.com/questions/41747699/renaming-an-existing-column-without-downtime\">as described here</a>. Once the rolling deploy completes, the old code is gone and the old column can be safely removed. The last warning here is that code rollbacks are more complicated after you've performed such a migration because older code would expect the older column to exist, so in some scenarios it may be safer to instead find a way to temporarily keep backwards compatibility until it's certain you won't need to roll back.</p>\n<p>With all that in mind: init containers, a separate Job kicked off by CI, or just running migrations in your application before you start your FastAPI server are all equally valid strategies, they just have slightly different behavior and implementation complexity.</p>\n", "tags": ["kubernetes"]}
{"id": "a10925b2-1148-4e5a-b5fb-dfc36a8d761a", "text": "Q: Find and return the first item that matches a substring or regex in a CMake list? A: <p>You can find substrings in a list using the <code>MATCHES</code> conditional inside of an iteration.</p>\n<blockquote>\n<p><strong><a href=\"https://cmake.org/cmake/help/latest/command/if.html#matches\" rel=\"nofollow noreferrer\"><code>if(&lt;variable|string&gt; MATCHES &lt;regex&gt;</code></a></strong><br>\nTrue if the given string or variable's value matches the given regular expression.<br></p>\n</blockquote>\n<p>Here are a few examples without going to deep into the regex side of things. Also note, as of cmake 2.6 you can use the <a href=\"https://cmake.org/cmake/help/latest/variable/CMAKE_MATCH_n.html\" rel=\"nofollow noreferrer\"><code>CMAKE_MATCH_&lt;n&gt;</code></a> and <a href=\"https://cmake.org/cmake/help/latest/variable/CMAKE_MATCH_COUNT.html\" rel=\"nofollow noreferrer\"><code>CMAKE_MATCH_COUNT</code></a> variables along with the <a href=\"https://cmake.org/cmake/help/latest/command/if.html#matches\" rel=\"nofollow noreferrer\"><code>MATCHES</code></a> conditional.</p>\n<p>To run, save these scripts to .cmake files and run them with <code>cmake -p &lt;'path to file'&gt;</code></p>\n<p><strong>Find substring in string example</strong></p>\n<pre class=\"lang-none prettyprint-override\"><code>#################################################\n# Find substring in string example\nmessage(&quot;\\n### Find substring in string example&quot;)\nset(haystack &quot;Ouch! There is a needle in this haystack&quot;)\nif(haystack MATCHES &quot;needle&quot;)\n    message(&quot;${haystack}&quot;)\n    message(&quot;needle FOUND in haystack string&quot;)\nelse()\n    message(&quot;needle NOT FOUND&quot;)\nendif()\n</code></pre>\n<p><a href=\"https://i.sstatic.net/XIeGTRdc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/XIeGTRdc.png\" alt=\"console output\" /></a></p>\n<p><strong>Find substring in list example</strong></p>\n<pre class=\"lang-none prettyprint-override\"><code>#################################   \n# Find substring in list example \nmessage(&quot;\\n### Find substring in list example &quot;)\nset(haystack &quot;hay;hay;hayhay;hayneedlehay;hayhay;needlehay;hay;needle;hay;hayhay&quot;)\nset(n 0)\nforeach(item IN LISTS haystack)\n    if(item MATCHES &quot;needle&quot;)\n        message(&quot;needle FOUND haystack list at index:${n}&quot;)\n    endif()\n    math(EXPR n &quot;${n}+1&quot;)\nendforeach()\n</code></pre>\n<p><a href=\"https://i.sstatic.net/v86AP1fo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/v86AP1fo.png\" alt=\"console output\" /></a></p>\n<p><strong>list_search function with fisrt and last, row and column, occurences</strong></p>\n<pre class=\"lang-none prettyprint-override\"><code>######################################################################\n# list_search function with fisrt and last, row and column, occurences\n#\nlist(APPEND myList &quot;abcdef abcdef abcdef&quot;)\nlist(APPEND myList &quot;zyxwvu,zyxwvu,zyxwvu&quot;)\nlist(APPEND myList &quot;123456\\;123456\\;123456&quot;)\nlist(APPEND myList &quot;987654.987654.987654&quot;)\nlist(APPEND myList &quot;bcdefg_bcdefg_bcdefg&quot;)\nlist(APPEND myList &quot;234567-234567-234567&quot;)\nlist(APPEND myList &quot;yxwvut&lt;yxwvut&lt;yxwvut&quot;)\nlist(APPEND myList &quot;876543&gt;876543&gt;876543&quot;)\nlist(APPEND myList &quot;cdefghi)cdefghi)cdefghi&quot;)\nlist(APPEND myList &quot;3456789 / 345678 / 3456789&quot;)\nlist(APPEND myList &quot;xwvutsr\\\\xwvutsrz\\\\xwvutsr&quot;)\nlist(APPEND myList &quot;7654321 = 7654321 = 7654321&quot;)\n\nmessage(&quot;\\n\\n###### myList ######&quot;)\nmessage(&quot;${myList}&quot;)\n\n\nset(n 0)\nmessage(&quot;\\n\\n###### myList Items ######&quot;)\nforeach(item IN LISTS myList)\n    message(&quot;(${n}):${item}&quot;)\n    math(EXPR n &quot;${n}+1&quot;)\nendforeach()\n\n\nfunction(list_search _list_ _search_)\n    message(&quot;\\n\\n###### list_search list:${_list_} '${_search_}' ######&quot;)\n    set(_list_ &quot;${ARGV0}&quot;)\n    set(_search_ &quot;${ARGV1}&quot;)\n    \n    set(row 0)\n    foreach(item IN LISTS ${_list_})\n        if(item MATCHES &quot;${_search_}&quot;)\n            string(FIND &quot;${item}&quot; &quot;${_search_}&quot; col)\n            string(FIND &quot;${item}&quot; &quot;${_search_}&quot; last_col REVERSE)\n            \n            if(DEFINED row)\n                set(last_${_search_}_row &quot;${row}&quot;)\n            endif()\n            if(DEFINED last_col)\n                set(last_${_search_}_col &quot;${last_col}&quot;)\n            endif()\n            if(DEFINED item)\n                set(last_${_search_}_val &quot;${item}&quot;)\n            endif()\n            \n            if(NOT DEFINED first_${_search_}_row)\n                set(first_${_search_}_row &quot;${row}&quot;)\n            endif()\n            if(NOT DEFINED first_${_search_}_col)\n                set(first_${_search_}_col &quot;${col}&quot;)\n            endif()\n            if(NOT DEFINED first_${_search_}_val)\n                set(first_${_search_}_val &quot;${item}&quot;)\n            endif()\n            \n            message(&quot;'${_search_}' found at row:${row} col:${col} with value of '${item}'&quot;)\n        endif()\n        math(EXPR row &quot;${row}+1&quot;)\n    endforeach()\n\n    message(&quot;&quot;)\n    message(&quot;First '${_search_}' found in list at row:${first_${_search_}_row} col:${first_${_search_}_col} With the value of '${first_${_search_}_val}'&quot;)\n    message(&quot;Last  '${_search_}' found in list at row:${last_${_search_}_row} col:${last_${_search_}_col} With the value of '${last_${_search_}_val}'&quot;)\nendfunction()\n\nlist_search(myList &quot;456&quot;)\nlist_search(myList &quot;yxw&quot;)\nlist_search(myList &quot;654&quot;)\n</code></pre>\n<p><a href=\"https://i.sstatic.net/I5MKZnWk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/I5MKZnWk.png\" alt=\"console output\" /></a></p>\n", "tags": ["cmake"]}
{"id": "1bb9f093-c168-4e1e-acb0-bd9eed2cb21b", "text": "Q: Why does GCC emit different assembly here after specifying volatile (no flags/optimization)? A: <p>Honestly, the way you spoke about O0 made it sound like something stranger than passing no arguments at all so I assumed it was different. Regardless, I don't really understand your attitude in your responses. I'm not criticizing GCC or its contributors, I'm merely asking about something I think is interesting, since given my understanding of the standard the assembly gcc generated already satisfies the requirements of volatile before adding the two new instructions. And just saying &quot;You either need to activate optimizations or you have to accept that the compiler creates stupid code&quot; is not an answer to my question. If you don't like my question, you are under no obligation to answer it, and can just move on.</p>\n", "tags": ["c++", "c", "assembly", "gcc", "x86"]}
