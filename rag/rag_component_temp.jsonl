{"id": "f0fab4ff-fa1e-461b-9e2e-8aeb9c9e4e29", "text": "Q: updating Adobe Acrobat Reader DC using chololatey A: <p>As mentioned over on the <a href=\"https://github.com/chocolatey/choco/issues/2796\" rel=\"nofollow noreferrer\">issue that was raised</a>, this isn't a Chocolatey CLI issue. It's an MSI installer issue.</p>\n<p>My advice is read the error message first and follow its advice. If that doesn't work, do an internet search for that error code and follow standard troubleshooting for it.</p>\n", "tags": ["chocolatey"]}
{"id": "18b26420-65d0-4646-91c9-c71d92ff8ae8", "text": "Q: rpy2 error: sh not recognized &amp; API mode Importerror A: <p>A better solution:</p>\n<pre><code># Set environment to &quot;ABI&quot;\nos.environ[&quot;RPY2_CFFI_MODE&quot;] = &quot;ABI&quot;\n# Set R_HOME without braces and ensure R's bin is on PATH so subprocess can find R\nR_HOME = r&quot;C:\\Program Files\\R\\R-4.3.1&quot;\nif os.path.exists(R_HOME):\n    os.environ[&quot;R_HOME&quot;] = R_HOME\n    # Prefer the primary bin and x64 bin paths\n    r_bin = os.path.join(R_HOME, &quot;bin&quot;)\n    r_x64 = os.path.join(r_bin, &quot;x64&quot;)\n    # Prepend R bins to PATH if they exist\n    path_parts = []\n    if os.path.isdir(r_bin):\n        path_parts.append(r_bin)\n    if os.path.isdir(r_x64):\n        path_parts.append(r_x64)\n    if path_parts:\n        os.environ[&quot;PATH&quot;] = &quot;;&quot;.join(path_parts) + &quot;;&quot; + os.environ.get(&quot;PATH&quot;, &quot;&quot;)\nelse:\n    raise FileNotFoundError(\n        f&quot;R_HOME not found at {R_HOME}. Please install R or update R_HOME in module_R.py to the correct path.&quot;\n    )\n\nimport rpy2\nfrom rpy2.robjects.packages import importr\n</code></pre>\n<p>As the error informs a default API environment, this needs to be reset to ABI, especially under &quot;RPY2_CFFI_MODE&quot;.</p>\n<p>Then Script doesnot know where to get R running. We need to tell subprocess the folders we installed R, \\bin\\ and \\x64\\. Adding these folders to the environment as well. Then a if else clause pops an error message if the R_HOME folder could not be found.</p>\n<p>These two steps solve the problem of 'import rpy2' completely.</p>\n", "tags": ["python", "r", "rpy2"]}
{"id": "18dc9ade-f339-4346-9701-1b880bebd7b2", "text": "Q: installation problem - nodejs-lts (exited 1603) - Error while running &#39;C:\\ProgramData\\chocolatey\\lib\\nodejs-lts\\tools\\chocolateyinstall.ps1&#39; A: <p>just open the power shell and run as administrator and the files will get installed</p>\n", "tags": ["node.js", "react-native", "chocolatey"]}
{"id": "f9a253fa-ea31-4636-bc0c-33c12c1d6031", "text": "Q: tcp-scanning using TCP SYN and having OSError: [WinError 10022] An invalid argument was supplied A: <p><code>sendto()</code> can only be used with datagram sockets, not stream sockets. With stream sockets, you must use <code>connect()</code> to create a connection to the address, then call <code>send()</code>, and you can't use the same socket for multiple connections.</p>\n<p>You can put all the sockets in a list, and wait for all of them with <code>select()</code>. A successful connection will be in <code>wlist</code>, while a failure will be in <code>xlists</code>.</p>\n<pre><code>def tcp_scan(destination_ip : str, ports : list[int]):\n    send_times = {}\n    results = {}\n    socks = []\n\n    for port in ports:\n        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM | socket.SOCK_NONBLOCK)\n        send_times[port] = time.time()\n        sock.connect((destination_ip, port))\n        socks.append(sock)\n\n    deadline = time.time() + TIMEOUT\n\n    while len(socks) &gt; 0 and time.time() &lt; deadline:\n        rlist, wlist, xlist = select.select([], socks, socks, TIMEOUT)\n        for sock in wlist:\n            ip, port = sock.getpeername()\n            response_time = (time.time() - send_times[port]) * 1000\n            results[port] = &quot;open&quot;, response_time\n            socks.remove(sock)\n        for sock in xlist:\n            ip, port = sock.getpeername()\n            response_time = (time.time() - send_times[port]) * 1000\n            results[port] = &quot;closed&quot;, response_time\n            socks.remove(sock)\n\n    return results\n</code></pre>\n", "tags": ["python", "tcp"]}
{"id": "35ed3852-50fe-40bf-9545-800a64a46477", "text": "Q: conda create environment command gives &#39;Found conflicts! Looking for incompatible packages.&#39; A: <p><a href=\"https://stackoverflow.com/questions/71833234/conda-create-environment-command-gives-found-conflicts-looking-for-incompatibl#comment126939909_71833234\">@cel gets credit</a> for this</p>\n<p>Switching to mamba provided better diagnostics.</p>\n<pre><code>mamba create -n foo python=2\n\nLooking for: ['python=2']\n\nconda-forge/win-64                                          Using cache\nconda-forge/noarch                                          Using cache\nEncountered problems while solving:\n - nothing provides vc 9.* needed by python-2.7.12-0\n</code></pre>\n<p>Then use mamba to find <code>vc</code>.</p>\n<pre><code>mamba search vc\n\n# Name                       Version           Build  Channel\nvc                              14.1      h21ff451_1  conda-forge\nvc                              14.1      h6d1b3ff_2  conda-forge\n...\n</code></pre>\n<p>The <code>vc v9</code> can be found in the <code>defaults</code> channel.</p>\n<pre><code>mamba search 'vc[channel=defaults]'\n\n# Name                       Version           Build  Channel\nvc                                 9      h2eaa2aa_6  pkgs/main\n...\n</code></pre>\n<p>Updating the <code>.condarc</code> with the <code>defaults</code> channel, corrected the problem.</p>\n<pre class=\"lang-yaml prettyprint-override\"><code>channels:\n  - conda-forge\n  - defaults\nchannel_priority: disabled\n</code></pre>\n<p>As a final note, should someone else find themselves in this situation...</p>\n<p>The <code>~/.condarc</code> got changed (dropping the <code>defaults</code> channel) as part of installing <code>mambaforge</code>.</p>\n", "tags": ["python-2.7", "conda", "chocolatey"]}
{"id": "068b2b83-57a7-4c74-8784-4aba42119a46", "text": "Q: Is there a way to specify &#39;--force&#39; in chocolateyinstall.ps1? A: <p>You can try setting <a href=\"https://docs.chocolatey.org/en-us/create/functions/#set-by-options-and-configuration\" rel=\"nofollow noreferrer\"><code>$env:ChocolateyForce = 'true'</code></a> in <code>chocolateyInstall.ps1</code>, but normally this variable is meant for checking that <code>--force</code> was specified by the operator at the command line. It is generally used for modifying script behavior if <code>--force</code> was passed.</p>\n<p>I don't know if changing the environment variable mid-script would have an effect or not on the <code>Install-Chocolatey*</code> cmdlets.</p>\n", "tags": ["powershell", "package", "package-managers", "chocolatey"]}
{"id": "7614840d-33c8-46cb-aba0-37fb80270203", "text": "Q: Installing Dolt on Windows 10 A: <p>Your attempt had this error:</p>\n<pre><code>Access to the path 'C:\\ProgramData\\chocolatey\\lib-bad' is denied.\n</code></pre>\n<p>Running chocolatey with admin privileges should help.</p>\n<p>Example:</p>\n<ol>\n<li>Run your powershell as admin</li>\n</ol>\n<p><a href=\"https://i.sstatic.net/wdjny.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/wdjny.png\" alt=\"enter image description here\" /></a></p>\n<ol>\n<li>You should see installation works</li>\n</ol>\n<p><a href=\"https://i.sstatic.net/xAu6a.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/xAu6a.png\" alt=\"enter image description here\" /></a></p>\n", "tags": ["windows", "powershell", "installation", "chocolatey", "dolt"]}
