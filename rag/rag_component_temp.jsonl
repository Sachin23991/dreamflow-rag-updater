{"id": "57fdaef5-4d90-4056-8915-0075722a1a47", "text": "Q: Google Apps Script Protected Sheet Edit Permissions A: <p>With deployed Modals and Sidebars, the effective user interacting with the served HTML of the Modal or Sidebar is actually the account who is logged into the browser.</p>\n<p>So, if you have multiple browser profiles, you may want to verify that the browser profile that has the sheet open matches the account that is the sheet owner (can be 2 separate accounts).</p>\n<p>The Modal will default to that browser user account.</p>\n", "tags": ["google-sheets", "spreadsheet-protection"]}
{"id": "58e3a30f-db57-4919-a978-bc1fcac68809", "text": "Q: How can I format a number with commas as thousands separators? A: <p>I suggest using phpjs.org's <a href=\"https://web.archive.org/web/20160301100122/http://phpjs.org/functions/number_format/\" rel=\"nofollow noreferrer\">number_format()</a>:</p>\n<pre><code>function number_format(number, decimals, dec_point, thousands_sep) {\n    var n = !isFinite(+number) ? 0 : +number,\n        prec = !isFinite(+decimals) ? 0 : Math.abs(decimals),\n        sep = (typeof thousands_sep === 'undefined') ? ',' : thousands_sep,\n        dec = (typeof dec_point === 'undefined') ? '.' : dec_point,\n        toFixedFix = function (n, prec) {\n            // Fix for IE parseFloat(0.55).toFixed(0) = 0;\n            var k = Math.pow(10, prec);\n            return Math.round(n * k) / k;\n        },\n        s = (prec ? toFixedFix(n, prec) : Math.round(n)).toString().split('.');\n    if (s[0].length &gt; 3) {\n        s[0] = s[0].replace(/\\B(?=(?:\\d{3})+(?!\\d))/g, sep);\n    }\n    if ((s[1] || '').length &lt; prec) {\n        s[1] = s[1] || '';\n        s[1] += new Array(prec - s[1].length + 1).join('0');\n    }\n    return s.join(dec);\n}\n</code></pre>\n<p>People have been reporting this didn't work as expected, so I did <a href=\"http://jsfiddle.net/drewnoakes/xc3qh35z/\" rel=\"nofollow noreferrer\">a JSFiddle</a> that included automated tests.</p>\n<p>Here's that fiddle as a <a href=\"https://meta.stackoverflow.com/tags/stack-snippets/info\">Stack Snippets</a> snippet with slightly modified output:</p>\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\" data-babel-preset-react=\"false\" data-babel-preset-ts=\"false\">\n<div class=\"snippet-code\">\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>function number_format(number, decimals, dec_point, thousands_sep) {\n    var n = !isFinite(+number) ? 0 : +number,\n        prec = !isFinite(+decimals) ? 0 : Math.abs(decimals),\n        sep = (typeof thousands_sep === 'undefined') ? ',' : thousands_sep,\n        dec = (typeof dec_point === 'undefined') ? '.' : dec_point,\n        toFixedFix = function (n, prec) {\n            // Fix for IE parseFloat(0.55).toFixed(0) = 0;\n            var k = Math.pow(10, prec);\n            return Math.round(n * k) / k;\n        },\n        s = (prec ? toFixedFix(n, prec) : Math.round(n)).toString().split('.');\n    if (s[0].length &gt; 3) {\n        s[0] = s[0].replace(/\\B(?=(?:\\d{3})+(?!\\d))/g, sep);\n    }\n    if ((s[1] || '').length &lt; prec) {\n        s[1] = s[1] || '';\n        s[1] += new Array(prec - s[1].length + 1).join('0');\n    }\n    return s.join(dec);\n}\n\nvar exampleNumber = 1;\nfunction test(expected, number, decimals, dec_point, thousands_sep)\n{\n    var actual = number_format(number, decimals, dec_point, thousands_sep);\n    console.log(\n        'Test case ' + exampleNumber + ': ' +\n        '(decimals: ' + (typeof decimals === 'undefined' ? '(default)' : decimals) +\n        ', dec_point: \"' + (typeof dec_point === 'undefined' ? '(default)' : dec_point) + '\"' +\n        ', thousands_sep: \"' + (typeof thousands_sep === 'undefined' ? '(default)' : thousands_sep) + '\")'\n    );\n    console.log('  =&gt; ' + (actual === expected ? 'Passed' : 'FAILED') + ', got \"' + actual + '\", expected \"' + expected + '\".');\n    exampleNumber++;\n}\n\ntest('1,235',    1234.56);\ntest('1 234,56', 1234.56, 2, ',', ' ');\ntest('1234.57',  1234.5678, 2, '.', '');\ntest('67,00',    67, 2, ',', '.');\ntest('1,000',    1000);\ntest('67.31',    67.311, 2);\ntest('1,000.6',  1000.55, 1);\ntest('67.000,00000', 67000, 5, ',', '.');\ntest('1',        0.9, 0);\ntest('1.20',     '1.20', 2);\ntest('1.2000',   '1.20', 4);\ntest('1.200',    '1.2000', 3);</code></pre>\n<pre class=\"snippet-code-css lang-css prettyprint-override\"><code>.as-console-wrapper {\n  max-height: 100% !important;\n}</code></pre>\n</div>\n</div>\n</p>\n", "tags": ["javascript", "formatting", "numbers"]}
{"id": "9b1ab003-e1d3-472b-bbcc-4611725b0658", "text": "Q: Svelte warning - State referenced in its own scope will never update A: <p>If you  don't want to disable the check locally or simply ignore the warning, you can reference <code>filteredOptions</code>inside of a closure when initializing the <code>newFilteredOptions</code> like this:</p>\n<pre class=\"lang-js prettyprint-override\"><code>let newFilteredOptions = $state(deepClone((() =&gt; filteredOptions)());\n</code></pre>\n<p>It's a bit of a weird notation but it fulfills what the documentation of the warning explains:</p>\n<blockquote>\n<p>To fix this, reference the variable such that it is lazily evaluated. For the above example, this can be achieved by wrapping [your variable] in a function:</p>\n</blockquote>\n<p>So in the notation you're wrapping <code>filteredOptions</code>in an anonymous function and calling it (to retrieve the value from the wrap). The excessive amount of parenthesis is necessary for precedence so the call &quot;()&quot; acts on the closure <code>(() =&gt; filteredOptions)</code> instead of simply on <code>filteredOptions</code>.</p>\n", "tags": ["state", "svelte", "warnings", "svelte-5"]}
{"id": "628a2489-2e4b-48c5-b6bb-0eb9ea03ac83", "text": "Q: Do I need atomic transactions or is eventual consistency enough? A: <p>Thank you for the answer! I guess I was looking to understand more, in your experience, whether such a system is maintainable and whether it results in bugs compared to a system that does an eventually consistent loop like I mentioned above.</p>\n<p>I would imagine it to be possible that the second step of the above fails, and that results in needing to revert, and for there to be a observable, large-enough difference between the two steps, resulting in &quot;weirdness&quot; if something happens in between those two.</p>\n", "tags": ["c++", "architecture", "software-design"]}
{"id": "28b49074-4abd-4ce1-8fb6-4527efc05028", "text": "Q: Semi-colon after a case valid in a PHP switch statement? A: <p>Using semicolons in switch case statements was deprecated in PHP 8.5, and is planned for removal in PHP 9.0.</p>\n<p><a href=\"https://www.php.net/manual/en/migration85.deprecated.php\" rel=\"nofollow noreferrer\">https://www.php.net/manual/en/migration85.deprecated.php</a></p>\n", "tags": ["php", "syntax"]}
