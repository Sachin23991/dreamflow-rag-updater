{"id": "9af77e73-272d-4de6-83ad-a0fb98e9286c", "text": "Q: Finding Folder to use in Macro A: <h2>Copy from Closed Workbook</h2>\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nSub ImportGlobalAB()\n\n    ' Create references to the destination workbook and worksheet.\n    Dim dwb As Workbook: Set dwb = ThisWorkbook ' workbook containing this code\n    If Len(dwb.Path) = 0 Then\n        MsgBox &quot;The file &quot;&quot;&quot; &amp; dwb.Name &amp; &quot;&quot;&quot; was never saved!&quot;, vbExclamation\n        Exit Sub\n    End If\n    Dim dws As Worksheet: Set dws = dwb.Sheets(&quot;GLOBAL&quot;)\n    \n    ' Select the source folder using the 'SelectFolder' function.\n    Dim sFolderPath As String: sFolderPath = SelectFolder(dwb.Path)\n    If Len(sFolderPath) = 0 Then\n        MsgBox &quot;Folder selection cancelled!&quot;, vbExclamation\n        Exit Sub\n    End If\n    \n    ' Build the source file path.\n    Dim sFilePath As String: sFilePath = _\n        sFolderPath &amp; Application.PathSeparator &amp; &quot;Global_AB.csv&quot;\n    If Len(Dir(sFilePath)) = 0 Then\n        MsgBox &quot;The file &quot;&quot;&quot; &amp; sFilePath &amp; &quot;&quot;&quot; doesn't exist!&quot;, vbExclamation\n        Exit Sub\n    End If\n    \n    ' Create references to the source workbook and worksheet.\n    Dim swb As Workbook: Set swb = Workbooks.Open(sFilePath, True, True)\n    Dim sws As Worksheet: Set sws = swb.Sheets(&quot;Global_AB&quot;)\n    \n    ' Copy; import address book.\n    dws.Range(&quot;A2:A101&quot;).Formula = sws.Range(&quot;E2:E101&quot;).Formula\n    dws.Range(&quot;B2:B101&quot;).Formula = sws.Range(&quot;C2:C101&quot;).Formula\n    dws.Range(&quot;C2:C101&quot;).Formula = sws.Range(&quot;J2:J101&quot;).Formula\n    dws.Range(&quot;D2:D101&quot;).Formula = sws.Range(&quot;G2:G101&quot;).Formula\n    dws.Range(&quot;E2:E101&quot;).Formula = sws.Range(&quot;D2:D101&quot;).Formula\n    \n    ' Close the source workbook.\n    swb.Close SaveChanges:=False\n    \n    ' Save the destination workbook.\n    'dwb.Save\n    \n    ' Notify the user.\n    MsgBox &quot;Import complete.&quot;, vbInformation\n\nEnd Sub\n\nFunction SelectFolder(ByVal InitialFolderPath As String) As String\n    \n    ' Add a trailing path separator to the inital folder path if none.\n    Dim Separator As String: Separator = Application.PathSeparator\n    Dim IniPath As String: IniPath = InitialFolderPath\n    If Right(IniPath, Len(Separator)) &lt;&gt; Separator Then\n        IniPath = IniPath &amp; Separator\n    End If\n    \n    Dim fldr As FileDialog: Set fldr = _\n        Application.FileDialog(msoFileDialogFolderPicker)\n    \n    With fldr\n        .Title = &quot;Select a Folder&quot;\n        '.AllowMultiSelect = False ' can't be 'True' for the folder picker\n        .InitialFileName = IniPath\n        If .Show = -1 Then ' folder selected\n            SelectFolder = .SelectedItems(1)\n        'Else ' remains the default empty string (&quot;...) As String&quot;)\n        End If\n    End With\n\nEnd Function\n</code></pre>\n", "tags": ["excel", "vba"]}
{"id": "9c5d8fb4-f12f-4b93-8ed8-c8289975fdb1", "text": "Q: How to Query an NTP Server using C#? A: <p>Very good, based on the above answers, I have summarized this answer, and I believe my implementation has the best performance.</p>\n<p>Since the above answers have been explained quite clearly, I did not add any comments.</p>\n<p>I think this is what you need:</p>\n<pre class=\"lang-cs prettyprint-override\"><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Net;\nusing System.Net.Sockets;\n\nstatic class Program\n{\n    private static void Main()\n    {\n        List&lt;string&gt; ntpServers = [&quot;ntp.tencent.com&quot;, &quot;time.asia.apple.com&quot;, &quot;ntp.aliyun.com&quot;, &quot;time.windows.com&quot;, &quot;pool.ntp.org&quot;, &quot;ntp.tuna.tsinghua.edu.cn&quot;, &quot;ntp.ntsc.ac.cn&quot;];\n        var server = ntpServers.OrderBy(x =&gt; Guid.NewGuid()).FirstOrDefault();\n        var time = new DateTime(1900, 1, 1, 0, 0, 0, 0, DateTimeKind.Utc);\n        var data = new byte[48];\n        data[0] = 0x1B;\n        using Socket udp = new(AddressFamily.InterNetwork, SocketType.Dgram, ProtocolType.Udp)\n        {\n            SendTimeout = 5000,\n            ReceiveTimeout = 5000,\n        };\n        udp.SendTo(data, new IPEndPoint(Dns.GetHostAddresses(server).FirstOrDefault(), 123));\n        udp.Receive(data);\n        long intPart = IPAddress.NetworkToHostOrder(BitConverter.ToInt32(data, 40)) &amp; 0x00000000FFFFFFFFL;\n        long fractPart = IPAddress.NetworkToHostOrder(BitConverter.ToInt32(data, 44)) &amp; 0x00000000FFFFFFFFL;\n        long milliseconds = (intPart * 1000) + ((fractPart * 1000) &gt;&gt; 32);\n        var ntpDate = time.AddMilliseconds(milliseconds).ToLocalTime();\n        Console.WriteLine(&quot;Time: {0}, NTP Server: {1}&quot;, ntpDate, server);\n    }\n}\n</code></pre>\n", "tags": ["c#", "datetime", "ntp"]}
{"id": "99aa9c29-2555-46a9-a585-469a240d06db", "text": "Q: Fail to update elements in std::map&lt;string, CustomStruct&gt; A: <p>The problem is that in this line:</p>\n<pre><code>for (auto e:Towns)\n</code></pre>\n<p><code>auto</code> does not infer a reference, and therefore you get copies for the elements in the <code>std::map</code>. These copies get modified instead of the actual elements.</p>\n<p>To fix it add <code>&amp;</code> for a reference:</p>\n<pre><code>for (auto &amp; e: Towns)\n</code></pre>\n<p>Alternativly, as @PepijnKramer <a href=\"https://stackoverflow.com/questions/79849640/map-string-customstruct-doesnt-work-for-me#comment140907767_79849640\">commented</a> you can use:</p>\n<pre><code>for (auto&amp; [name,town] :Towns)\n</code></pre>\n<p>Which saves you the need for <code>.second</code> and you can simply use: <code>town.Selected = true;</code> etc.</p>\n<p><strong>A side note:</strong><br />\nYou referred to <em>&quot;hash-map&quot;</em> in your question.<br />\nAs @NathanOliver <a href=\"https://stackoverflow.com/questions/79849640/map-string-customstruct-doesnt-work-for-me#comment140907761_79849640\">commented</a>, <a href=\"https://en.cppreference.com/w/cpp/container/map.html\" rel=\"nofollow noreferrer\"><code>std::map</code></a> is usually implemented as a balanced tree.<br />\nFor a real hash-map you need <a href=\"https://en.cppreference.com/w/cpp/container/unordered_map.html\" rel=\"nofollow noreferrer\"><code>std::unordered_map</code></a>.</p>\n", "tags": ["c++", "structure", "stdmap"]}
{"id": "e553b9c4-809b-469d-ad83-78a76777cb94", "text": "Q: cout vs. fprintf vs. fputs A: <p>Yes it probably saw this somewhere (or it hallicunated)... the trouble is it had to learn from a lot of dumb examples online bad code examples outweigh good code examples by a lot and on top of that most examples are decades old (and thus written in a way we would not write code today anymore)! So simply put, don't trust LLM's one bit (even though the might get you started and can really help with code completion)</p>\n", "tags": ["c++", "logging"]}
{"id": "a7641cda-f124-4d1c-9637-615ef1349a5f", "text": "Q: Understand how caching helps in auto-refreshing Superset dashboards A: <p>I'm new to Superset and caching, but here's my understanding.</p>\n<p>If a reader opens a report that has recently been cached, instead of the report being run again, a cached version is fetched from Redis.  Redis can store and transmit data faster than a relational database - that's one advantage.  This reduces traffic on the database as well.</p>\n<p>The other advantage is that the cached report doesn't need to be re-computed, saving the need to run a potentially long-running and expensive query on your source database.</p>\n<p>You can watch this happen by entering your Redis instance (for Docker, that means entering the container with <code>docker exec -it superset_worker /bin/bash</code>) and then running <code>redis-cli</code>.  You can then run <code>MONITOR</code> to see all the transactions that are happening.  And in the main Superset app, you can see when a report is fetched from the cache.  Open those and then reload reports in your browser to generate the activity.</p>\n<p>Your block of code would set up caching only of filters.  You need similar blocks of code to set up filters for data, etc.  Check the <code>config.py</code> file to see all the cache values that can be overwritten, then supply blocks of code similar to the one you have in your post for the other caches.</p>\n<p>Here's a related post from <a href=\"https://chartio.com/blog/eliminating-duplicate-queries-using-distributed-locking/\" rel=\"nofollow noreferrer\">Chartio</a>, a Business Intelligence company that closed after being acquired, about the role of caching in serving their reports more efficiently.</p>\n", "tags": ["caching", "redis", "refresh", "dashboard", "apache-superset"]}
{"id": "431d4a12-510f-40c4-949a-772f7b98677e", "text": "Q: Powershell Cannot convert value of type &quot;System.String&quot; to type &quot;System.Management.Automation.ScriptBlock&quot; A: <p>Normally you would use -filepath to run a script as a job. You'd need to leave out the first and last lines of the file(<code>function Main {</code> and <code>}</code>). <code>@( )</code> is not necessary to create an array. See also the Threadjob module (<code>start-threadjob</code>) for creating jobs more quickly without new processes.</p>\n<pre><code>Start-Job -filepath $main -ArgumentList $dir,$i.ip,$i.openTime,$i.closeTime\nStart-ThreadJob -filepath $main -ArgumentList $dir,$i.ip,$i.openTime,$i.closeTime\n</code></pre>\n", "tags": ["powershell", "start-job"]}
{"id": "bdf43120-cc43-4a73-8627-b12d5355fda3", "text": "Q: Dynamic column header in datatable from json array A: <p>This code worked for me.</p>\n<p>I was getting an issue in the console with your code.</p>\n<p><em>Uncaught TypeError: Cannot read properties of undefined (reading 'aDataSort')</em></p>\n<p>Then I modified the code according to the code below.</p>\n<p>I used THEAD with TR</p>\n<p>And added few properties, and code worked</p>\n<p><strong>Output</strong></p>\n<p><a href=\"https://i.sstatic.net/9nS08cJK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/9nS08cJK.png\" alt=\"enter image description here\" /></a></p>\n<p><strong>Workable Code</strong></p>\n<pre><code>&lt;html&gt;\n&lt;head&gt;\n     &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.datatables.net/1.11.3/css/jquery.dataTables.min.css&quot;&gt;\n   \n&lt;/head&gt;\n&lt;body&gt;\n     &lt;table id=&quot;example&quot; class=&quot;display&quot; cellspacing=&quot;0&quot; width=&quot;100%&quot; border=&quot;1&quot;&gt;\n   &lt;thead&gt;\n     &lt;tr&gt;&lt;/tr&gt;\n   &lt;/thead&gt;\n &lt;/table&gt;\n     &lt;script type=&quot;text/javascript&quot; src=&quot;https://code.jquery.com/jquery-3.5.1.js&quot;&gt;&lt;/script&gt;\n    &lt;script type=&quot;text/javascript&quot; src=&quot;https://cdn.datatables.net/1.11.3/js/jquery.dataTables.min.js&quot;&gt;&lt;/script&gt;\n    &lt;script type=&quot;text/javascript&quot;&gt;\n        var JSONResult = '{&quot;column1&quot;:&quot;data1&quot;,&quot;column2&quot;:&quot;data2&quot;,&quot;column3&quot;:&quot;data3&quot;,&quot;columnN&quot;:&quot;dataN&quot;}';\n        var row_dtable = new Array();\n        var dtable_api = $('#example').dataTable({\n\n            bSort: false,\n            aoColumns: [ { sWidth: &quot;45%&quot; }, { sWidth: &quot;45%&quot; }, { sWidth: &quot;10%&quot;, bSearchable: false, bSortable: false } ],\n        &quot;scrollY&quot;:        &quot;200px&quot;,\n        &quot;scrollCollapse&quot;: true,\n        &quot;info&quot;:           true,\n        &quot;paging&quot;:         true\n        });\n\n            $.each(JSON.parse(JSONResult) , function(key, value) {\n                row_dtable.push(value);\n            });     \n            dtable_api.api().row.add(row_dtable).draw(false);  \n    &lt;/script&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n", "tags": ["javascript", "jquery", "html", "json", "datatables"]}
{"id": "bd7d709f-cc3e-45c5-b4a0-aebfc69ab94f", "text": "Q: Set Fixed Row Height in GridView A: <p>If you are using gridview, then I think you are also using another item_layout for displaying each item, I'm guessing it is an ImageView as you are trying to display images. Hence you can limit the size of the items to 100 x 100 in that item layout(ie, <code>android:layout_width=\"100dp\" android:layout_height=\"100dp\"</code>in the item_layout.) Hope it helps.</p>\n", "tags": ["android", "android-gridview"]}
