{"id": "3ca913c0-58bd-4c74-91df-402905c8264f", "text": "Q: JOIN parent table to a many-to-many table using CodeIgniter query building methods A: <p>I will strongly urge you to not execute subqueries in the SELECT clause because this tends to be a very poor performer.</p>\n<p>Instead, I'll demonstrate how to JOIN then pivot using GROUP BY and aggregate functions.  For your project, it will be very valuable to embrace the pivot technique when accessing map_userfields data.</p>\n<pre class=\"lang-php prettyprint-override\"><code>$pointCategory = ['type1', 'type2'];  // some made-up data\n\nreturn $this-&gt;db\n    -&gt;select([\n        'p.id',\n        'MAX(CASE WHEN uf.fieldid = 20 THEN uf.fieldvalue END) contact_name',\n        'MAX(CASE WHEN uf.fieldid = 31 THEN uf.fieldvalue END) contact_email'\n    ])\n    -&gt;join('map_userfields uf', 'p.id = uf.pointid', 'LEFT')\n    -&gt;where_in('p.type', $pointCategory)\n    -&gt;group_by('p.id')\n    -&gt;get('map_points p')\n    -&gt;result();\n</code></pre>\n<p>The rendered SQL (with improved spacing for readability)</p>\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT `p`.`id`,\n       MAX(CASE WHEN uf.fieldid = 20 THEN uf.fieldvalue END) contact_name,\n       MAX(CASE WHEN uf.fieldid = 31 THEN uf.fieldvalue END) contact_email\nFROM `map_points` `p`\nLEFT JOIN `map_userfields` `uf` ON `p`.`id` = `uf`.`pointid`\nGROUP BY `p`.`id`\nWHERE `p`.`type` IN('type1', 'type2')\n</code></pre>\n<ul>\n<li><p>You'll see that the rendered MAX() expressions aren't fully quoted, but this is a harmless outcome for this query.  If you wish to manually escape/quote the entities/values, CI has methods for this, but you'll need to muddy-up these expressions with verbose concatenation or interpolation.</p>\n</li>\n<li><p><code>result()</code> will return an array of zero or more objects.</p>\n</li>\n<li><p>A LEFT JOIN is used to enable the possibility of returning rows where a given p.id doesn't have related records in the <code>map_userfields</code> table.</p>\n</li>\n<li><p>If the pivot subquery doesn't find a fieldvalue with fieldid 20 or 31, you'll get <code>null</code> values for <code>contact_name</code> and <code>contact_email</code> in the result set -- just something to be aware of.</p>\n</li>\n</ul>\n", "tags": ["php", "mysql", "codeigniter", "pivot", "query-builder"]}
{"id": "480c8083-94d6-40fd-9e2c-ef046ecbb13a", "text": "Q: Cutting rows beginning with letter and past them after last cell of row beginning with number A: <p>Are blank cells actually blank or do they contain any formulas? What about blank cells like <code>A27:B27</code>? Should they be included as blank cells or omitted?</p>\n", "tags": ["excel", "vba"]}
{"id": "c1940f7a-d955-4bc9-a96a-51b193f5d82d", "text": "Q: Adjust vertical line based on maximum value in graph plotly A: <blockquote>\n<p>Now I want to have the vertical be the maximum height of the max bar shown in the plot</p>\n</blockquote>\n<p><strong>1.</strong>\nYou can add a vertical line <code>vline</code> that scales to the plot's y-range automatically like shown <a href=\"https://plotly.com/r/horizontal-vertical-shapes/\" rel=\"nofollow noreferrer\">here</a>. This is much simpler than adding it as a trace and works, since you don't want to toggle it via legend anyways.</p>\n<pre><code>library(plotly)\nlibrary(purrr)\n\np &lt;- plotly::plot_ly()\n\npurrr::walk(unique(mtcars$carb), function(carb) {\n  p &lt;&lt;- p |&gt;\n    add_trace(data = df_mtcars[df_mtcars$carb == carb,],\n              x = ~gear, \n              y = ~mpg, \n              color = ~carb, type = &quot;bar&quot;,\n              visible = if (carb == 3) {TRUE} else {&quot;legendonly&quot;}) \n})\n\n\np |&gt;\n  layout(shapes = list(\n    list(\n      type = &quot;line&quot;,\n      y0 = 0,\n      y1 = 0.95, # will always scale to the max because 95% of the \n                 # y-scale is always the max value\n      yref = &quot;paper&quot;,\n      x0 = 0,\n      x1 = 0,\n      line = list(color = &quot;red&quot;, dash = &quot;dot&quot;)\n    )\n  ))\n</code></pre>\n<p><a href=\"https://i.sstatic.net/l2sfRO9F.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/l2sfRO9F.gif\" alt=\"res\" /></a></p>\n<p><strong>2.</strong>\nIf you want to retain the hover functionality, you can</p>\n<ol>\n<li>add your line as a last trace with the correct y-data for the first glance</li>\n<li>whenever the plot is redrawn, for example if the legend was clicked, then delete this last line trace and re-add it back with the y-length of <code>el.layout.yaxis.range[1]* 0.95</code></li>\n</ol>\n<pre><code>p &lt;- plotly::plot_ly()\n\npurrr::walk(unique(mtcars$carb), function(carb) {\n  p &lt;&lt;- p |&gt;\n    add_trace(data = df_mtcars[df_mtcars$carb == carb,],\n              x = ~gear, \n              y = ~mpg, \n              color = ~carb, type = &quot;bar&quot;,\n              visible = if (carb == 3) {TRUE} else {&quot;legendonly&quot;}) \n})\n\np |&gt;\n  add_trace(type = &quot;scatter&quot;, mode = &quot;lines&quot;,\n            x = c(factor(3), factor(3)),\n            y = c(0, sum(df_mtcars[df_mtcars$carb == 3,]$mpg)),\n            line = list(color = &quot;red&quot;, width = 2, dash = &quot;dash&quot;),\n            showlegend = FALSE, hovertemplate = '&lt;i&gt;Max-Y-Value&lt;/i&gt;: %{y}') |&gt;\n  htmlwidgets::onRender(&quot;\n    function(el) {\n      \n      el.on('plotly_restyle', function(data) {\n        Plotly.deleteTraces(el, [-1]);\n        // help from here: https://plotly.com/javascript/hover-text-and-formatting/\n        // Add trace back with same style but updated y range\n        Plotly.addTraces(el, {\n          type: 'scatter',\n          mode: 'lines',\n          x: [3, 3],  \n          y: [0, el.layout.yaxis.range[1]* 0.95], \n          line: {color: 'red', width: 2, dash: 'dash'},\n          hovertemplate: '&lt;i&gt;Max-Y-Value&lt;/i&gt;: %{y}',\n          showlegend: false\n        });\n\n        return true;\n      });\n    }\n  &quot;)\n</code></pre>\n<p><a href=\"https://i.sstatic.net/9ZNUmeKN.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/9ZNUmeKN.gif\" alt=\"res\" /></a></p>\n<p><strong>NOTE</strong> Both approaches assume, that the user does not manually rescale the y-axis. If they do so, the red line would also go right up to the y-range value. If you want to make this more robust, you would need to iterate over the 7 traces in data.data, take the ones which have &quot;visible = true&quot; and add up each common bar to get the maxima, then assign it to the vertical line.</p>\n<h2>data</h2>\n<pre><code>set.seed(7)\ndf &lt;- data.frame(\n  group = rep(LETTERS[1:4], each = 4),\n  subgroup = letters[1:16],\n  value = sample.int(16)\n)\n\ndf_mtcars &lt;- mtcars |&gt;\n  transform(gear = as.factor(gear),\n         carb = as.factor(carb))\n</code></pre>\n", "tags": ["r", "plotly"]}
{"id": "05e33519-6f58-4f1f-b01f-6225af49d6b3", "text": "Q: Rails 7 + Turbo: Turbo navigates away when receiving 422 unprocessable entity A: <h1>Cause 3: No scripts in the head</h1>\n<p>This also happens if the 422 response is a perfectly well formed page but has no scripts in the <code>&lt;head&gt;</code> tag. Which is absolutely ridiculous since Turbo merges the head anyway so would retain the scripts. And no warning in the in the console, nothing in the Rails log...</p>\n<p>I've raised a bug on Turbo: <a href=\"https://github.com/hotwired/turbo-rails/issues/773\" rel=\"nofollow noreferrer\">422 without scripts in head leads to GET</a></p>\n", "tags": ["forms", "http", "ruby-on-rails-7", "turbo", "rails7"]}
{"id": "8f590773-b914-4b4c-8214-b1a6520e8eec", "text": "Q: SwiftData: Best practices for adding / removing to / from a child model object array A: <p>Optional arrays invite optional\u2011chaining (<code>parent.children?.append</code>) and can obscure observation updates.</p>\n<pre><code>\n@Model\nfinal class Parent {\n    @Relationship(deleteRule: .cascade, inverse: \\Child.parent)\n    var children: [Child] = []        \n    init() {}\n}\n\n@Model\nfinal class Child {\n    var name: String\n    var dateCreated: Date = .init()\n    var parent: Parent                 \n    init(name: String, parent: Parent) {\n        self.name = name\n        self.parent = parent\n    }\n}\n</code></pre>\n<p>Using <code>deleteRule: .cascade</code> on the <strong>parent side</strong> is the intended way to delete children when the parent is deleted. Avoid dual <code>.cascade</code> on both sides</p>\n<p>You can append to parent's array :</p>\n<pre><code>\nfunc addChild(name: String, to parent: Parent) {\n    let child = Child(name: name, parent: parent)\n    parent.children.append(child)  \n}\n</code></pre>\n<p>then assign the parent on the child:</p>\n<pre><code>\nfunc addChild(name: String, to parent: Parent) {\n    let child = Child(name: name, parent: parent)  \n}\n</code></pre>\n<p>SwiftData\u2019s <code>ModelContext</code> can infer and insert related models when you insert the <strong>root</strong> of a new graph. When the parent is already in the context, mutating its relationship (or the child\u2019s inverse) registers the child with the context; you don\u2019t need to call <code>insert(_:)</code> on both sides</p>\n<p>Kindly clean up the optionality to avoid <code>?.append</code> and <code>?.remove</code></p>\n<pre><code>var children: [Child] = []\n</code></pre>\n<p>Altogether:</p>\n<pre><code>\nimport SwiftUI\nimport SwiftData\n\n@Model\nfinal class Parent {\n    @Relationship(deleteRule: .cascade, inverse: \\Child.parent)\n    var children: [Child] = []\n    init() {}\n}\n\n@Model\nfinal class Child {\n    var name: String\n    var dateCreated: Date = Date()\n    var parent: Parent\n    init(name: String, parent: Parent) {\n        self.name = name\n        self.parent = parent\n    }\n}\n\nstruct ContentView: View {\n    @Environment(\\.modelContext) private var modelContext\n    @Query(sort: \\Parent.children.count, order: .reverse) private var parents: [Parent]\n    @Query(sort: \\Child.dateCreated) private var allChildren: [Child]\n\n    var body: some View {\n        List {\n            ForEach(parents) { parent in\n                Section(&quot;Add / Remove Children&quot;) {\n                    ForEach(parent.children.sorted { $0.dateCreated &lt; $1.dateCreated }) { child in\n                        Text(child.name)\n                            .swipeActions {\n                                Button(role: .destructive) {\n                                    removeChild(child)\n                                } label: {\n                                    Image(systemName: &quot;trash&quot;)\n                                }\n                            }\n                    }\n                    Button(&quot;Add Child&quot;) {\n                        addChild(named: &quot;Child #\\(parent.children.count + 1)&quot;, to: parent)\n                    }\n                }\n\n                Section(&quot;All Children&quot;) {\n                    ForEach(allChildren) { child in\n                        Text(child.name)\n                    }\n                }\n            }\n        }\n        .onAppear {\n            // Reset demo data\n            try? modelContext.delete(model: Parent.self)\n            let p = Parent()\n            modelContext.insert(p)    // insert root; children will be tracked automatically\n        }\n    }\n\n    private func addChild(named name: String, to parent: Parent) {\n        let newChild = Child(name: name, parent: parent)\n        parent.children.append(newChild)   // or just rely on the initializer setting parent\n        // No separate insert needed because parent is already in the context\n    }\n\n    private func removeChild(_ child: Child) {\n        modelContext.delete(child)         // canonical delete; no manual array removal\n    }\n}\n</code></pre>\n<p>We removed optionality from <code>children</code>, used a single mutation path, and relied on <code>delete(_:)</code> for removals. In <code>onAppear</code>, <code>delete(model:)</code> clears prior data in one call.</p>\n<p>Use non\u2011optional arrays for collections, define inverse relationships, and put <code>.cascade</code> on the parent side.</p>\n<p>Mutate one side consistently (append to parent <em>or</em> set child\u2019s parent), and delete via <code>modelContext.delete</code>. Don\u2019t manually keep the two sides in sync.</p>\n<p>Ensure SwiftUI updates by using <code>@Query</code> / <code>@Bindable</code> and relying on autosave or <code>save()</code>.</p>\n", "tags": ["swiftui", "swiftdata", "swift-data-modelcontext"]}
{"id": "abba49ac-22ec-455b-8565-943cce253257", "text": "Q: How to Fit a Binomial GLMM with Pseudo-Likelihood? A: <p>Currently, the most relevant implementation in R that I am aware of is a fork of the MASS package that was recently published on GitHub by my colleague Daniel. <a href=\"https://github.com/dgpalmer2/MASS.empiricalPQL\" rel=\"nofollow noreferrer\">Link to MASS.empiricalPQL repo</a></p>\n<p>The official CRAN version of the MASS package has the function <code>glmmPQL()</code> which implements penalized quasi-likelihood (PQL). As @creutzml correctly says in the question, that's not the same thing as pseudo-likelihood (PL). The forked version of MASS that Daniel has been working on does not directly implement REML-like pseudolikelihood (PL) either. Instead, it modifies the PQL algorithm in <code>glmmPQL()</code> to give similar results, in fact numerically identical in many cases. More research is needed to investigate scenarios where the results may differ, and determine why. This is an ongoing research effort of our group.</p>\n<p>The official version of <code>glmmPQL()</code> implements PQL by repeatedly calling <code>lme()</code> with the argument <code>method = 'ML'</code>. Daniel's version allows setting <code>method = 'REML'</code> in the call to <code>lme()</code>. This produces nearly identical results to SAS's <code>PROC GLIMMIX</code> using its default residual PL estimation.</p>\n<h2>Example</h2>\n<p>I simulated some binomial data based on an example originally provided by Daniel, to ensure that there would be a nonzero variance estimate. The following R code and SAS code should produce numerically nearly identical results. The SAS code and output is provided as evidence that the R implementation gives comparable results to a known implementation of PL outside of R. Note that the SAS code has <code>random _residual_</code> to include the scale parameter. <code>glmmPQL()</code> does not support a model that doesn't include that parameter.</p>\n<h3>R code</h3>\n<pre><code>library(MASS.empiricalPQL) # Install with remotes::install_github('dgpalmer2/MASS.empiricalPQL')\nlibrary(emmeans)\nlibrary(nlme)\n\nexample_data &lt;- data.frame(\n  genotype = rep(factor(paste0('gen', 1:5)), times = 4),\n  block = rep(factor(paste0('blk', 1:4)), each = 5),\n  n = c(16L, 11L, 13L, 14L, 24L, 17L, 11L, 12L, 13L, 13L, 15L, 11L, \n        18L, 17L, 18L, 18L, 15L, 7L, 16L, 19L),\n  Y = c(1L, 11L, 11L, 11L, 11L, 4L, 11L, 8L, 12L, 9L, 1L, 9L, 13L, \n        11L, 9L, 12L, 14L, 7L, 15L, 18L)\n)\n\nmodel &lt;- glmmPQL(cbind(Y, n - Y) ~ genotype, random = ~ 1 | block,\n                 family = binomial, data = example_data,\n                 method = &quot;REML&quot;)\nsummary(model)$tTable\nVarCorr(model)\njoint_tests(model)\nemmeans(model, ~ genotype, df = 12)\npairs(emmeans(model, ~ genotype, df = 12))\n</code></pre>\n<h3>Selected R output</h3>\n<p>The output of <code>summary()</code>, <code>VarCorr()</code>, and <code>joint_tests()</code> is shown but not the <code>emmeans()</code> and <code>pairs()</code> output in the interest of space.</p>\n<pre><code>&gt; summary(model)$tTable\n                      Value Std.Error DF   t-value      p-value\n(Intercept)       -1.223879 0.6614897 12 -1.850186 8.905189e-02\ngenotypegenotype2  4.156880 0.7434795 12  5.591115 1.177923e-04\ngenotypegenotype3  2.928254 0.5327567 12  5.496419 1.370414e-04\ngenotypegenotype4  2.979355 0.5228759 12  5.698016 9.944179e-05\ngenotypegenotype5  1.961918 0.4543992 12  4.317608 1.000324e-03\n&gt; VarCorr(model)\nblock = pdLogChol(1) \n            Variance StdDev  \n(Intercept) 1.299366 1.139897\nResidual    1.132967 1.064409\n&gt; joint_tests(model)\n model term df1 df2 F.ratio p.value\n genotype     4  12  13.067  0.0002\n</code></pre>\n<h3>SAS code</h3>\n<pre><code>data example_data;\ninput genotype $ block $ n Y;\ndatalines;\ngen1 blk1 16 1\ngen2 blk1 11 11\ngen3 blk1 13 11\ngen4 blk1 14 11\ngen5 blk1 24 11\ngen1 blk2 17 4\ngen2 blk2 11 11\ngen3 blk2 12 8\ngen4 blk2 13 12\ngen5 blk2 13 9\ngen1 blk3 15 1\ngen2 blk3 11 9\ngen3 blk3 18 13\ngen4 blk3 17 11\ngen5 blk3 18 9\ngen1 blk4 18 12\ngen2 blk4 15 14\ngen3 blk4 7 7\ngen4 blk4 16 15\ngen5 blk4 19 18\n;\n\nproc glimmix data=example_data; \nclass block genotype(ref='gen1'); \nmodel y/n = genotype / solution; \nrandom intercept / subject = block; \nrandom _residual_; \nlsmeans genotype / cl pdiff; \nrun; \n</code></pre>\n<h3>Selected SAS output</h3>\n<p>This is a screenshot of the portion of the SAS output corresponding to the R output from above, to confirm the results are comparable.</p>\n<p><a href=\"https://i.sstatic.net/CbXQ4nbr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/CbXQ4nbr.png\" alt=\"Screenshot of SAS PROC GLIMMIX output\" /></a></p>\n", "tags": ["r", "binary-data", "glmm"]}
{"id": "ab980c30-778a-4521-96b1-cc55e404f4c7", "text": "Q: Is Stack Overflow still actively used by developers in 2025? A: <p>I can confirm that for the Python tag, 4 questions in a few hours span is &quot;essentially zero&quot; compared to previous (~18 months ago)  levels - yes.</p>\n<p>We get most configuration questions, these days, a few novice people (who, due to not knowing exactly how to formulate the question are sometimes downvoted and closed)  - and an eventual &quot;big question&quot; that an experienced developer or team places when finding a barrier they could not LLM their way around. (so either  &quot;very easy, but I don't want to re-explain the basics, and ... it is a duplicate&quot; or &quot;more advanced than I can tackle&quot; questions - with mid level, nice to go through in a hobbyist hour, gone)</p>\n<p>But then, coming to this question - it is still an invaluable resource for the people putting in the hard questions: LLMs can't do them. The last of these I interacted with actually brought the attentions of core-language developers to a bug in the runtime.</p>\n", "tags": ["sharepoint-discussion-board"]}
{"id": "4eaba8f9-a522-4551-a6c6-1edb5aaafad5", "text": "Q: Hollow Diamond Pattern in Cpp A: <p>I got lost in all the IFs.  I used a for loop and abs(i) to make the space grow and then shrink:</p>\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt; \nusing namespace std;\n\nint main(int argc, char** argv) {\n   int x,space,size;\n   string stars;\n   size = 11;\n   cout&lt;&lt;string(size,'*')&lt;&lt;endl; // top \n   x = size-2; // -2 for top and bot\n   for (int i = x-1;i &gt;-x;i-=2) { //x=5 i= 4,2,0,-2,-4 \n      space = x-abs(i); //                 1,3,5, 3, 1\n      stars = string(size/2-(space/2),'*'); // half of stars\n      cout&lt;&lt;stars&lt;&lt;string(space,' ')&lt;&lt;stars&lt;&lt;endl;\n   }\n   cout&lt;&lt;string(size,'*')&lt;&lt;endl; // bot \n   return 0;\n}\n</code></pre>\n<p>Output:</p>\n<pre class=\"lang-none prettyprint-override\"><code>$ g++ -o test hollow.cpp \n$ ./test\n\n***********\n***** *****\n****   ****\n***     ***\n**       **\n*         *\n**       **\n***     ***\n****   ****\n***** *****\n***********\n</code></pre>\n", "tags": ["c++"]}
