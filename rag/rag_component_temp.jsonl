{"id": "ac75e489-4326-4197-a341-fcd16e4fb8ec", "text": "Q: String Rotation in Java A: <p>Sorry, this is my account.</p>\n<pre><code>public static boolean isRotated(String s1, String s2) {\n    if (s1 == null &amp;&amp; s1 != s2) {\n        return false;\n    }\n    // I'm not sure null is rotated of null?\n    if (s1 == null &amp;&amp; s2 == null) {\n        return true; // or return false; \n    }\n    if (s1.length() != s2.length()) {\n        return false;\n    }\n    int leftIndex = 0, rightIndex = s2.length() - 1;\n    while (leftIndex &lt; s1.length()) {\n        if (s1.charAt(leftIndex++) != s2.charAt(rightIndex--)) {\n            return false;\n        }\n    }\n    return true;\n}\n</code></pre>\n", "tags": ["java", "arrays", "string", "methods", "dsa"]}
{"id": "0c4cae41-28dd-498e-b042-a82efd406545", "text": "Q: Set text align to center in an Excel document using OpenXML with C# A: <p>Complete-ish example using shared CellFormat instead of defining the same style for every cell (also apparently <code>ApplyAlignment = true</code> isn't needed):</p>\n<pre class=\"lang-cs prettyprint-override\"><code>using (MemoryStream stream = new MemoryStream())\n{\n    using (SpreadsheetDocument doc = SpreadsheetDocument.Create(stream, SpreadsheetDocumentType.Workbook))\n    {\n        WorkbookPart workbookPart = doc.AddWorkbookPart();\n        workbookPart.Workbook = new Workbook();\n\n        var stylesPart = workbookPart.AddNewPart&lt;WorkbookStylesPart&gt;();\n        stylesPart.Stylesheet = new Stylesheet();\n\n        // HERE WE DEFINE CELL FORMATS\n        stylesPart.Stylesheet.CellFormats = new CellFormats();\n        stylesPart.Stylesheet.CellFormats.AppendChild(new CellFormat());\n        stylesPart.Stylesheet.CellFormats.AppendChild(new CellFormat { Alignment = new Alignment { Vertical = VerticalAlignmentValues.Center, Horizontal = HorizontalAlignmentValues.Center } });\n\n        // HERE WE CREATE A CELL TO USE THIS ALIGNMENT STYLE\n        SheetData data = new SheetData();\n        Row row = data.AppendChild(new Row());\n        row.AppendChild(new Cell\n        {\n            DataType = CellValues.String,\n            CellValue = new CellValue(&quot;TEST&quot;),\n            StyleIndex = 1,\n        });\n\n        WorksheetPart worksheetPart = workbookPart.AddNewPart&lt;WorksheetPart&gt;();\n        worksheetPart.Worksheet = new Worksheet(data);\n\n        Sheets sheets = doc.WorkbookPart.Workbook.AppendChild(new Sheets());\n        Sheet sheet = new Sheet()\n        {\n            Id = doc.WorkbookPart.GetIdOfPart(worksheetPart),\n            SheetId = 1,\n            Name = &quot;Title&quot;\n        };\n\n        sheets.AppendChild(sheet);\n        workbookPart.Workbook.Save();\n    }\n\n    return stream.ToArray();\n}\n</code></pre>\n", "tags": ["c#", "excel", "openxml", "export-to-excel"]}
{"id": "6c7b175a-b968-4320-b86c-e46417d2fa22", "text": "Q: Trying to set a button that establishes a macro for other buttons (and excludes other buttons not in a specified range) A: <p>Cells do not contain Buttons \u2014 Buttons sit on top of Cells.</p>\n<p>However, Shapes (including Buttons) <em>do</em> record the Cells that they overlap \u2014 or, at least, they record the Cells in their Top-Left corner and Bottom-Right Corner (conveniently enough, as <a href=\"https://learn.microsoft.com/en-us/office/vba/api/excel.shape.topleftcell\" rel=\"nofollow noreferrer\">the <code>Shape.TopLeftCell</code></a> and <a href=\"https://learn.microsoft.com/en-us/office/vba/api/excel.shape.bottomrightcell\" rel=\"nofollow noreferrer\"><code>Shape.BottomRightCell</code> properties</a>), allowing you to establish a rectangle of Cells that they overlaps.</p>\n<p>Therefore, instead of looking at each <em>Cell</em> to see if it contains a <em>Button</em>, you need to flip things upside-down and look at each <em>Button</em> to see if it falls within the <em>Range</em>.</p>\n<pre><code>Sub Set_Spinner_Cell()\n    Dim shp AS Shape\n    \n    With ActiveSheet\n        For Each shp In .Shapes 'All Shapes in Sheet\n            If shp.Type = msoFormControl Then 'Is a Form Control\n                If shp.FormControlType = xlButtonControl Then 'Is A Button\n                    If Not (Intersect(.Range(shp.TopLeftCell, shp.BottomRightCell), _\n                            .Range(&quot;$N$2:$N$90&quot;)) Is Nothing) Then 'Overlaps Target Range\n                        shp.OnAction = &quot;Set_CD_Used&quot; 'Set the Macro to use when clicked\n                End If\n            End If\n        Next shp\n    End With\nEnd Sub\n</code></pre>\n", "tags": ["excel", "vba"]}
{"id": "bb55a890-8447-492e-b23b-56dc6cb40065", "text": "Q: Why are rows silently overwritten in a TimeSeries container when inserting duplicate timestamps? A: <p>Yes, it is intended behavior for GridDB Time Series containers when using the <code>put()</code> method. To insert only unique timestamps and raising an error on duplicates, you must use the <code>insert()</code> method instead of <code>put()</code>.</p>\n<pre class=\"lang-py prettyprint-override\"><code>import griddb_python as griddb\nfrom datetime import datetime\n\ncontainer = store.get_container(&quot;sensor_ts&quot;)\nts = datetime(2024, 6, 1, 12, 0, 0)\n\ntry:\n    container.insert((ts, 10.0))\n    container.insert((ts, 25.0)) # GSException\n\nexcept griddb.GSException as e:\n    print(e.get_message())\n\nexcept Exception as e:\n    print(e.get_message())\n</code></pre>\n", "tags": ["griddb"]}
{"id": "33417566-f3bd-4d38-af00-dd7909e7c511", "text": "Q: Vectorize repeated computation using list slices depending on loop index A: <p>You are correct that Python loops should be avoided if you can vectorize the computation. There is no reason to initialise <code>z</code> with zeros. Your current output for <code>z</code> is:</p>\n\n<pre><code>array([0.        , 0.        , 0.00273973, 0.00820417, 0.01635591,\n       0.02713557, 0.04046248, 0.0562357 , 0.07433529, 0.09462383,...]\n</code></pre>\n\n<p>I'm not sure whether the double <code>0</code> values are actually desirable (I'll update if so). The simplest drop-in replacement for the current approach is just using <a href=\"https://numpy.org/doc/stable/reference/generated/numpy.cumprod.html?highlight=cumprod#numpy.cumprod\" rel=\"nofollow noreferrer\"><code>numpy.cumprod</code></a>:</p>\n\n<pre><code>import numpy as np\n\ndef foo(n):\n    return(365-n)/365\n\nlim = 50\nx = np.arange(0, lim, 1)\n\ny = foo(x)\nz = 1 - np.cumprod(y)\n</code></pre>\n", "tags": ["python", "numpy"]}
