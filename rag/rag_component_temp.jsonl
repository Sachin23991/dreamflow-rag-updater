{"id": "945c9f95-f580-4eb8-83d2-bfae3c71d83e", "text": "Q: Getting an Azure Keyvault 403 (forbidden) error when trying to connect to Azure Keyvault A: <p><code>App Configuration Data Reader</code> gives you only this one permission: <code>Microsoft.AppConfiguration/configurationStores/*/read</code>.\nSo it only allows reading data in App Configuration.</p>\n<p>Key vault secrets are not stored in App Configuration, only a reference is stored.\nYou also need a role that gives you access to the Key Vault.\nFor example <code>Key Vault Secrets User</code> as mentioned in a comment.\nThis gives you the minimal rights for reading secrets:</p>\n<ul>\n<li>Microsoft.KeyVault/vaults/secrets/getSecret/action</li>\n<li>Microsoft.KeyVault/vaults/secrets/readMetadata/action</li>\n</ul>\n", "tags": ["azure", "azure-keyvault"]}
{"id": "081b9dcb-8a97-478d-bc63-b719f4008b64", "text": "Q: Azure Pipeline MS-hosted mac agent: CopyFiles Task takes a very long time A: <p>The problem seems to have been due to the contents of my <code>.dmg</code>, which contains <code>MyApp.app</code> and a symbolic link to <code>/Applications</code> (so users can drag App to install). If I remove the link, the copy operation behaves normally.</p>\n<p>I found a <strong>workaround</strong>: Use a Finder 'alias' instead of symbolic link.</p>\n<p>I'm running the following in a <code>bash</code> step to create an alias in the current working directory:</p>\n<pre class=\"lang-bash prettyprint-override\"><code>osascript -e 'tell application &quot;Finder&quot;' \\\n   -e &quot;make alias file to (POSIX file \\&quot;/Applications\\&quot;) \\ \n      at (POSIX file \\&quot;$PWD\\&quot;) with properties {name:\\&quot;Applications\\&quot;}&quot; \\\n   -e 'end tell'\n</code></pre>\n<p>(For reference: I used to create the symlink like this: <code>ln -s /Applications Applications</code>)</p>\n", "tags": ["azure", "macos", "azure-pipelines", "azure-pipelines-tasks", "azure-agent"]}
{"id": "2e05f454-793f-4dd4-a5fc-c86467824ecd", "text": "Q: Why ReadManyItemsAsync&lt;T&gt; uses very high RU and does essentially full table scan? A: <p>[My wiser self after consultation with Microsoft in conversation with my old now bald self after pulling all the hairs out]</p>\n<ul>\n<li><p>The short of it is, you need to add the Partition Key(s) to the index. You have been good in removing everything but add those Hierarchical items PKs back in there and your problem is over.</p>\n</li>\n<li><p><strong>Wow... You are so wise! Yeah issue is sorted, RU charge is back at very low. So I will gleefully always add them to my index.</strong></p>\n</li>\n<li><p>Well, not if all you want to do is to look up.</p>\n</li>\n<li><p><strong>Ha?? Dude, that is all I am doing, are you blind not to see I am looking up by id and pk using <code>ReadManyItemsAsync</code>??</strong></p>\n</li>\n<li><p>Yes, you do but the SDK is doing a query on your behalf. It was explained [here](<a href=\"https://stackoverflow.com/questions/74828204/why-does-readmanyitemsasync-perform-query-operation-when-ms-docs-says-it-doesnt\">Why does ReadManyItemsAsync perform query operation when MS docs says it doesn&#39;t in Cosmos?</a>), was this not the first entry you stumbled upon when you still had hair?</p>\n</li>\n<li><p><strong>Ah yeah, damn! I read it but did not click... OK, it is weird, why?</strong></p>\n</li>\n<li><p>Well it is faster to read many items by query - don't ask me, apparently it is.</p>\n</li>\n<li><p><strong>OK I think I got you! You see, you are lying because I tried python SDK and it costed me 2 RUs - none of this index and query nonesense.</strong></p>\n</li>\n<li><p>How many items did you request in python's <code>container.read_items?</code></p>\n</li>\n<li><p><strong>Well... I think one, what's the difference one or 7 or 25?</strong></p>\n</li>\n<li><p>There you go! Python and Java SDK would do look up if you pass 1 item, otherwise query.</p>\n</li>\n<li><p><strong>Sorry I am confused!</strong></p>\n</li>\n<li><p>Tell me about it...</p>\n</li>\n</ul>\n", "tags": ["c#", "azure-cosmosdb"]}
{"id": "69488689-f5cb-47d8-87ff-b3c0ec5d75a0", "text": "Q: Custom document icon not showing in macOs Document based app A: <p>Finder is not showing a full icon because you specified a <strong>badge</strong>, not the icon itself. <code>UTTypeIconBadgeName</code> does not replace the icon entirely, it overlays a small symbol on top of the standard document or package icon. That\u2019s why you end up with a white file and your icon stamped in the center.</p>\n<p>Was (badge):</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;key&gt;UTTypeIcons&lt;/key&gt;\n&lt;dict&gt;\n    &lt;key&gt;UTTypeIconBadgeName&lt;/key&gt;\n    &lt;string&gt;PhiaDocumentIcon&lt;/string&gt;\n&lt;/dict&gt;\n</code></pre>\n<p>Should be (full icon):</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;key&gt;UTTypeIcons&lt;/key&gt;\n&lt;dict&gt;\n    &lt;key&gt;UTTypeIconBackgroundName&lt;/key&gt;\n    &lt;string&gt;PhiaDocumentIcon&lt;/string&gt;\n&lt;/dict&gt;\n</code></pre>\n<p><code>PhiaDocumentIcon</code> is an image set in <code>Assets.xcassets</code>.</p>\n<p>If you want the file to look like <code>.xcodeproj</code> with a icon, you need to use a background instead of a badge. That means either <code>UTTypeIconBackgroundName</code>, or <code>.icns</code> approach via <code>UTTypeIconFile</code>. One option is to create <code>PhiaDocumentIcon.icns</code>, place it in the app bundle, and reference it directly.</p>\n<ol>\n<li>Create <code>PhiaDocumentIcon.icns</code> (via Icon Composer or <code>iconutil</code>)</li>\n<li>Put the file into the app bundle</li>\n<li>Reference it directly:</li>\n</ol>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;key&gt;UTTypeIcons&lt;/key&gt;\n&lt;dict&gt;\n    &lt;key&gt;UTTypeIconFile&lt;/key&gt;\n    &lt;string&gt;PhiaDocumentIcon.icns&lt;/string&gt;\n&lt;/dict&gt;\n</code></pre>\n<p>(In this case, <code>Assets.xcassets</code> can be omitted entirely.)</p>\n<p>Also the file itself must be a package, not just a file with a <code>.phia</code> extension. From Finder\u2019s point of view, it has to be a directory. If <code>ls -l</code> shows a regular file, Finder will not draw a full package icon. And if the file was created before you fixed this setup, Finder may have cached the type. In that case it\u2019s usually easier to create a new <code>.phia</code> file.</p>\n<p>The file must be a directory:</p>\n<pre class=\"lang-bash prettyprint-override\"><code>ls -l MyFile.phia\n</code></pre>\n<p>Expected result:</p>\n<pre><code>drwxr-xr-x  MyFile.phia\n</code></pre>\n<p>If it\u2019s a regular file:</p>\n<pre><code>-rw-r--r--  MyFile.phia\n</code></pre>\n<p>then Finder will not show the icon.</p>\n<p><strong>Creating a package</strong></p>\n<pre class=\"lang-swift prettyprint-override\"><code>let url = FileManager.default\n    .urls(for: .documentDirectory, in: .userDomainMask)[0]\n    .appendingPathComponent(&quot;Test.phia&quot;)\n\ntry FileManager.default.createDirectory(\n    at: url,\n    withIntermediateDirectories: true\n)\n</code></pre>\n<p><strong>If Finder has cached the type</strong></p>\n<p>The simplest way:</p>\n<pre class=\"lang-bash prettyprint-override\"><code>mv Old.phia New.phia\n</code></pre>\n<p>or just create a new <code>.phia</code> after fixing <code>Info.plist</code>.</p>\n<p>So overall, you\u2019re using a badge instead of an icon, possibly relying on a PNG from Assets, and there\u2019s also a chance the file isn\u2019t really a package. Fix those things and Finder should display the icon the way you expect.</p>\n", "tags": ["macos", "swiftui"]}
{"id": "bc0e2601-1123-41c0-a432-406af6153151", "text": "Q: How to tell if a website is using next.js? A: <p>The <code>id=&quot;__next&quot;</code> DOM element and <code>X-Powered-By: Next.js</code> header have been absent since Next 13 or thereabouts. The current Next version at time of writing is 16.0.10.</p>\n<p>Today, the best way I've found is to inspect the Sources in Dev Tools. A Next site will likely pull static files from a folder named <code>_next/static</code>, including CSS, images, and client-side JavaScript chunks.</p>\n", "tags": ["reactjs", "next.js", "server-side-rendering"]}
{"id": "6e0d1043-8cdf-445c-ad60-d4f35fba5844", "text": "Q: Why does `tcc` compile local variables onto the stack? A: <p>TCC is the least-optimizing most literal compiler.  It's optimized for compiling fast not making efficient code, including for use-cases like <code>#!/bin/tcc</code> scripts that compile for every run.</p>\n<p>Your variable has automatic storage-class, not <code>static</code>, so of course it's on the stack.  GCC and Clang do the same; with <code>-O3</code> they use a 16-byte vector to copy from <code>.rodata</code>.  With <code>-Os</code>, GCC makes more efficient code that just uses <code>mov x0, 10</code> ; <code>stp x0, xzr, [sp, 16]</code>.  <code>-O3</code> should do that, too; that's a missed optimization in GCC and Clang.</p>\n<p>TCC uses many fixed recipes so it can be as one-pass as possible, although to be fair this struct initializer is all part of one statement, so it's not unreasonable to hope it would just use <code>stp</code>.  I wonder if memset zeroing is part of a struct-init recipe for handling initializer-lists, in case they don't mention every member.  Then code-gen can be as simple as emitting a store for each named initializer, in order, without having to sort them or keep track of whether any non-padding bytes of the struct weren't initialized.  (Especially in the general case where you might have a union of structs.)</p>\n<p>TCC's goals including being simple I think (the compiler source code itself), so a simple recipe that handles the general case makes sense.</p>\n<p>The stupid Stacks editor in WYSIWYG mode isn't letting me use a Godbolt full URL as a URL, and already ate one version of this answer.</p>\n<p><a href=\"https://godbolt.org/#g:!((g:!((g:!((h:codeEditor,i:(filename:%271%27,fontScale:14,fontUsePx:%270%27,j:1,lang:%5C___c,selection:(endColumn:1,endLineNumber:10,positionColumn:1,positionLineNumber:10,selectionStartColumn:1,selectionStartLineNumber:10,startColumn:1,startLineNumber:10),source:%27%23include%3Ctime.h%3E%0A%0Avoid+fun()+%7B%0A++asm(%22arg1:%22)%3B%0A++struct+timespec+const+a+%3D+%7B+.tv_sec+%3D+10,+.tv_nsec+%3D+0+%7D%3B%0A++asm(%22call_nanosleep:%22)%3B%0A++nanosleep(%26a,NULL)%3B%0A++asm(%22return:%22)%3B%0A%7D%0A%27),l:%275%27,n:%270%27,o:%27C+source+%231%27,t:%270%27)),k:37.650561503718635,l:%274%27,n:%270%27,o:%27%27,s:0,t:%270%27),(g:!((h:compiler,i:(compiler:carm64g1520,filters:(b:%270%27,binary:%271%27,binaryObject:%271%27,commentOnly:%270%27,debugCalls:%271%27,demangle:%270%27,directives:%270%27,execute:%271%27,intel:%270%27,libraryCode:%270%27,trim:%271%27,verboseDemangling:%270%27),flagsViewOpen:%271%27,fontScale:14,fontUsePx:%270%27,j:1,lang:%5C___c,libs:!(),options:%27-Os+-fomit-frame-pointer%27,overrides:!(),selection:(endColumn:1,endLineNumber:5,positionColumn:1,positionLineNumber:5,selectionStartColumn:1,selectionStartLineNumber:4,startColumn:1,startLineNumber:4),source:1),l:%275%27,n:%270%27,o:%27+ARM64+GCC+15.2.0+(Editor+%231)%27,t:%270%27)),k:29.01610516294805,l:%274%27,m:100,n:%270%27,o:%27%27,s:0,t:%270%27),(g:!((h:compiler,i:(compiler:armv8-cclang2110,filters:(b:%270%27,binary:%271%27,binaryObject:%271%27,commentOnly:%270%27,debugCalls:%271%27,demangle:%270%27,directives:%270%27,execute:%271%27,intel:%270%27,libraryCode:%270%27,trim:%271%27,verboseDemangling:%270%27),flagsViewOpen:%271%27,fontScale:14,fontUsePx:%270%27,j:2,lang:%5C___c,libs:!(),options:%27-Os%27,overrides:!(),selection:(endColumn:1,endLineNumber:1,positionColumn:1,positionLineNumber:1,selectionStartColumn:1,selectionStartLineNumber:1,startColumn:1,startLineNumber:1),source:1),l:%275%27,n:%270%27,o:%27+armv8-a+clang+21.1.0+(Editor+%231)%27,t:%270%27)),k:33.33333333333333,l:%274%27,n:%270%27,o:%27%27,s:0,t:%270%27)),l:%272%27,n:%270%27,o:%27%27,t:%270%27)),version:4\" rel=\"nofollow noreferrer\">https://godbolt.org/#g:!((g:!((g:!((h:codeEditor,i:(filename:'1',fontScale:14,fontUsePx:'0',j:1,lang:\\___c,selection:(endColumn:1,endLineNumber:10,positionColumn:1,positionLineNumber:10,selectionStartColumn:1,selectionStartLineNumber:10,startColumn:1,startLineNumber:10),source:'%23include%3Ctime.h%3E%0A%0Avoid+fun()+%7B%0A++asm(%22arg1:%22)%3B%0A++struct+timespec+const+a+%3D+%7B+.tv_sec+%3D+10,+.tv_nsec+%3D+0+%7D%3B%0A++asm(%22call_nanosleep:%22)%3B%0A++nanosleep(%26a,NULL)%3B%0A++asm(%22return:%22)%3B%0A%7D%0A'),l:'5',n:'0',o:'C+source+%231',t:'0')),k:37.650561503718635,l:'4',n:'0',o:'',s:0,t:'0'),(g:!((h:compiler,i:(compiler:carm64g1520,filters:(b:'0',binary:'1',binaryObject:'1',commentOnly:'0',debugCalls:'1',demangle:'0',directives:'0',execute:'1',intel:'0',libraryCode:'0',trim:'1',verboseDemangling:'0'),flagsViewOpen:'1',fontScale:14,fontUsePx:'0',j:1,lang:\\___c,libs:!(),options:'-Os+-fomit-frame-pointer',overrides:!(),selection:(endColumn:1,endLineNumber:5,positionColumn:1,positionLineNumber:5,selectionStartColumn:1,selectionStartLineNumber:4,startColumn:1,startLineNumber:4),source:1),l:'5',n:'0',o:'+ARM64+GCC+15.2.0+(Editor+%231)',t:'0')),k:29.01610516294805,l:'4',m:100,n:'0',o:'',s:0,t:'0'),(g:!((h:compiler,i:(compiler:armv8-cclang2110,filters:(b:'0',binary:'1',binaryObject:'1',commentOnly:'0',debugCalls:'1',demangle:'0',directives:'0',execute:'1',intel:'0',libraryCode:'0',trim:'1',verboseDemangling:'0'),flagsViewOpen:'1',fontScale:14,fontUsePx:'0',j:2,lang:\\___c,libs:!(),options:'-Os',overrides:!(),selection:(endColumn:1,endLineNumber:1,positionColumn:1,positionLineNumber:1,selectionStartColumn:1,selectionStartLineNumber:1,startColumn:1,startLineNumber:1),source:1),l:'5',n:'0',o:'+armv8-a+clang+21.1.0+(Editor+%231)',t:'0')),k:33.33333333333333,l:'4',n:'0',o:'',s:0,t:'0')),l:'2',n:'0',o:'',t:'0')),version:4</a></p>\n", "tags": ["c", "assembly", "arm64", "gnu-assembler", "tcc"]}
{"id": "c5af2be9-6816-4e54-bd81-99f77f3741b5", "text": "Q: Procedure to show percentage of nulls in TERADATA SQL ASSISTANT A: <p>Another way to do this, faster :</p>\n<pre><code>CREATE OR ALTER PROCEDURE P_SQLPRO_GetNullPercentages \n   @TABLE NVARCHAR(257)\nAS\nBEGIN\n    SET NOCOUNT ON;\n    DECLARE @TABLE_SCHEMA NVARCHAR(200) = COALESCE(PARSENAME(@TABLE, 2), SCHEMA_NAME()),\n            @TABLE_NAME sysname = PARSENAME(@TABLE, 1), \n            @sql nvarchar(max);\n\n    SELECT @sql = 'SELECT ' \n                + STRING_AGG(CAST('100.0 * SUM(CASE WHEN ' + QUOTENAME(COLUMN_NAME) + ' IS NULL THEN 1 ELSE 0 END)\n                                  / CAST(COUNT(*) AS DECIMAL(30,3)) AS ''' + COLUMN_NAME + '''' AS nvarchar(max)), ', ')\n         + ' FROM ' + @TABLE_SCHEMA + '.' + @TABLE_NAME \n    FROM INFORMATION_SCHEMA.COLUMNS c\n    WHERE c.TABLE_SCHEMA = @TABLE_SCHEMA\n      AND c.TABLE_NAME   = @TABLE_NAME;\n\n    IF @sql IS NULL\n    BEGIN\n        THROW 50000, 'Table not found.', 1;\n        RETURN;\n    END;\n    \n    EXEC (@sql);\nEND\nGO\n</code></pre>\n", "tags": ["sql", "sql-server", "stored-procedures", "dynamic-sql", "teradata-sql-assistant"]}
{"id": "a36b0355-4d99-4aa6-93f5-416eb5570282", "text": "Q: &quot;#include&quot; a text file in a C program as a char[] A: <p>If you're willing to resort to some dirty tricks you can get creative with raw string literals and <code>#include</code> for certain types of files.</p>\n<p>For example, say I want to include some SQL scripts for SQLite in my project and I want to get syntax highlighting but don't want any special build infrastructure. I can have this file <code>test.sql</code> which is valid SQL for SQLite where <code>--</code> starts a comment:</p>\n<pre class=\"lang-sql prettyprint-override\"><code>--x, R&quot;(--\nSELECT * from TestTable\nWHERE field = 5\n--)&quot;\n</code></pre>\n<p>And then in my C++ code I can have:</p>\n<pre><code>int main()\n{\n    auto x = 0;\n    const char* mysql = (\n#include &quot;test.sql&quot;\n    );\n\n    cout &lt;&lt; mysql &lt;&lt; endl;\n}\n</code></pre>\n<p>The output is:</p>\n<pre><code>--\nSELECT * from TestTable\nWHERE field = 5\n--\n</code></pre>\n<p>Or to include some Python code from a file <code>test.py</code> which is a valid Python script (because <code>#</code> starts a comment in Python and <code>pass</code> is a no-op):</p>\n<pre class=\"lang-py prettyprint-override\"><code>#define pass R&quot;(\npass\ndef myfunc():\n    print(&quot;Some Python code&quot;)\n\nmyfunc()\n#undef pass\n#define pass )&quot;\npass\n</code></pre>\n<p>And then in the C++ code:</p>\n<pre><code>int main()\n{\n    const char* mypython = (\n#include &quot;test.py&quot;\n    );\n\n    cout &lt;&lt; mypython &lt;&lt; endl;\n}\n</code></pre>\n<p>Which will output:</p>\n<pre><code>pass\ndef myfunc():\n    print(&quot;Some Python code&quot;)\n\nmyfunc()\n#undef pass\n#define pass\n</code></pre>\n<p>It should be possible to play similar tricks for various other types of code you might want to include as a string. Whether or not it is a good idea I'm not sure. It's kind of a neat hack but probably not something you'd want in real production code. Might be ok for a weekend hack project though.</p>\n", "tags": ["c", "include", "c-preprocessor"]}
