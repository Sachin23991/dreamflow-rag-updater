{"id": "37ef0bad-fe6a-4912-964c-ae3932c907ba", "text": "Q: Should switches be manually optimized with lookup tables in C++? A: <p><sub>Disclaimer: I can not read assembly</sub></p>\n<p>Apparently all but a few compilers/settings optimize the switch-return combination to <em>jump</em> table which is not equivalent to a <em>lookup</em> table.</p>\n<p><a href=\"https://godbolt.org/#z:OYLghAFBqd5QCxAYwPYBMCmBRdBLAF1QCcAaPECAMzwBtMA7AQwFtMQByARg9KtQYEAysib0QXACx8BBAKoBnTAAUAHpwAMvAFYTStJg1DIApACYAQuYukl9ZATwDKjdAGFUtAK4sGIMwDspK4AMngMmAByPgBGmMQgAMwArKQADqgKhE4MHt6%2B/kEZWY4CYRHRLHEJKbaY9qUMQgRMxAR5Pn6BdQ05za0E5VGx8UmpCi1tHQXdEwNDldVjAJS2qF7EyOwc5onhyN5YANQmiW6txEwAnqfYJhoAgrv7h5gnZxPE4cC390%2BPaAYEyOE3QIBAn2%2BRxYXHeABETmYzAApQxeVo3JGnKwAgTA0HgyFGaFmeGIswAMUwMWI6OImLM2L%2BgPxBDBEIIX2JLESZPMZgAsq1kAh%2BUzcUCCCC2YTOVCWJI%2BUiHmkvrQxYkcQ8WVKCRyucBocklYLrhqtTrpeyiYaWAA2E3IrwRc3MvG6mX6%2BUBR1eWgM8Xa91W2UG6EADhNDy8wC8E1dEtZ1rl3IAnCahJg0gRMFV4gmg5KQ17uVwNCaAPIOVDVAuWvU26FcWGnBH8yKoABuudrWM1bqLDZTtq4pNb5LhmC2eeIBYHSfBFzNH09NtIR1HtyOtFQqAA1l40gAVJgxeiBv5Dg0AfU7eEwAHdt7uD2kBbIEBBwlK8MsTgEtSOI5iEwAgNgYZ990PE8z0wExkgsL9fkSOENHMO10LwU43FbZtlgAKiw5I4QvAISMeS9V2HW97yfBQH0IEV30ET9v2hD8AEkGCwVQ/xMAC/iAoD6MYhAjggFhOO4zBeP/QChKA0QlCODQQGA0DwKAmFAwUxSmGUrg1JAsDiAgkkdN0pS3jMIyNNM6FEgshSrKORJbJMiCFScoSXMkdzNJYZJvL05Tkn8%2Bz7WCo4XLtcLPICKKXICOKI0S/S3nDFKWFTNLlNTLKy1yt4ywKrgio3Qz1I8ptGX7R5dKOLAqCYP0CBAQSGqqgKyrqh4FP48injIv4OFWWhOGSXg/A4LRSFQTgcMsawQXWTY3l2HhSDambRtWPcQGSZIADo7WSMxU0SO0NDMMtEkkLhw30ThJCmzReHmjheAUEANC2t7VjgWAkDQFg0joeJyEoEGwfoBJgC4ZIuD4Ogc2Ib6IBiN7SBicIMU4TaceYekKxibQp22zaQbYQQKwYf0sawGIY3OWhaG%2B7heCwFhDGAcQdtIfAQIcPBu3Z2aZKnLwc3x3hv3qLHaDwGkMQ8LAsblFgZdIbtiBiTJMEnbmjEVox/r4AxgAUAA1WiKzSRgtf4QQRDEdgpBkQRFBUdR%2Bd0JGDFN0wlssfQle%2ByBVlQbMcnZgBaCtEnenWviwcOIFWOxyZyFxuOmPxR2CbiFhGBIC%2BKbIBDzvRy8aYuZxAaRM%2BFgR%2BimTxOgkMweizlvJkGcJhnrgu5jb/J89sPu66WSQM9WrYJDGibXv5j6jlUcM7Vju1FWAZBkA3Y7YQgXBCBIRFEi4ZZeG2rRlj2hvJCOu6Ag0O1ElTAJw1TU7wy78aOBeqQaas0PpfR%2Bn9Had8nocDMMvEBnBr7/VWDrLIzhJBAA%3D%3D%3D\" rel=\"nofollow noreferrer\">Godbolt</a></p>\n<pre class=\"lang-none prettyprint-override\"><code>lookupMonth(int):\n        xor     eax, eax\n        cmp     edi, 11\n        cmova   edi, eax\n        movsx   rdi, edi\n        sal     rdi, 5\n        mov     rax, QWORD PTR lookupTable[rdi+8]\n        mov     rdx, QWORD PTR lookupTable[rdi]\n        ret\nswitchMonth(int):\n        cmp     edi, 11\n        ja      .L21\n        mov     edi, edi\n        jmp     [QWORD PTR .L23[0+rdi*8]]\n.L23:\n        .quad   .L21\n...\n        .quad   .L22\n.L21:\n        mov     rdx, QWORD PTR m1[rip+8]\n        mov     rax, QWORD PTR m1[rip]\n.L35:\n        xchg    rdx, rax\n        ret\n.L22:\n        mov     rdx, QWORD PTR m12[rip+8]\n        mov     rax, QWORD PTR m12[rip]\n        jmp     .L35\n....\n.L25:\n        mov     rdx, QWORD PTR m10[rip+8]\n        mov     rax, QWORD PTR m10[rip]\n        jmp     .L35\n.L24:\n        mov     rdx, QWORD PTR m11[rip+8]\n        mov     rax, QWORD PTR m11[rip]\n        jmp     .L35\n</code></pre>\n<p>Jumps are probably the reason why performance is destroyed. The conclusion is, automatic <code>switch</code> optimization is circumstantial and is not always optimal. It should not be relied upon, leaving manual optimization still necessary in 2025.</p>\n", "tags": ["c++", "switch-statement", "lookup-tables", "microbenchmark"]}
{"id": "8e7a6bf3-07d9-4b55-9236-0beb6831ba13", "text": "Q: Improve quality in 3d plots with pgfplots package A: <p>You get this because when pgfplots encounters invalid values (<code>sqrt</code> of a negative number), it breaks the surface into disconnected triangular patches.</p>\n<p>One way to avoid that is to insert <code>unbounded coords=jump,</code>  (see p. 121 in the <a href=\"https://ctan.org/pkg/pgfplots\" rel=\"nofollow noreferrer\">manual</a>) or <code>restrict z to domain=0:1,</code> in the options of <code>addplot3</code>. The first options tells explicitly to pgfplots to discard unbounded values, but the second kind of mysteriously works too. Note that the first option does not restrict the upper z value. You obtain the following code and image with the first option:</p>\n<pre><code>\\documentclass{standalone}\n\\usepackage{pgfplots}\n\\pgfplotsset{compat=1.18}\n\n\\begin{document}\n\n\\begin{tikzpicture}\n\\begin{axis} [\n    view={20}{60},\n    xmin=-1, xmax=1,\n    ymin=-1, ymax=1,\n    zmin=0, zmax=1,\n    xlabel={$x$}, ylabel={$y$}, zlabel={$z$}\n    ]\n    \\addplot3 [\n    surf,\n    samples=100,\n    samples y=100,\n    domain=-1:1,\n    domain y=-1:1,\n    % unbounded coords=jump,    % option 1\n    restrict z to domain=0:1, % option 2\n    ] {sqrt(x^2+x^3-y^2)};\n\\end{axis}\n\\end{tikzpicture}\n\n\\end{document}\n</code></pre>\n<p><a href=\"https://i.sstatic.net/v8E2NKwo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/v8E2NKwo.png\" alt=\"enter image description here\" /></a></p>\n<p>The issue with this are the ugly edges, especially at the surface z=0.</p>\n<p>Another way to get what you want without this issue is to exploit the symmetry of the surface, and make a parametric plot (see p. 156 in the manual for a simple example). You want the surface defined in Cartesian coordinates by z^2 = x^3+x^2-y^2. This equation has cylindrical symmetry along x, so you can parametrize it as r^2 = x^2(x+1), y = r cos(a), z = r sin(a). In the code below, x -&gt; x, y -&gt; sqrt(x^2(x+1)) cos(y), z -&gt; sqrt(x^2(x+1)) sin(y).</p>\n<pre><code>\\documentclass{standalone}\n\\usepackage{pgfplots}\n\\pgfplotsset{compat=1.18}\n\n\\begin{document}\n\n\\begin{tikzpicture}\n\\begin{axis}\n    [\n    view={20}{60},\n    xmin=-1, xmax=1,\n    ymin=-1, ymax=1,\n    zmin=0, zmax=1,\n    restrict y to domain=-1:1,\n    restrict z to domain=0:1,\n    xlabel={$x$}, ylabel={$y$}, zlabel={$z$}\n    ]        \n    \\addplot3[surf,\n    domain=-1:1,\n    domain y=-1:1,\n    samples=50,\n    samples y=50,\n    y domain=0:1*pi,\n    z buffer=sort  % orders the faces according to depth\n    ]\n    ({x},\n    {sqrt(x^2+x^3)*cos(deg(y))},\n    {sqrt(x^2+x^3)*sin(deg(y))}\n    );\n\\end{axis}\n\\end{tikzpicture}\n\n\\end{document}\n</code></pre>\n<p><a href=\"https://i.sstatic.net/K3LMUyGy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/K3LMUyGy.png\" alt=\"enter image description here\" /></a>This can still be improved by clipping instead of restricting the values of y and z in the axis options. A clip is determined by a 3d closed path <code>\\clip (x1, y1, z1) -- (x2, y2, z2) -- ... -- (xn, yn, zn) -- cycle;</code>  that is projected into the 2d view plane. The output for a given path is thus view dependent. By default, the box clips the view along the path that is defined by the projection of the box, so something like <code>\\clip (-1,-1,0) -- (1,-1,0) -- (1,1,0) -- (1,1,1) -- (-1,1,1) -- (-1,-1,1) -- cycle;</code>.  See this <a href=\"https://tex.stackexchange.com/questions/534538/clip-path-in-3d-plot\">example</a> for instance. For the current plot and view, it is required to plot and clip twice due to the two sheets along y (below we drop the y, z restrictions):</p>\n<p><a href=\"https://i.sstatic.net/xV8fer8i.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/xV8fer8i.png\" alt=\"enter image description here\" /></a></p>\n<p>When the path is not straight, one can pass a parametric curve instead of a point in the clip path, e.g. <code>plot[variable=\\x, domain=0.755:1] (\\x, 1, {sqrt(\\x^2(\\x+1)-1)})</code>  which defines two endpoints that are connected to the others points. The clips are separated by putting them in a local <code>\\begin{scope} ... \\end{scope}</code> environment. For the current plot and view, it is required to fine tune the point of the green path where it diverges of the blue path (x=0.77) and not to plot the entire angle range (<code>y domain=0:0.39*pi,</code>) to avoid to plot the upper part of the surface. In the end, one gets the following image with the following code:</p>\n<pre><code>\\documentclass{standalone}\n\\usepackage{pgfplots}\n\\pgfplotsset{compat=1.18}\n\n\\begin{document}\n\n\\begin{tikzpicture}\n\\begin{axis}\n    [\n    view={20}{60},\n    xmin=-1, xmax=1,\n    ymin=-1, ymax=1,\n    zmin=0, zmax=1,\n    xlabel={$x$}, ylabel={$y$}, zlabel={$z$}\n    ]\n    \\begin{scope}  % blue clip before -&gt; below\n        \\clip (0.755,1,0) -- plot[variable=\\x, domain=0.755:1] (\\x, 1, {sqrt(\\x^2*(\\x+1)-1)}) -- (1,1,1) -- plot[variable=\\x, domain=1:0.755] (\\x, {sqrt(\\x^2*(\\x+1)-1)}, 1) -- plot[variable=\\x, domain=0.755:1] (\\x, {-sqrt(\\x^2*(\\x+1)-1)}, 1) -- cycle;\n        \\addplot3[surf,\n        domain=-1:1,\n        domain y=-1:1,\n        samples=50,\n        samples y=50,\n        y domain=0:0.39*pi,  % angle domain fine tuned to avoid the upper part of the surface\n        z buffer=sort\n        ]\n        ({x},\n        {sqrt(x^2+x^3)*cos(deg(y))},\n        {sqrt(x^2+x^3)*sin(deg(y))}\n        );\n    \\end{scope}\n    \\begin{scope}  % green clip after -&gt; above\n        \\clip (-1,-1,0) -- (0.755,-1,0) -- plot[variable=\\x, domain=0.755:1] (\\x, -1, {sqrt(\\x^2*(\\x+1)-1)}) -- plot[variable=\\x, domain=1:0.755] (\\x, {-sqrt(\\x^2*(\\x+1)-1)}, 1) -- plot[variable=\\x, domain=0.755:0.77] (\\x, {sqrt(\\x^2*(\\x+1)-1)}, 1) -- (-1,1,1) -- (-1,-1,1) -- cycle;\n        \\addplot3[surf,\n        domain=-1:1,\n        domain y=-1:1,\n        samples=50,\n        samples y=50,\n        y domain=0:1*pi,\n        z buffer=sort\n        ]\n        ({x},\n        {sqrt(x^2+x^3)*cos(deg(y))},\n        {sqrt(x^2+x^3)*sin(deg(y))}\n        );\n    \\end{scope}\n\\end{axis}\n\\end{tikzpicture}\n\n\\end{document}\n</code></pre>\n<p><a href=\"https://i.sstatic.net/7o8JG3re.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/7o8JG3re.png\" alt=\"enter image description here\" /></a></p>\n<p>Using <code>y domain=0:2*pi,</code> and clipping accordingly provides the second image of the OP.</p>\n", "tags": ["3d", "latex", "pgfplots"]}
{"id": "29b85a98-f6b3-4128-b040-7ef1c4f20657", "text": "Q: How to migrate a database programmatically? A: <p>This is not directly supported by Prisma. There is an open feature request that you could +1 <a href=\"https://github.com/prisma/prisma/issues/13549\" rel=\"nofollow noreferrer\">here</a>.</p>\n<p>Best workaround for now would be to writes scripts that use the CLI commands.</p>\n", "tags": ["prisma"]}
{"id": "c7cac11c-4282-4798-b23c-9f41c361d631", "text": "Q: TypeError: Cannot read property &#39;sessions&#39; of undefined A: <p>I am a bit unclear on your question.  There are some good answers up top.  </p>\n\n<p>In case you  are trying to avoid a \"property of undefined error\" you can do something like this:</p>\n\n<pre><code>authId = response?.body?.result?.sessions[0]?.authId;\n</code></pre>\n\n<p>it prevents the error. Ideally you would type-check all of them. </p>\n", "tags": ["javascript", "typescript", "jestjs", "testng", "supertest"]}
{"id": "6586e71b-1fa0-4eaf-98ac-effdf5456d61", "text": "Q: Flutter run returns: A problem occurred evaluating project &#39;:app&#39;.&quot; &quot;&gt;ASCII&quot; A: <p>sadly this can be a variety of things it seems.</p>\n\n<p>Try version bumping as the guys write above, however for me it was actually a need to add</p>\n\n<p>minifyEnabled true, specifically in app/build.gradle add</p>\n\n<pre><code>buildTypes {\n        debug {\n            signingConfig signingConfigs.debug\n        }\n        release {\n            signingConfig signingConfigs.release\n            **minifyEnabled true**\n            useProguard false\n            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'\n        }\n    }\n</code></pre>\n", "tags": ["firebase", "gradle", "flutter", "dart"]}
{"id": "0884d80e-e9d7-4f04-b3f3-5863c449f1cc", "text": "Q: Empty ActiveXObject(&quot;Microsoft.XMLDOM&quot;) in IE 11 A: <p>Found the answer <a href=\"https://stackoverflow.com/questions/10522236/javascript-on-ie9-xmldom-selectsinglenode-gives-unknown-method-concat\">here</a> appearently if I want to use <code>Microsoft.XMLDOM</code> I have to add <code>xmlDoc.setProperty(\"SelectionLanguage\", \"XPath\");</code>. The only thing I changed in my code was that I added teh new piece of code</p>\n\n<pre><code>try {\n            xmlDoc.setProperty(\"SelectionLanguage\", \"XPath\");\n            xmlNode = xmlDoc.selectNodes(\"//fields/data[contains(@options, 'formatcurrency')]\");                \n        }\n</code></pre>\n", "tags": ["javascript", "internet-explorer", "dom", "xml-parsing", "activex"]}
