{"id": "55b88d98-4fc2-49e9-8597-d00a078e4967", "text": "Q: How to get the names of my active monitors using Delphi VCL? A: <p>I finally found a solution that works for me. I've made a unit named <code>MonitorNames.pas</code> and this is the code:</p>\n<pre><code>unit MonitorNames;\n\ninterface\n\nuses\n  Winapi.Windows,\n  System.SysUtils;\n\nfunction GetMonitorNames: TArray&lt;string&gt;;\n\nimplementation\n\ntype\n  HDEVINFO = Pointer;\n\n  SP_DEVINFO_DATA = record\n    cbSize: DWORD;\n    ClassGuid: TGUID;\n    DevInst: DWORD;\n    Reserved: ULONG_PTR;\n  end;\n  PSP_DEVINFO_DATA = ^SP_DEVINFO_DATA;\n\nconst\n  DIGCF_PRESENT = $00000002;\n\n  // Device property codes\n  SPDRP_DEVICEDESC   = $00000000;\n  SPDRP_FRIENDLYNAME = $0000000C;\n\n  GUID_DEVCLASS_MONITOR: TGUID = '{4D36E96E-E325-11CE-BFC1-08002BE10318}';\n\nfunction SetupDiGetClassDevsW(\n  ClassGuid: PGUID;\n  Enumerator: PWideChar;\n  hwndParent: HWND;\n  Flags: DWORD\n): HDEVINFO; stdcall; external 'setupapi.dll' name 'SetupDiGetClassDevsW';\n\nfunction SetupDiEnumDeviceInfo(\n  DeviceInfoSet: HDEVINFO;\n  MemberIndex: DWORD;\n  var DeviceInfoData: SP_DEVINFO_DATA\n): BOOL; stdcall; external 'setupapi.dll' name 'SetupDiEnumDeviceInfo';\n\nfunction SetupDiGetDeviceRegistryPropertyW(\n  DeviceInfoSet: HDEVINFO;\n  const DeviceInfoData: SP_DEVINFO_DATA;\n  Property_: DWORD;\n  PropertyRegDataType: PDWORD;\n  PropertyBuffer: PByte;\n  PropertyBufferSize: DWORD;\n  RequiredSize: PDWORD\n): BOOL; stdcall; external 'setupapi.dll' name 'SetupDiGetDeviceRegistryPropertyW';\n\nfunction SetupDiDestroyDeviceInfoList(\n  DeviceInfoSet: HDEVINFO\n): BOOL; stdcall; external 'setupapi.dll' name 'SetupDiDestroyDeviceInfoList';\n\nfunction GetMonitorNames: TArray&lt;string&gt;;\nvar\n  DevInfo: HDEVINFO;\n  DevData: SP_DEVINFO_DATA;\n  Buf: array[0..1023] of WideChar;\n\n  function ReadProp(const Prop: DWORD): string;\n  begin\n    Result := '';\n    var RequiredSize: DWORD := 0;\n    var RegType: DWORD := 0;\n    ZeroMemory(@Buf, SizeOf(Buf));\n\n    if SetupDiGetDeviceRegistryPropertyW(\n         DevInfo,\n         DevData,\n         Prop,\n         @RegType,\n         PByte(@Buf[0]),\n         SizeOf(Buf),\n         @RequiredSize\n       ) then\n      Result := string(PWideChar(@Buf[0]));\n  end;\n\nbegin\n  Result := [];\n\n  DevInfo := SetupDiGetClassDevsW(@GUID_DEVCLASS_MONITOR, nil, 0, DIGCF_PRESENT);\n  if DevInfo = nil then\n    Exit;\n\n  try\n    var Index := 0;\n    ZeroMemory(@DevData, SizeOf(DevData));\n    DevData.cbSize := SizeOf(DevData);\n\n    while SetupDiEnumDeviceInfo(DevInfo, Index, DevData) do\n    begin\n      // Prefer FriendlyName if present, otherwise fall back to DeviceDesc\n      var S := ReadProp(SPDRP_FRIENDLYNAME);\n      if S = '' then\n        S := ReadProp(SPDRP_DEVICEDESC);\n\n      if S &lt;&gt; '' then\n        Result := Result + [S];\n\n      Inc(Index);\n      ZeroMemory(@DevData, SizeOf(DevData));\n      DevData.cbSize := SizeOf(DevData);\n    end;\n  finally\n    SetupDiDestroyDeviceInfoList(DevInfo);\n  end;\nend;\n\nend.\n</code></pre>\n<p>And then in my app, I can use it like this:</p>\n<pre><code>procedure TForm1.Button1Click(Sender: TObject);\nbegin\n  Memo1.Lines.Clear;\n  Memo1.Lines.Add('Detected monitors:');\n  Memo1.Lines.Add('-------------------');\n\n  for var Name in GetMonitorNames do\n    Memo1.Lines.Add(Name);\nend;\n</code></pre>\n<p>which returns:</p>\n<pre><code>Detected monitors:\n-------------------\nGeneric Monitor (VDD by MTT)\nGeneric Monitor (VDD by MTT)\nIntegrated Monitor\n</code></pre>\n<p>and that matches what I have in my Device Manager:</p>\n<p><a href=\"https://i.sstatic.net/A2lIPHJ8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/A2lIPHJ8.png\" alt=\"Device Manager\" /></a></p>\n<hr />\n<p>For now, this is the best solution I was able to find/write. It's actually the only solution so far that gives me some sort of friendly name for my monitors instead of just &quot;Generic PnP Monitor&quot;.</p>\n", "tags": ["delphi", "winapi", "vcl", "multiple-monitors", "delphi-13-florence"]}
{"id": "3e0e57de-e2d1-49e1-9fed-78cb696fd122", "text": "Q: Polars `concat_arr` no longer takes in `pl.col` as parameter? A: <p>That is a known bug and has been fixed on the main branch, but there hasn't been any releases since then. See <a href=\"https://github.com/pola-rs/polars/issues/23267\" rel=\"nofollow noreferrer\">https://github.com/pola-rs/polars/issues/23267</a></p>\n<p>You can use 1.30 until polars releases 1.32, or use <code>pl.concat_arr(pl.col('x'), pl.col('y'))</code> as a workaround if you want to use 1.31</p>\n", "tags": ["python", "python-polars"]}
{"id": "149a54c9-3e71-45c5-b6b0-664c5de5d658", "text": "Q: Failed devise login not showing error messages? A: <p>Well this is an example of what i have used in the past to render messages </p>\n\n<pre><code>&lt;% flash.each do |key, value| %&gt;\n  &lt;div class=\"alert alert-dismissible alert-&lt;%= key.to_s == 'notice' ? 'success' : 'danger' %&gt;\" role=\"alert\"&gt;\n   &lt;button type=\"button\" class=\"close\" data-dismiss=\"alert\"&gt;\n     &lt;span aria-hidden=\"true\"&gt;&amp;times;&lt;/span&gt;&lt;span class=\"sr-only\"&gt;Close&lt;/span&gt;&lt;/button&gt;\n       &lt;%= value if value.is_a?(String) %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>let me know if that works for you</p>\n", "tags": ["ruby-on-rails", "ruby-on-rails-3", "devise"]}
{"id": "f9211314-412f-4389-818d-efc121c2a0a5", "text": "Q: Highcharts Stock: Dynamically update Range Selector buttons based on available data A: <p>Thank you very much Andrzej. I got this working in everviz as well.</p>\n", "tags": ["highcharts"]}
{"id": "8ac36a43-4e12-4a40-af55-5ce17f13d2d9", "text": "Q: Jasper Reports - Issue on 3D chart A: <p>new an Object(red.style), when equals zero</p>\n", "tags": ["java", "jasper-reports", "jfreechart"]}
{"id": "fdc70018-e004-4a5c-a521-42d46df7f5df", "text": "Q: postgres query to get first row based on multiple copies of some columns A: <p>Another option is to enumerate each combination unique <code>A</code> and <code>B</code> and select rows where row number = 1.</p>\n<pre><code>SELECT a, b, c,\n  ROW_NUMBER() OVER (\n     PARTITION BY a, b\n     ORDER BY a, b\n     ) as rnum\nFROM test.mytable\n</code></pre>\n<div class=\"s-table-container\"><table class=\"s-table\">\n<thead>\n<tr>\n<th>a</th>\n<th>b</th>\n<th>c</th>\n<th>rnum</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>3</td>\n<td>5</td>\n<td>1</td>\n</tr>\n<tr>\n<td>1</td>\n<td>3</td>\n<td>7</td>\n<td>2</td>\n</tr>\n<tr>\n<td>1</td>\n<td>3</td>\n<td>9</td>\n<td>3</td>\n</tr>\n<tr>\n<td>2</td>\n<td>4</td>\n<td>3</td>\n<td>1</td>\n</tr>\n<tr>\n<td>2</td>\n<td>4</td>\n<td>6</td>\n<td>2</td>\n</tr>\n<tr>\n<td>2</td>\n<td>4</td>\n<td>1</td>\n<td>3</td>\n</tr>\n</tbody>\n</table></div>\n<pre><code>\nwith cte as (\n  SELECT a, b, c,\n    ROW_NUMBER() OVER (\n       PARTITION BY a, b\n       ORDER BY a, b\n         ) as rnum\nFROM test.mytable)\nSELECT a, b, c\nFROM cte\nWHERE rnum=1\n</code></pre>\n<div class=\"s-table-container\"><table class=\"s-table\">\n<thead>\n<tr>\n<th>a</th>\n<th>b</th>\n<th>c</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>3</td>\n<td>5</td>\n</tr>\n<tr>\n<td>2</td>\n<td>4</td>\n<td>3</td>\n</tr>\n</tbody>\n</table></div>\n", "tags": ["sql", "postgresql", "postgresql-9.1", "greatest-n-per-group"]}
