{"id": "855de4a1-7198-4382-bfd0-8e2d4a0b1292", "text": "Q: Regex - How do I check for digits 01 to 52 in filenames? A: <p>I can only suggest alternative approach with some &quot;shortcuts&quot;. Full pattern</p>\n<pre><code>ghf(?!00)(?:[0-4]\\d|5[0-2])\\d{3}\\w{2}_v\\d\\d\\.pdf\n</code></pre>\n<p>Explanations:</p>\n<ul>\n<li>first, i would write following pattern for week number as <code>(?:[0-4]\\d|5[0-2])</code>, which mean 0 through 4 with following any digits, which represents range 00-49 and remaining alternative <code>5[0-2]</code> which represents range 50-52,</li>\n<li>to disallow 00 we need to use just negative lookahead <code>(?!00)</code></li>\n<li>and generally i used <code>\\d</code> instead of <code>[0-9]</code> for conciseness</li>\n<li>also i used <code>\\w</code> which represents word character for issue part</li>\n</ul>\n<p><a href=\"https://regex101.com/r/vKXLly/1\" rel=\"nofollow noreferrer\">Regex demo</a></p>\n", "tags": ["python", "regex", "digits"]}
{"id": "20cf35ed-ac32-4485-a426-1403de7aab32", "text": "Q: Too many fonts when enumerating with EnumFontFamiliesEx function A: <p>I looked at <code>fms.dll</code> and <code>comdlg32.dll</code> to see how <code>ChooseFont</code> creates that list. Here's the code to list all font families. You need 3 functions from <code>fms.dll</code>.</p>\n<pre><code>// ordinal 14\ntypedef HRESULT(WINAPI* FmsInitializeEnumerator_t)(void** pEnum, char flags); \n\n// ordinal 9\ntypedef HRESULT(WINAPI* FmsGetFilteredPropertyList_t)(void* Enum, int type, unsigned int* count1, unsigned int* count2, wchar_t* data);\n\n// ordinal 4\ntypedef HRESULT(WINAPI* FmsFreeEnumerator_t)(void** pEnum);\n</code></pre>\n<p>use like this</p>\n<pre><code>HMODULE hFms = LoadLibrary(L&quot;fms.dll&quot;);\nFmsInitializeEnumerator = (FmsInitializeEnumerator_t)GetProcAddress(hFms, MAKEINTRESOURCEA(14));\nFmsGetFilteredPropertyList = (FmsGetFilteredPropertyList_t)GetProcAddress(hFms, MAKEINTRESOURCEA(9));\nFmsFreeEnumerator = (FmsFreeEnumerator_t)GetProcAddress(hFms, MAKEINTRESOURCEA(4));\n\n\nvoid* fontEnumerator = NULL;\nFmsInitializeEnumerator(&amp;fontEnumerator, 0);\n\nunsigned int count, count2;\nHRESULT hr = FmsGetFilteredPropertyList(fontEnumerator, 2, &amp;count, &amp;count2, NULL);\nif (SUCCEEDED(hr))\n{\n    int cchMax = count2 &gt;&gt; 1;\n\n    wchar_t* arra = (wchar_t*)malloc(sizeof(wchar_t) * cchMax);\n    FmsGetFilteredPropertyList(fontEnumerator, 2, &amp;count, &amp;count2, arra);\n\n    // the resulting string is like this\n    // System\\0Terminal\\0Fixedsys\\0...\n\n    // count contains number of fonts in the string array\n    const wchar_t* p = arra;\n    while (*p)\n    {\n        wprintf(L&quot;%s\\n&quot;, p);\n        p += lstrlen(p) + 1;\n    }\n\n    free(arra);\n}\nFmsFreeEnumerator(&amp;fontEnumerator);\n</code></pre>\n", "tags": ["c++", "c", "windows", "winapi", "fonts"]}
{"id": "ac03d9d4-7af2-435b-b30c-754d11a3bb26", "text": "Q: Non-recursive method of calculating future value of cashflows at irregular dates A: <p>Actually converting a range into an array makes YEARFRAC accept it. A <code>+</code> prior to the range converts it to an array (also with text): <code>=SUMPRODUCT( $B$2:B2 * (1 + 8%) ^ YEARFRAC(+$A$2:A2, A2) )</code></p>\n", "tags": ["excel", "finance"]}
{"id": "985de3df-8360-4fa0-b6c4-fbc49e5de19c", "text": "Q: Why would `git branch -d` result in &quot;error: could not delete references: multiple updates not allowed&quot;? A: <p><code>!: alias </code>runs everything in one Git process, and Git batches ref updates,</p>\n<p>Even if the branch is already merged, git merge still opens a ref transaction, and then <code>git branch -d t </code>tries to update the same ref again in that same process...</p>\n<p>Git forbid multiple updates to the same ref in one transaction, so you get that error !</p>\n<p>It\u2019s not that the merge really changes the branch, it just touches the ref system.</p>\n<p>To fix this :</p>\n<blockquote>\n<p>don\u2019t do two merges, and don\u2019t delete the branch in the same Git invocation. Either remove the first git merge, or split the delete so it runs as a separate command/process. Annoying, but expected once you know how aliases work !</p>\n</blockquote>\n", "tags": ["git"]}
{"id": "8c0b2f57-c6b6-4b05-ad09-c619c3229874", "text": "Q: ImageMagick creating blank transparent square(s) according to width A: <p>Why do you not use extent with a transparent background to increase the canvas size?</p>\n<p>I do not know c# but in command line it would be in this format:</p>\n<pre class=\"lang-bash prettyprint-override\"><code>convert ZME5U.jpg -background transparent -gravity west -extent 800x284 result.png\n</code></pre>\n<p><a href=\"https://i.sstatic.net/1RzbV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/1RzbV.png\" alt=\"Extended canvas\" /></a></p>\n", "tags": ["c#", "imagemagick", "imagick", "imagemagick-convert"]}
{"id": "b6ea07c3-bd99-493f-a8f0-3c6c930083be", "text": "Q: How to remove &#39;-&#39; but ignore &quot;--&gt;&#39; using regex A: <p>Only match <code>-</code> at the beginning of the lines, using the <code>^</code> anchor and the <code>re.MULTILINE</code> flag so it matches the beginning of lines rather than the whole string.</p>\n<pre><code>newdata = re.sub('^-', '', data, flags=re.MULTILINE)\n</code></pre>\n", "tags": ["python", "regex"]}
