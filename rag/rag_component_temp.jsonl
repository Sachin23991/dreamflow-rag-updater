{"id": "92d0666c-dc1e-4688-87da-d93184e681d1", "text": "Q: Can&#39;t access &lt;tr&gt; in &lt;table&gt; with VBA A: <p>Question is &quot;What's wrong with the code?&quot;.<br />\nNothing is wrong. However, with this query, you will only get a table with headers, without content.</p>\n<pre class=\"lang-html prettyprint-override\"><code>&lt;table class=&quot;pubtables&quot; data-sticky-columns=&quot;1&quot; data-sticky-rows=&quot;1&quot; id=&quot;1b08c9f7&quot; title=&quot;FOMC's target federal funds rate or range, change (basis points) and level&quot;&gt;\n    &lt;thead&gt;\n        &lt;tr&gt;\n            &lt;th class=&quot;colhead&quot; id=&quot;9083d749&quot;&gt;Effective Date&lt;/th&gt;\n            &lt;th class=&quot;colhead&quot; id=&quot;56c3135f&quot;&gt;Federal Funds - Level % (Low)&lt;/th&gt;\n            &lt;th class=&quot;colhead&quot; id=&quot;6bf6cd3d&quot;&gt;Federal Funds - Level % (High)&lt;/th&gt;\n        &lt;/tr&gt;\n    &lt;/thead&gt;\n    &lt;tbody id=&quot;fedexplained-accessible-table-body&quot;&gt;\n    &lt;/tbody&gt;\n&lt;/table&gt;\n</code></pre>\n<p>Part <code>&lt;tbody id=&quot;fedexplained-accessible-table-body&quot;&gt;</code> will be fulfilled by JavaScript</p>\n<pre class=\"lang-js prettyprint-override\"><code>    $(document).ready(function () {\n        $.get('/aboutthefed/files/target-funds-2014-2024.csv', function (importedData) {\n            let dates = [];\n            let lowRates = [];\n            let highRates = [];\n...\n</code></pre>\n<p>The HTTP request does not execute this part of the script. Therefore, the table will remain empty.</p>\n<p>How to enable the execution of scripts on the page is a separate issue.<br />\nI suggest we consider a more direct solution.\nTarget .CSV file have 3 rows</p>\n<ul>\n<li>dates</li>\n<li>low rates</li>\n<li>high rates</li>\n</ul>\n<p>like</p>\n<pre><code>2014-03-20T00:00:00.000Z,2014-05-01T00:00:00.000Z ... 11/8/2024,12/19/2024,1/30/2025,3/20/2025,5/8/2025,6/20/2025,7/31/2025,9/18/2025,10/30/2025,12/11/2025\n0,0 ... 4.5,4.25,4.25,4.25,4.25,4.25,4.25,4,3.75,3.5\n0.25,0.25 ...4.75,4.5,4.5,4.5,4.5,4.5,4.5,4.25,4,3.75\n</code></pre>\n<p>Try example</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Public Function GetFEDRates() As String\nDim objHTTP As Object\nDim URL As String\nDim result As String\nDim rows() As String\nDim dates() As String\nDim lowRates() As String\nDim highRates() As String\nDim tDate As Date, tLow As Double, tHigh As Double\nDim i As Integer\nDim decDelimiter As String\n      ' request data - .CSV file\n    URL = &quot;https://www.federalreserve.gov/aboutthefed/files/target-funds-2014-2024.csv&quot;\n    Set objHTTP = CreateObject(&quot;Msxml2.XMLHTTP.6.0&quot;)\n    objHTTP.Open &quot;GET&quot;, URL, False  ' async=false\n    Call objHTTP.Send\n    result = objHTTP.responseText\n    Debug.Print &quot;Result:&quot;, result\n      ' take 3 rows\n    rows = Split(result, vbLf)\n      ' split rows to array of dates and rates\n    dates = Split(rows(0), &quot;,&quot;)\n    lowRates = Split(rows(1), &quot;,&quot;)\n    highRates = Split(rows(2), &quot;,&quot;)\n    decDelimiter = Mid(CStr(1.1), 2) ' only for locale delitimers like 1.2 or 1,2\n    For i = LBound(dates) To UBound(dates)\n        tDate = CDate(Left(dates(i), 10))\n        tLow = CDbl(Replace(lowRates(i), &quot;.&quot;, decDelimiter))\n        tHigh = CDbl(Replace(highRates(i), &quot;.&quot;, decDelimiter))\n        Debug.Print &quot;Date=&quot;, tDate, &quot;Low=&quot;, tLow, &quot;High=&quot;, tHigh\n    Next i\n    GetFEDRates=&quot;ok&quot;\n    Set objHTTP = Nothing\nEnd Function```\n</code></pre>\n", "tags": ["excel", "vba", "web-scraping"]}
{"id": "dd9e29dc-56f9-40bc-bd14-426abb1157f8", "text": "Q: Get index of current element in C++ range-based for-loop A: <p>In C++23 there is now &quot;enumerate&quot; possible.<br />\nThis is already mentioned, but with the statement &quot;to come in C++26&quot;, which seems outdated.<br />\n<a href=\"https://en.cppreference.com/w/cpp/ranges/enumerate_view.html\" rel=\"nofollow noreferrer\">https://en.cppreference.com/w/cpp/ranges/enumerate_view.html</a></p>\n<p>e.g. (from the linked page):</p>\n<pre><code>int main()\n{\n    constexpr static auto v = {'A', 'B', 'C', 'D'};\n \n    for (auto const [index, letter] : std::views::enumerate(v))\n        std::cout &lt;&lt; '(' &lt;&lt; index &lt;&lt; ':' &lt;&lt; letter &lt;&lt; &quot;) &quot;;\n    std::cout &lt;&lt; '\\n';\n}\n</code></pre>\n<p>This is basically the exact same construct Python provides.<br />\nSo no more need to break your head with an &quot;own&quot; solution.</p>\n", "tags": ["c++", "for-loop", "c++11", "iteration"]}
{"id": "a2b60bfb-5fd5-413e-82f1-292d7e216c59", "text": "Q: How to change the text of input with Jquery with 3.1.1.? A: <p>That's not the text of input, but of <code>label</code> element. You could loop through each of the label with class <code>radio-inline</code> and update the <code>textContent</code>, like:</p>\n<pre><code>$('label[class=&quot;radio-inline&quot;]').each(function() {\n    var el = $(this).contents().last()[0],\n    textContent = el.textContent;\n    \n    if(textContent === 'Yes') {\n        el.textContent = 'Up';\n    }\n    else if(textContent === 'No') {\n        el.textContent = 'Down';\n    }\n});\n</code></pre>\n", "tags": ["jquery"]}
{"id": "694ef020-feff-4cf6-9724-4a997f89d00e", "text": "Q: How can I open a window&#39;s system menu by code? A: <p>When I want a window with no border or titlebar to be movable (usually for small topmost diagnostics, to minimize waste of screen space, and avoid cluttering the task bar), I use the styles WS_POPUP|WS_SYSMENU, so the key sequence Alt+Space can get at the menu manually (or by using keybd_event).</p>\n<p>To open it by coded means, sending WM_SYSCOMMAND with NC_SIZE (for example) can directly start an action provided by that menu with some added code to jump to the size grip, either by SetCursorPos and a simulated left downclick, or by keybd_event with VK_DOWN, then VK_RIGHT. I found it more reliable to use the SetCursorPos-and-downclick method, but you'd need code to find the window rect, etc....</p>\n<p>That's just one example, but the idea is to interact with the existing means, because those are based on user expectations, so Microsoft are less likely to thwart efforts to use them in future systems.</p>\n", "tags": ["winforms", "winapi"]}
{"id": "1fd077c7-2b21-4421-a7b2-4ba99940eeca", "text": "Q: How to draw a border on top of another application&#39;s window? A: <p>This will draw an outline on a panel that can be placed over another window. It avoids using WS_EX_LAYERED because that style causes problems; instead, it uses a hollow region to allow full access to the window below. This is tested and works identically on W98 and Windows 7, so it probably works on Windows 10 (but is not tested there).</p>\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;windows.h&gt;\n\nHWND H_panel; LRESULT CALLBACK PanelPrc(); void EdgeDraw();\nint WINAPI WinMain(HINSTANCE H_inst,HINSTANCE hPrevInstance,LPSTR lpCmdLine,int nCmdShow){\n  DWORD N=sizeof(WNDCLASSEX); WNDCLASSEX P; memset(&amp;P,0,N);\n  P.lpszClassName=&quot;PANEL&quot;; P.lpfnWndProc=PanelPrc; P.hInstance=H_inst;\n  P.hCursor=LoadCursor(NULL,IDC_ARROW); P.cbSize=N;\n  P.hbrBackground=GetStockObject(NULL_BRUSH);\n  if(!RegisterClassEx(&amp;P)){return 0;}\n\n  RECT R; GetWindowRect(GetDesktopWindow(),&amp;R); N=WS_EX_TOOLWINDOW|WS_EX_TOPMOST;\n  H_panel=CreateWindowEx(N,P.lpszClassName,&quot;&quot;,WS_POPUP,0,0,0,0,NULL,NULL,H_inst,NULL);\n\n  HRGN O=CreateRectRgnIndirect(&amp;R),I=CreateRectRgn(R.left+2,R.top+2,R.right-2,R.bottom-2);\n  CombineRgn(O,O,I,RGN_DIFF); SetWindowRgn(H_panel,O,1);\n\n  ShowWindow(H_panel,SW_SHOWNOACTIVATE);\n\n\n  MSG M; while(GetMessage(&amp;M,NULL,0,0)&gt;0){TranslateMessage(&amp;M); DispatchMessage(&amp;M);}\n  return M.wParam;\n}\n\nLRESULT CALLBACK PanelPrc(HWND hwnd,UINT msg,WPARAM wParam,LPARAM lParam){\n  switch(msg){\n    case WM_PAINT:{EdgeDraw(H_panel); return 0;} break;\n    case WM_DESTROY:{PostQuitMessage(0);} break;\n    default: return DefWindowProc(hwnd,msg,wParam,lParam);\n  }\n  return 0;\n}\n\nvoid EdgeDraw(HWND H){\n  RECT R; HPEN P=CreatePen(0,2,0xFF00FF); int X,Y,N,O=0;\n  HDC D=GetWindowDC(H); P=SelectObject(D,P);\n  GetWindowRect(H,&amp;R); X=R.right-R.left,Y=R.bottom-R.top;\n  int C[4][2]={{O+1,O+1},{O+1,O+Y-1},{O+X-1,O+Y-1},{O+X-1,O+1}};\n  MoveToEx(D,O+1,O+1,NULL); N=4; while(N--){LineTo(D,C[N][0],C[N][1]);}\n  P=SelectObject(D,P); DeleteObject(P); ReleaseDC(H,D);\n}\n</code></pre>\n<p>This example is complete because it's important to do things in the right order, and in a fully established context, if you want the result to be flicker-free at all times.</p>\n<p>There is a compromise: The region must be set to allow some area(s) to allow through-clicks, or to be drawn on. It can't do both. This is a limitation of the basic API functions used, being chosen for widest compatibility. If someone knows a way to improve on this without sacrificing that, go for it...</p>\n<p>Reasons to avoid WS_EX_LAYERED:</p>\n<p>It's not part of the original API, so could never be consistent across all Windows variants. It forces the task bar/switcher windows to have entries for the hidden window, and prevents it from showing normally in Windows 7 (though it will still appear in W98, and even there, the task entries exist when not wanted if WS_EX_LAYERED is set). Also, in Windows 7, if the drawn outline intercepts the taskbar, unrest results. It's ugly. Avoiding WS_EX_LAYERED is far easier than trying to manage its consequences.</p>\n", "tags": ["c++", "winapi", "gdi"]}
{"id": "47299d10-dba4-4327-be71-8c67e0222675", "text": "Q: Sobel filter kernel of large size A: <h1>Sobel Kernel of any size using Gaussian (EXP functions)</h1>\n<p><a href=\"https://www.desmos.com/3d/frcffy13pl\" rel=\"nofollow noreferrer\">https://www.desmos.com/3d/frcffy13pl</a></p>\n<p>A bit old topic... Anyway:</p>\n<p>I invented this method, namely the use of Gaussians.</p>\n<p>In my example, the kernel ranges from -1 to 1, but it can be interpolated with any (large) Radius. (Better for Radii\u200b\u200b&gt;=4)</p>\n<p>For example, if I want a Radius of 5,</p>\n<p>The value of X for the pixel position</p>\n<p>1 will be scaled and will correspond to the value 1/5 (which ranges from -1 to 1) of the formula given below.</p>\n<p>2 will be 2/5</p>\n<p>3 will be 3/5</p>\n<p>4 will be 4/5</p>\n<p>5 will be 5/5</p>\n<p>The main formula is the first one in this graph.</p>\n<p><a href=\"https://www.desmos.com/3d/frcffy13pl\" rel=\"nofollow noreferrer\">https://www.desmos.com/3d/frcffy13pl</a></p>\n<p>The beauty is that it is also separable as follows:</p>\n<pre><code>kX = 2 * A * EXP( -(A*X)^2 ) * X\n\nkY = EXP ( -(A*Y)^2 )\n</code></pre>\n<p>A = in simple terms represents how narrow or wide the curve shapes are.<br />\n(to me about 2.7 is a good value)</p>\n<p>So you can create two 1-dimensional (1D) kernels.</p>\n<p>And perform the convolution with separability:</p>\n<p>Convolve using the first kernel (KX) in the X direction</p>\n<p>and</p>\n<p>then convolve using the second kernel (KY) in the Y direction using the results of the first convolution as input.</p>\n<p>At this point, we obtain the Delta X of the image.</p>\n<p>To obtain the Delta Y:</p>\n<p>Convolve using the first kernel (KX) in the Y direction (this time)</p>\n<p>and</p>\n<p>then convolve using the second kernel (KY) in the X direction (this time), using the results of the first convolution as input.</p>\n<p>An important thing to add:</p>\n<p>The 1D kernels must be normalized (i.e., the sum of all values \u200b\u200bmust be 1).</p>\n<p>For the KY kernel, (that is nothing but a gaussian) simply add all the values.</p>\n<p>Then, once the sum is obtained, divide all the values \u200b\u200bby this sum. (Now the sum of all values \u200b\u200bequals 1.)</p>\n<p>For the KX kernel in the X direction (whose values \u200b\u200bon the left side of x (x&lt;0) are negative), I will only use the positive values \u200b\u200bon the right for normalization.</p>\n<p>So, I will perform the same procedure, but I will calculate the sum using only the positive values \u200b\u200b(on the right). [If I used all the values, the sum would be 0.]</p>\n<p>I hope this is useful to someone</p>\n", "tags": ["image-processing", "computer-vision", "edge-detection", "sobel"]}
{"id": "b156b5f5-f024-4bd8-be31-c1692415998d", "text": "Q: Insert Dynamic files in sourcecode that will update before every build A: <ul>\n<li>Right click the project or a folder in that project.</li>\n<li>Select <strong>Add &gt; Existing Item...</strong> from the context menu.</li>\n<li>Select a source file.</li>\n<li>Click the down-arrow on the <strong><kbd>\u00a0Add\u00a0\u00a0\u00a0\u00a0 | V</kbd></strong> button.</li>\n<li>Select: <strong>Add As Link</strong>.</li>\n</ul>\n<p>Another option is to create a class library project (*.dll) with these standard code items and to add it as a reference to other projects. This is what most developers do. It has the advantage, that it protects the library code from being inadvertently altered, and to cause problems in other projects.</p>\n", "tags": ["c#", "visual-studio", "tags", "visual-studio-2022"]}
