{"id": "b182d331-4f0b-4e10-bddf-4b5bc6f39f5d", "text": "Q: Does &quot;use client&quot; affects SEO in next js? (in this case?) A: <p>I don't see why it would. Those directives are for which system the code is building from (<code>client</code> or <code>server</code>).</p>\n", "tags": ["next.js", "seo"]}
{"id": "05d7a9a9-22e0-4e55-9ef0-101958c6a3d1", "text": "Q: How can i correctly change the LLAMA3 default maxtoken=256 in Blazor app on .NET 10.0? A: <p>I dont know why its been down-voted. But few of the important call outs like you should use the constructor overload that accepts <code>InferenceParams</code> and, ideally, set sensible stop sequences for your model. The default 256-token limit lives inside the chat service. If you don't inject your <code>InferenceParams</code>, your override is a no-op.</p>\n<pre><code>var modelParams = new ModelParams(modelPath)\n{\n    ContextSize = localConfig.GetValue&lt;uint&gt;(&quot;ContextSize&quot;, 4096),\n    GpuLayerCount = localConfig.GetValue&lt;int&gt;(&quot;GpuLayerCount&quot;, 0),\n};\n\nvar weights = LLamaWeights.LoadFromFile(modelParams);\nvar context = weights.CreateContext(modelParams);\n\nvar inferenceParams = new InferenceParams\n{\n    MaxTokens = localConfig.GetValue&lt;int&gt;(&quot;max_new_tokens&quot;, 1024), // your choice\n    Temperature = localConfig.GetValue&lt;float&gt;(&quot;Temperature&quot;, 0.2f),\n    // For Llama 3.x instruct models, this helps end the turn cleanly:\n    StopTokens = new[] { &quot;&lt;|eot_id|&gt;&quot; }  \n    // For Mistral Instruct, you can use &quot;###&quot; if you prompt with their template.\n};\n\nvar executor = new InteractiveExecutor(context);\nvar chatService = new LLamaSharpChatCompletion(executor, inferenceParams);\n\nbuilder.Services.AddSingleton&lt;IChatCompletionService&gt;(chatService);\n</code></pre>\n<p>Semantic Kernel has its own <code>MaxTokens</code>. If you dont pass it, some adapters cap this to <strong>256</strong> as well. It's best to use both inject <code>InferenceParams</code> and pass <code>ChatCompletionSettings</code> per call. The adapter maps SK settings to LLamaSharp where appropriate.</p>\n<pre><code>var settings = new ChatCompletionSettings\n{\n    MaxTokens = 1500, // applies to this call\n    Temperature = 0.2,\n};\n\nvar result = await chatService.GetChatMessageContentsAsync(chatHistory, settings, kernel);\n</code></pre>\n<p>If you use <code>InteractiveExecutor</code>, few of the defaults may stop generation early when the text looks like the start of a new user turn (like <code>&quot;User:&quot;</code>, <code>&quot;Human:&quot;</code>). If you see early stopping despite a higher token limit, clear or adjust anti-prompts:</p>\n<pre><code>var inferenceParams = new InferenceParams\n{\n    MaxTokens = 1500,\n    Temperature = 0.2f,\n    // Make sure anti-prompts dont end up the text prematurely.\n    AntiPrompts = Array.Empty&lt;string&gt;() // or set explicitly for your template\n};\n</code></pre>\n<p>Your <code>ConfigureLlm</code> (local provider) should be something like this:</p>\n<pre><code>case &quot;Local&quot;:\n    var localConfig = config.GetSection(&quot;AI:Local&quot;);\n    var modelPath = ResolveModelPath(localConfig[&quot;ModelPath&quot;]);\n\n    if (!string.IsNullOrEmpty(modelPath) &amp;&amp; File.Exists(modelPath))\n    {\n        logger.LogInformation(&quot;&gt;&gt; LOADING LOCAL GGUF MODEL: {Path}&quot;, modelPath);\n\n        try\n        {\n            var modelParams = new ModelParams(modelPath)\n            {\n                ContextSize = localConfig.GetValue&lt;uint&gt;(&quot;ContextSize&quot;, 8192),\n                GpuLayerCount = localConfig.GetValue&lt;int&gt;(&quot;GpuLayerCount&quot;, 0),\n            };\n\n            var weights = LLamaWeights.LoadFromFile(modelParams);\n            var context = weights.CreateContext(modelParams);\n\n            var inferenceParams = new InferenceParams\n            {\n                MaxTokens = localConfig.GetValue&lt;int&gt;(&quot;max_new_tokens&quot;, 1024),\n                Temperature = localConfig.GetValue&lt;float&gt;(&quot;Temperature&quot;, 0.2f),\n                StopTokens = new[] { &quot;&lt;|eot_id|&gt;&quot; }, \n                AntiPrompts = Array.Empty&lt;string&gt;(), \n            };\n\n            var executor = new InteractiveExecutor(context);\n            var chatService = new LLamaSharpChatCompletion(executor, inferenceParams);\n\n            builder.Services.AddSingleton&lt;IChatCompletionService&gt;(chatService);\n            logger.LogInformation(&quot;&gt;&gt; GGUF MODEL LOADED SUCCESSFULLY.&quot;);\n        }\n        catch (Exception ex)\n        {\n            logger.LogCritical(ex, &quot;FATAL ERROR INITIALIZING LLAMASHARP.&quot;);\n            throw;\n        }\n    }\n    else\n    {\n        logger.LogCritical(&quot;Local model file not found at path specified in AI:Local:ModelPath.&quot;);\n        throw new FileNotFoundException(&quot;Local GGUF model file not found.&quot;, localConfig[&quot;ModelPath&quot;]);\n    }\n    break;\n</code></pre>\n<p>To answer your question with respect to LLamaSharp limitations.</p>\n<p><strong>Not at all.</strong> LLamaSharp (and <code>llama.cpp</code>) can generate far more than 256 new tokens, provided:</p>\n<ul>\n<li>You pass the right MaxTokens to the executor/service</li>\n<li>Your context window can fit the prompt + output</li>\n<li>Your stop tokens don\u2019t end the turn early</li>\n<li>You don't hit SK's default caps for <code>MaxTokens</code></li>\n</ul>\n<p>Python is not going to work better in this scenario as it is just a different binding. So things will more or less be same only. Strictly my opinion. Others can chime in if needed. Hope it helps</p>\n", "tags": ["c#", "blazor", "artificial-intelligence", "llama", ".net-10.0"]}
{"id": "035c3750-7881-4d7d-a8d4-bddc61d67550", "text": "Q: Installing Python Dependencies locally in project A: <p>import tkinter as tk</p>\n<p>from tkinter import messagebox, scrolledtext</p>\n<p>import phonenumbers</p>\n<p>from phonenumbers import geocoder, carrier, timezone</p>\n<p>def lookup_phone():</p>\n<pre><code>number = entry.get().strip()\n\nif not number:\n\n    messagebox.showerror(&quot;Error&quot;, &quot;Please enter a phone number with country code (e.g., +91xxxxxxxxxx)&quot;)\n\n    return\n\n\n\ntry:\n\n    phoneNumber = phonenumbers.parse(number)\n\n    \n\n    \\# Clear previous results\n\n    result_text.delete(1.0, tk.END)\n\n    \n\n    \\# Get timezone\n\n    time_zones = timezone.time_zones_for_number(phoneNumber)\n\n    timezone_str = str(time_zones) if time_zones else &quot;Unknown&quot;\n\n    result_text.insert(tk.END, f&quot;\ud83c\udf10 Timezone: {timezone_str}\n</code></pre>\n<p>&quot;)</p>\n<pre><code>    \\# Get location\n\n    location = geocoder.description_for_number(phoneNumber, &quot;en&quot;)\n\n    result_text.insert(tk.END, f&quot;\ud83d\udccd Location: {location}\n</code></pre>\n<p>&quot;)</p>\n<pre><code>    \\# Get carrier\n\n    carrier_name = carrier.name_for_number(phoneNumber, &quot;en&quot;)\n\n    carrier_str = carrier_name if carrier_name else &quot;Unknown&quot;\n\n    result_text.insert(tk.END, f&quot;\ud83d\udcf1 Carrier: {carrier_str}\n</code></pre>\n<p>&quot;)</p>\n<pre><code>    \\# Validate number\n\n    is_valid = phonenumbers.is_valid_number(phoneNumber)\n\n    validity = &quot;\u2705 Valid&quot; if is_valid else &quot;\u274c Invalid&quot;\n\n    result_text.insert(tk.END, f&quot;\ud83d\udd0d Status: {validity}\n</code></pre>\n<p>&quot;)</p>\n<pre><code>    \\# Number type\n\n    num_type = phonenumbers.number_type(phoneNumber)\n\n    type_str = {\n\n        phonenumbers.PhoneNumberType.MOBILE: &quot;Mobile&quot;,\n\n        phonenumbers.PhoneNumberType.FIXED_LINE: &quot;Landline&quot;,\n\n        phonenumbers.PhoneNumberType.FIXED_LINE_OR_MOBILE: &quot;Mobile/Landline&quot;\n\n    }.get(num_type, &quot;Unknown&quot;)\n\n    result_text.insert(tk.END, f&quot;\ud83d\udcde Type: {type_str}\n</code></pre>\n<p>&quot;)</p>\n<pre><code>    result_text.insert(tk.END, &quot;\u2501&quot; \\* 50 + &quot;\n</code></pre>\n<p>&quot;)</p>\n<pre><code>except phonenumbers.NumberParseException as e:\n\n    messagebox.showerror(&quot;Error&quot;, f&quot;Invalid phone number: {str(e)}&quot;)\n\nexcept Exception as e:\n\n    messagebox.showerror(&quot;Error&quot;, f&quot;An error occurred: {str(e)}&quot;)\n</code></pre>\n<p>def clear_all():</p>\n<pre><code>entry.delete(0, tk.END)\n\nresult_text.delete(1.0, tk.END)\n\nentry.focus()\n</code></pre>\n<p># Create main window</p>\n<p>root = tk.Tk()</p>\n<p>root.title(&quot;\ud83d\udcf1 Phone Number Tracker App&quot;)</p>\n<p>root.geometry(&quot;550x450&quot;)</p>\n<p>root.resizable(True, True)</p>\n<p>root.configure(bg=&quot;#f0f2f5&quot;)</p>\n<p># Style configuration</p>\n<p>style = {</p>\n<pre><code>&quot;font_label&quot;: (&quot;Segoe UI&quot;, 11, &quot;bold&quot;),\n\n&quot;font_entry&quot;: (&quot;Segoe UI&quot;, 12),\n\n&quot;font_result&quot;: (&quot;Consolas&quot;, 11),\n\n&quot;bg_primary&quot;: &quot;#4CAF50&quot;,\n\n&quot;bg_secondary&quot;: &quot;#2196F3&quot;,\n\n&quot;bg_danger&quot;: &quot;#f44336&quot;\n</code></pre>\n<p>}</p>\n<p># Header</p>\n<p>header_frame = tk.Frame(root, bg=&quot;#4CAF50&quot;, pady=15)</p>\n<p>header_frame.pack(fill=tk.X)</p>\n<p>tk.Label(header_frame, text=&quot;\ud83d\udcf1 Phone Number Tracker&quot;, font=(&quot;Segoe UI&quot;, 18, &quot;bold&quot;),</p>\n<pre><code>     bg=&quot;#4CAF50&quot;, fg=&quot;white&quot;).pack()\n</code></pre>\n<p># Input frame</p>\n<p>input_frame = tk.Frame(root, padx=25, pady=20, bg=&quot;#f0f2f5&quot;)</p>\n<p>input_frame.pack(fill=tk.X)</p>\n<p>tk.Label(input_frame, text=&quot;Enter phone number with country code:&quot;,</p>\n<pre><code>     font=style\\[&quot;font_label&quot;\\], bg=&quot;#f0f2f5&quot;).pack(anchor=tk.W)\n</code></pre>\n<p>entry = tk.Entry(input_frame, font=style[&quot;font_entry&quot;], justify=tk.CENTER,</p>\n<pre><code>             relief=tk.FLAT, bd=2, bg=&quot;white&quot;)\n</code></pre>\n<p>entry.pack(fill=tk.X, pady=(8, 15))</p>\n<p>entry.insert(0, &quot;+91&quot;)  # India default</p>\n<p>entry.focus()</p>\n<p># Button frame</p>\n<p>button_frame = tk.Frame(root, bg=&quot;#f0f2f5&quot;)</p>\n<p>button_frame.pack(pady=10)</p>\n<p>lookup_btn = tk.Button(button_frame, text=&quot;\ud83d\udd0d LOOKUP NUMBER&quot;, command=lookup_phone,</p>\n<pre><code>                  bg=style\\[&quot;bg_primary&quot;\\], fg=&quot;white&quot;, font=(&quot;Segoe UI&quot;, 12, &quot;bold&quot;),\n\n                  padx=30, pady=12, relief=tk.FLAT, cursor=&quot;hand2&quot;)\n</code></pre>\n<p>lookup_btn.pack(side=tk.LEFT, padx=(0, 10))</p>\n<p>clear_btn = tk.Button(button_frame, text=&quot;\ud83d\uddd1\ufe0f CLEAR&quot;, command=clear_all,</p>\n<pre><code>                 bg=style\\[&quot;bg_danger&quot;\\], fg=&quot;white&quot;, font=(&quot;Segoe UI&quot;, 11, &quot;bold&quot;),\n\n                 padx=25, pady=12, relief=tk.FLAT, cursor=&quot;hand2&quot;)\n</code></pre>\n<p>clear_btn.pack(side=tk.LEFT)</p>\n<p># Results frame</p>\n<p>result_frame = tk.Frame(root, padx=25, pady=15, bg=&quot;#f0f2f5&quot;)</p>\n<p>result_frame.pack(fill=tk.BOTH, expand=True)</p>\n<p>tk.Label(result_frame, text=&quot;\ud83d\udcca Results:&quot;, font=style[&quot;font_label&quot;],</p>\n<pre><code>     bg=&quot;#f0f2f5&quot;).pack(anchor=tk.W)\n</code></pre>\n<p>result_text = scrolledtext.ScrolledText(result_frame, height=14, font=style[&quot;font_result&quot;],</p>\n<pre><code>                                   wrap=tk.WORD, state=tk.NORMAL, bg=&quot;white&quot;,\n\n                                   relief=tk.FLAT, bd=2)\n</code></pre>\n<p>result_text.pack(fill=tk.BOTH, expand=True)</p>\n<p># Footer</p>\n<p>footer = tk.Label(root, text=&quot;\u26a1 Requires internet for location/carrier lookup | Made with phonenumbers library [web:1][web:4]&quot;,</p>\n<pre><code>              font=(&quot;Segoe UI&quot;, 9), fg=&quot;#666&quot;, bg=&quot;#f0f2f5&quot;)\n</code></pre>\n<p>footer.pack(pady=10)</p>\n<p># Key bindings</p>\n<p>entry.bind('&lt;Return&gt;', lambda event: lookup_phone())</p>\n<p>root.bind('&lt;Escape&gt;', lambda event: clear_all())</p>\n<p># Center window</p>\n<p>root.update_idletasks()</p>\n<p>width = root.winfo_width()</p>\n<p>height = root.winfo_height()</p>\n<p>x = (root.winfo_screenwidimport tkinter as tk</p>\n<p>from tkinter import messagebox, scrolledtext</p>\n<p>import phonenumbers</p>\n<p>from phonenumbers import geocoder, carrier, timezone</p>\n<p>def lookup_phone():</p>\n<pre><code>number = entry.get().strip()\n\nif not number:\n\n    messagebox.showerror(&quot;Error&quot;, &quot;Please enter a phone number with country code (e.g., +91xxxxxxxxxx)&quot;)\n\n    return\n\n\n\ntry:\n\n    phoneNumber = phonenumbers.parse(number)\n\n    \n\n    \\# Clear previous results\n\n    result_text.delete(1.0, tk.END)\n\n    \n\n    \\# Get timezone\n\n    time_zones = timezone.time_zones_for_number(phoneNumber)\n\n    timezone_str = str(time_zones) if time_zones else &quot;Unknown&quot;\n\n    result_text.insert(tk.END, f&quot;\ud83c\udf10 Timezone: {timezone_str}\n</code></pre>\n<p>&quot;)</p>\n<pre><code>    \\# Get location\n\n    location = geocoder.description_for_number(phoneNumber, &quot;en&quot;)\n\n    result_text.insert(tk.END, f&quot;\ud83d\udccd Location: {location}\n</code></pre>\n<p>&quot;)</p>\n<pre><code>    \\# Get carrier\n\n    carrier_name = carrier.name_for_number(phoneNumber, &quot;en&quot;)\n\n    carrier_str = carrier_name if carrier_name else &quot;Unknown&quot;\n\n    result_text.insert(tk.END, f&quot;\ud83d\udcf1 Carrier: {carrier_str}\n</code></pre>\n<p>&quot;)</p>\n<pre><code>    \\# Validate number\n\n    is_valid = phonenumbers.is_valid_number(phoneNumber)\n\n    validity = &quot;\u2705 Valid&quot; if is_valid else &quot;\u274c Invalid&quot;\n\n    result_text.insert(tk.END, f&quot;\ud83d\udd0d Status: {validity}\n</code></pre>\n<p>&quot;)</p>\n<pre><code>    \\# Number type\n\n    num_type = phonenumbers.number_type(phoneNumber)\n\n    type_str = {\n\n        phonenumbers.PhoneNumberType.MOBILE: &quot;Mobile&quot;,\n\n        phonenumbers.PhoneNumberType.FIXED_LINE: &quot;Landline&quot;,\n\n        phonenumbers.PhoneNumberType.FIXED_LINE_OR_MOBILE: &quot;Mobile/Landline&quot;\n\n    }.get(num_type, &quot;Unknown&quot;)\n\n    result_text.insert(tk.END, f&quot;\ud83d\udcde Type: {type_str}\n</code></pre>\n<p>&quot;)</p>\n<pre><code>    result_text.insert(tk.END, &quot;\u2501&quot; \\* 50 + &quot;\n</code></pre>\n<p>&quot;)</p>\n<pre><code>except phonenumbers.NumberParseException as e:\n\n    messagebox.showerror(&quot;Error&quot;, f&quot;Invalid phone number: {str(e)}&quot;)\n\nexcept Exception as e:\n\n    messagebox.showerror(&quot;Error&quot;, f&quot;An error occurred: {str(e)}&quot;)\n</code></pre>\n<p>def clear_all():</p>\n<pre><code>entry.delete(0, tk.END)\n\nresult_text.delete(1.0, tk.END)\n\nentry.focus()\n</code></pre>\n<p># Create main window</p>\n<p>root = tk.Tk()</p>\n<p>root.title(&quot;\ud83d\udcf1 Phone Number Tracker App&quot;)</p>\n<p>root.geometry(&quot;550x450&quot;)</p>\n<p>root.resizable(True, True)</p>\n<p>root.configure(bg=&quot;#f0f2f5&quot;)</p>\n<p># Style configuration</p>\n<p>style = {</p>\n<pre><code>&quot;font_label&quot;: (&quot;Segoe UI&quot;, 11, &quot;bold&quot;),\n\n&quot;font_entry&quot;: (&quot;Segoe UI&quot;, 12),\n\n&quot;font_result&quot;: (&quot;Consolas&quot;, 11),\n\n&quot;bg_primary&quot;: &quot;#4CAF50&quot;,\n\n&quot;bg_secondary&quot;: &quot;#2196F3&quot;,\n\n&quot;bg_danger&quot;: &quot;#f44336&quot;\n</code></pre>\n<p>}</p>\n<p># Header</p>\n<p>header_frame = tk.Frame(root, bg=&quot;#4CAF50&quot;, pady=15)</p>\n<p>header_frame.pack(fill=tk.X)</p>\n<p>tk.Label(header_frame, text=&quot;\ud83d\udcf1 Phone Number Tracker&quot;, font=(&quot;Segoe UI&quot;, 18, &quot;bold&quot;),</p>\n<pre><code>     bg=&quot;#4CAF50&quot;, fg=&quot;white&quot;).pack()\n</code></pre>\n<p># Input frame</p>\n<p>input_frame = tk.Frame(root, padx=25, pady=20, bg=&quot;#f0f2f5&quot;)</p>\n<p>input_frame.pack(fill=tk.X)</p>\n<p>tk.Label(input_frame, text=&quot;Enter phone number with country code:&quot;,</p>\n<pre><code>     font=style\\[&quot;font_label&quot;\\], bg=&quot;#f0f2f5&quot;).pack(anchor=tk.W)\n</code></pre>\n<p>entry = tk.Entry(input_frame, font=style[&quot;font_entry&quot;], justify=tk.CENTER,</p>\n<pre><code>             relief=tk.FLAT, bd=2, bg=&quot;white&quot;)\n</code></pre>\n<p>entry.pack(fill=tk.X, pady=(8, 15))</p>\n<p>entry.insert(0, &quot;+91&quot;)  # India default</p>\n<p>entry.focus()</p>\n<p># Button frame</p>\n<p>button_frame = tk.Frame(root, bg=&quot;#f0f2f5&quot;)</p>\n<p>button_frame.pack(pady=10)</p>\n<p>lookup_btn = tk.Button(button_frame, text=&quot;\ud83d\udd0d LOOKUP NUMBER&quot;, command=lookup_phone,</p>\n<pre><code>                  bg=style\\[&quot;bg_primary&quot;\\], fg=&quot;white&quot;, font=(&quot;Segoe UI&quot;, 12, &quot;bold&quot;),\n\n                  padx=30, pady=12, relief=tk.FLAT, cursor=&quot;hand2&quot;)\n</code></pre>\n<p>lookup_btn.pack(side=tk.LEFT, padx=(0, 10))</p>\n<p>clear_btn = tk.Button(button_frame, text=&quot;\ud83d\uddd1\ufe0f CLEAR&quot;, command=clear_all,</p>\n<pre><code>                 bg=style\\[&quot;bg_danger&quot;\\], fg=&quot;white&quot;, font=(&quot;Segoe UI&quot;, 11, &quot;bold&quot;),\n\n                 padx=25, pady=12, relief=tk.FLAT, cursor=&quot;hand2&quot;)\n</code></pre>\n<p>clear_btn.pack(side=tk.LEFT)</p>\n<p># Results frame</p>\n<p>result_frame = tk.Frame(root, padx=25, pady=15, bg=&quot;#f0f2f5&quot;)</p>\n<p>result_frame.pack(fill=tk.BOTH, expand=True)</p>\n<p>tk.Label(result_frame, text=&quot;\ud83d\udcca Results:&quot;, font=style[&quot;font_label&quot;],</p>\n<pre><code>     bg=&quot;#f0f2f5&quot;).pack(anchor=tk.W)\n</code></pre>\n<p>result_text = scrolledtext.ScrolledText(result_frame, height=14, font=style[&quot;font_result&quot;],</p>\n<pre><code>                                   wrap=tk.WORD, state=tk.NORMAL, bg=&quot;white&quot;,\n\n                                   relief=tk.FLAT, bd=2)\n</code></pre>\n<p>result_text.pack(fill=tk.BOTH, expand=True)</p>\n<p># Footer</p>\n<p>footer = tk.Label(root, text=&quot;\u26a1 Requires internet for location/carrier lookup | Made with phonenumbers library [web:1][web:4]&quot;,</p>\n<pre><code>              font=(&quot;Segoe UI&quot;, 9), fg=&quot;#666&quot;, bg=&quot;#f0f2f5&quot;)\n</code></pre>\n<p>footer.pack(pady=10)</p>\n<p># Key bindings</p>\n<p>entry.bind('&lt;Return&gt;', lambda event: lookup_phone())</p>\n<p>root.bind('&lt;Escape&gt;', lambda event: clear_all())</p>\n<p># Center window</p>\n<p>root.update_idletasks()</p>\n<p>width = root.winfo_width()</p>\n<p>height = root.winfo_height()</p>\n<p>x = (root.winfo_screenwidth() // 2) - (width // 2)</p>\n<p>y = (root.winfo_screenheight() // 2) - (height // 2)</p>\n<p>root.geometry(f'{width}x{height}+{x}+{y}')</p>\n<p>root.mainloop()th() // 2) - (width // 2)</p>\n<p>y = (root.winfo_screenheight() // 2) - (height // 2)</p>\n<p>root.geometry(f'{width}x{height}+{x}+{y}')</p>\n<p>root.mainloop()</p>\n", "tags": ["python", "python-2.7", "pip", "requirements.txt"]}
{"id": "f9a50ae7-f026-4005-99a9-d79e08ba819a", "text": "Q: Svelte 5 reactive attachment A: <p>You can return a function inside the attachment that runs on state update.</p>\n<pre><code>const myAttachment: Attachment&lt;HTMLIFrameElement&gt; = (iframe) =&gt; {\n    \n    iframe.addEventListener('load', () =&gt; {\n      iframeBody.innerText = `The value from the reactive variable is ${counter}.`\n    })\n\n    return () =&gt; {\n      iframe.addEventListener('load', () =&gt; {\n        iframeBody.innerText = `The value from the reactive variable is ${counter}.`\n      })\n    }\n    \n}\n\n// The right way to mutate the iframe is to post a message to the iframe here and read it inside it.  https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage\n</code></pre>\n", "tags": ["svelte", "svelte-5"]}
{"id": "c72b9da5-57fd-463a-8a01-9c73125a8274", "text": "Q: git error - connection closed by host port 22 A: <p>In my case,  <code>git push</code> worked before. And I checked this thread: <a href=\"https://stackoverflow.com/questions/15589682/how-to-fix-ssh-connect-to-host-github-com-port-22-connection-timed-out-for-g?rq=4\">How to fix &quot;ssh: connect to host github.com port 22: Connection timed out&quot; for git push/pull/... commands</a></p>\n<p>But suddenly it occurred to me that maybe it's the VPN messing up the network. So I disconnected the VPN and  <code>git push</code> works! This may not count as a good answer, but anyway, I will post it here.</p>\n", "tags": ["git", "ssh", "repository", "bitbucket", "git-clone"]}
{"id": "1383de39-9660-45fc-ba9c-519e16a8a6c9", "text": "Q: Algorithm for deriving control points of a bezier curve from points along that curve? A: <p>Let's say you have a curve y = f(x)</p>\n\n<p>To define a bezier curve you need 4 points, like:\nP1x, P1y, P2x, P2y, P3x, P3y and P4x and P4y</p>\n\n<p>P1 and P4 you are the begin/end points of the curve. P2 and P3 are control points.\nYou already know where the beginning and end of the curve is. You have to calculate P2 and P3. The x coordinate P2x and P3x are easy, because you just pick them by selecting the curve's <code>t</code> to be eg 1/3 and 2/3. So you have P2x and P3x\nThen, you end up with a system of two equations and two unknowns (the P2y and P3y).\nAfter crunching some math you end up with something like this:</p>\n\n<p>(My f(x) was a cubic polynomial, which also guaranteed that I would be able to fit one cubic Bezier curve to it exactly.)</p>\n\n<pre><code>/**\n    @params {Object} firstPoint = {x:...,y...}\n    @params {Object} lastPoint = {x:...,y...}\n    @params {Object} cubicPoly Definition of a cubic polynomial in the form  y=ax^3+bx^2+c. \n  Has a method EvaluateAt, which calculates y for a particular x\n\n*/\nvar CalcBezierControlPoints = function(firstPoint, lastPoint, cubicPoly) {\n    var xDiff = lastPoint.X - firstPoint.X;\n    var x1 = firstPoint.X + xDiff / 3.0;\n    var x2 = firstPoint.X + 2.0 * xDiff / 3.0;\n\n    var y1 = cubicPoly.EvaluateAt(x1);\n    var y2 = cubicPoly.EvaluateAt(x2);\n\n    var f1 = 0.296296296296296296296; // (1-1/3)^3\n    var f2 = 0.037037037037037037037; // (1-2/3)^3\n    var f3 = 0.296296296296296296296; // (2/3)^3\n\n    var b1 = y1 - firstPoint.Y * f1 - lastPoint.Y / 27.0;\n    var b2 = y2 - firstPoint.Y * f2 - f3 * lastPoint.Y;\n\n    var c1 = (-2 * b1 + b2) / -0.666666666666666666;\n    var c2 = (b2 - 0.2222222222222 * c1) / 0.44444444444444444;\n\n    var p2 = {};\n    var p3 = {};\n    p2.X = x1;\n    p2.Y = c1;\n\n    p3.X = x2;\n    p3.Y = c2;\n\n    return ([p2, p3]);\n}\n</code></pre>\n", "tags": ["algorithm", "bezier"]}
{"id": "e53c2b63-8963-47b0-960e-da0d512ae269", "text": "Q: Kafka consumer is blocking event loop in FastAPI A: <p>Instead of awaiting <code>consume_messages()</code>, spawn it via <code>asyncio.create_task()</code> and store the task so you can cancel it on shutdown.</p>\n<p><em>Consumer Class - Updated:</em></p>\n<pre><code>import asyncio\nimport json\nimport logging\nfrom aiokafka import AIOKafkaConsumer\n\nlogger = logging.getLogger(__name__)\n\nclass KafkaConsumer:\n    def __init__(self, topic, bootstrap_servers, group_id):\n        self.topic = topic\n        self.bootstrap_servers = bootstrap_servers\n        self.group_id = group_id\n        self.consumer = None\n        self._consume_task = None\n\n    async def start(self):\n        &quot;&quot;&quot;Start the Kafka consumer and launch the consume loop in the background.&quot;&quot;&quot;\n        try:\n            self.consumer = AIOKafkaConsumer(\n                self.topic,\n                bootstrap_servers=self.bootstrap_servers,\n                group_id=self.group_id,\n                enable_auto_commit=True,  # adjust per your needs\n            )\n            await self.consumer.start()\n            logger.info(&quot;KafkaConsumer started for topic=%s group_id=%s&quot;, self.topic, self.group_id)\n            # Run the long-lived consume loop in the background and return immediately\n            self._consume_task = asyncio.create_task(self.consume_messages())\n        except Exception:\n            logger.exception(&quot;Failed to start KafkaConsumer&quot;)\n\n    async def stop(self):\n        &quot;&quot;&quot;Stop the consume loop and the consumer.&quot;&quot;&quot;\n        try:\n            if self._consume_task:\n                self._consume_task.cancel()\n                try:\n                    await self._consume_task\n                except asyncio.CancelledError:\n                    pass\n            if self.consumer:\n                await self.consumer.stop()\n            logger.info(&quot;KafkaConsumer stopped for topic=%s group_id=%s&quot;, self.topic, self.group_id)\n        except Exception:\n            logger.exception(&quot;Error during KafkaConsumer stop&quot;)\n\n    async def consume_messages(self):\n        &quot;&quot;&quot;Consume messages in a long-running loop.&quot;&quot;&quot;\n        try:\n            async for message in self.consumer:\n                try:\n                    data_str = message.value.decode(&quot;utf-8&quot;)\n                    data = json.loads(data_str)\n                    # TODO: handle data\n                except Exception:\n                    logger.exception(&quot;Failed to process message&quot;)\n        except asyncio.CancelledError:\n            # Task was cancelled during shutdown\n            logger.debug(&quot;consume_messages cancelled&quot;)\n        except Exception:\n            logger.exception(&quot;Error in consume_messages&quot;)\n</code></pre>\n<p>Same needs to be done for <code>sync</code> consumer. Even though you call it <code>SyncKafkaComsumer</code>, its still async (uses <code>AIOKafkaConsumer</code>). Mirror the same structure. You dont need to wait for the consume loop inside <code>start()</code>. Spawn a task and add a <code>stop()</code> method.</p>\n<pre><code>class SyncKafkaComsumer:\n    def __init__(self, topic, bootstrap_servers, group_id):\n        self.topic = topic\n        self.bootstrap_servers = bootstrap_servers\n        self.group_id = group_id\n        self.consumer = None\n        self._consume_task = None\n\n    async def start(self):\n        try:\n            self.consumer = AIOKafkaConsumer(\n                self.topic,\n                bootstrap_servers=self.bootstrap_servers,\n                group_id=self.group_id,\n            )\n            await self.consumer.start()\n            logger.info(&quot;SyncKafkaComsumer started&quot;)\n            self._consume_task = asyncio.create_task(self.consume_messages())\n        except Exception:\n            logger.exception(&quot;Failed to start SyncKafkaComsumer&quot;)\n\n    async def stop(self):\n        try:\n            if self._consume_task:\n                self._consume_task.cancel()\n                try:\n                    await self._consume_task\n                except asyncio.CancelledError:\n                    pass\n            if self.consumer:\n                await self.consumer.stop()\n            logger.info(&quot;SyncKafkaComsumer stopped&quot;)\n        except Exception:\n            logger.exception(&quot;Error stopping SyncKafkaComsumer&quot;)\n\n    async def consume_messages(self):\n        try:\n            async for message in self.consumer:\n                # process sync messages here\n                ...\n        except asyncio.CancelledError:\n            logger.debug(&quot;SyncKafkaComsumer consume cancelled&quot;)\n        except Exception:\n            logger.exception(&quot;Error in SyncKafkaComsumer.consume_messages&quot;)\n</code></pre>\n<p><em>Start both consumers concurrently and shut down properly.</em> If you want the app to start quickly, keep your <code>asyncio.create_task(start_kafka())</code>. Inside <code>start_kafka()</code>, <strong>await</strong> each <code>start()</code> because they now return quickly. On shutdown, call each <code>.stop()</code> to cancel tasks and stop the consumers.</p>\n<pre><code>from fastapi import FastAPI\nfrom contextlib import asynccontextmanager\nimport asyncio\n\n@asynccontextmanager\nasync def lifespan(app: FastAPI):\n    FastAPICache.init(InMemoryBackend())\n\n    async def start_kafka():\n        logger.info(&quot;Starting Kafka initialization...&quot;)\n        try:\n            app.producer = await startup_producer()\n\n            # Initialize instances and start (non-blocking now)\n            app.consumer = KafkaConsumer(\n                topic=&quot;topic1&quot;,\n                bootstrap_servers=&quot;localhost:9092&quot;,\n                group_id=&quot;group-async&quot;,\n            )\n            await app.consumer.start()\n\n            app.sync_consumer = SyncKafkaComsumer(\n                topic=&quot;topic2&quot;,\n                bootstrap_servers=&quot;localhost:9092&quot;,\n                group_id=&quot;group-sync&quot;,\n            )\n            await app.sync_consumer.start()\n\n            logger.info(&quot;Finished Kafka initialization&quot;)\n        except Exception:\n            logger.exception(&quot;Failed to start Kafka components&quot;)\n\n    # Start Kafka init without blocking app startup\n    kafka_task = asyncio.create_task(start_kafka())\n\n    yield\n\n    # Cleanup Kafka components if they were started\n    try:\n        if hasattr(app, &quot;consumer&quot;):\n            await app.consumer.stop()\n        if hasattr(app, &quot;sync_consumer&quot;):\n            await app.sync_consumer.stop()\n        if hasattr(app, &quot;producer&quot;):\n            await shutdown_producer()\n    except Exception:\n        logger.exception(&quot;Error during Kafka shutdown&quot;)\n``\n</code></pre>\n<p>Your consumers block because <code>start()</code> awaits a never-ending loop. Make <code>start()</code> return immediately and run the loop in a background task with <code>asyncio.create_task()</code>. Cancel that task on shutdown. If you can share a snippet of your <code>AIOKafkaConsumer</code> configs (topics/group IDs), we are in a better position to help ensure both consumers wont step on each other during rebalances and that they get exactly the messages you expect.</p>\n<p>Hope it gives you a clear direction now.</p>\n", "tags": ["fastapi", "aiokafka"]}
{"id": "f2eb0033-77be-4353-9b6a-eb4ba73c4d57", "text": "Q: Request http in flutter web A: <p>I'm almost sure that the problem is because your server doesn't have an https certificate.\nA workaround is run / debug your application with flutter desktop.</p>\n<p>You can also take a look at: <a href=\"https://stackoverflow.com/questions/65630743/how-to-solve-flutter-web-api-cors-error-only-with-dart-code/66879350#66879350\">How to solve flutter web api cors error only with dart code?</a></p>\n", "tags": ["flutter", "flutter-web"]}
