{"id": "62372651-1650-46d5-bf70-11b3cd810e08", "text": "Q: Reducing indentation of specific lines within 1 cell based on contents within line A: <p>This would work (preserving colored text) as long as:</p>\n<ul>\n<li>The string &quot;.....FM&quot; (5 spaces then &quot;FM&quot;, using periods here) doesn't occur elsewhere in the cell text where it needs to be preserved</li>\n<li>The string being replaced doesn't have mixed formatting (color/bold/italic etc)</li>\n</ul>\n<pre><code>Sub FixIndent()\n    Const FIND_WHAT As String = &quot;     FM&quot;\n    Const REPLACE_WITH As String = &quot;  FM&quot;\n    Dim txt, c As Range\n    \n    For Each c In ActiveSheet.Range(&quot;A:A&quot;).SpecialCells(xlCellTypeConstants).Cells\n        If InStr(1, c.Value, FIND_WHAT) &gt; 0 Then\n            txt = c.Value(11)\n            txt = Replace(txt, FIND_WHAT, REPLACE_WITH)\n            c.Value(11) = txt\n        End If\n    Next c\nEnd Sub\n</code></pre>\n<p>For info on <code>Value(11)</code> see:</p>\n<ul>\n<li><a href=\"https://learn.microsoft.com/en-us/office/vba/api/excel.xlrangevaluedatatype\" rel=\"nofollow noreferrer\">https://learn.microsoft.com/en-us/office/vba/api/excel.xlrangevaluedatatype</a></li>\n<li><a href=\"https://fastexcel.wordpress.com/2017/03/13/excel-range-valuevaluetype-what-is-this-parameter/\" rel=\"nofollow noreferrer\">https://fastexcel.wordpress.com/2017/03/13/excel-range-valuevaluetype-what-is-this-parameter/</a></li>\n</ul>\n<p>Here's part of the value (with some added line breaks):</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;Cell ss:StyleID=&quot;s63&quot;&gt;\n   &lt;ss:Data ss:Type=&quot;String&quot; xmlns=&quot;http://www.w3.org/TR/REC-html40&quot;&gt;\n      &lt;Font html:Color=&quot;#000000&quot;&gt;TAF AMD KMDW 290254Z &lt;/Font&gt;\n      &lt;Font html:Color=&quot;#FF0000&quot;&gt;2903/3006&lt;/Font&gt;\n      &lt;Font html:Color=&quot;#000000&quot;&gt; 18004KT P6SM SCT035 BKN150&amp;#10;     FM291000 16007KT 5SM -SN BKN035 OVC050&amp;#10;     FM291200 15011KT 1 1/2SM -SN BR SCT015 BKN025&amp;#10;     FM291500 14012G22KT 1SM -SN BR SCT006 OVC010&amp;#10;     FM291800 14015G25KT 1/2SM SN FZFG&lt;/Font&gt;\n      &lt;Font html:Color=&quot;#FF0000&quot;&gt; VV006&lt;/Font&gt;\n      &lt;Font html:Color=&quot;#000000&quot;&gt;&amp;#10;     FM300000 15014G24KT 1SM -SN BR SCT006 OVC010&amp;#10;     FM300300 17012G20KT 1SM -SN BR OVC006&amp;#10;      PROB30 3004/3006 3/4SM -SNDZ BR&lt;/Font&gt;\n      &lt;Font html:Color=&quot;#FF0000&quot;&gt; VV004&lt;/Font&gt;\n   &lt;/ss:Data&gt;\n&lt;/Cell&gt;\n</code></pre>\n<p>If the &quot;.....FM&quot; had mixed formatting then it would be split across multiple <code>&lt;Font&gt;</code> elements, and the Replace would fail.</p>\n", "tags": ["excel", "regex", "vba"]}
{"id": "9ae8cb63-83fb-46ec-8a4a-e369dcaa58c2", "text": "Q: Testing the transition from app clip to full app A: <p>// Source - <a href=\"https://stackoverflow.com/q/68834102\">Testing the transition from app clip to full app</a></p>\n<p>// Posted by Oded Rinsky, modified by community. See post 'Timeline' for change history</p>\n<p>// Retrieved 2025-12-18, License - CC BY-SA 4.0</p>\n<p>let username = &quot;Oded&quot;</p>\n<p>guard let sharedUserDefaults = UserDefaults(suiteName: &quot;group.fruitapp.appClipToFullApp&quot;) else {</p>\n<pre><code>        return true\n\n    }\n\n    \n\n    if sharedUserDefaults.string(forKey: &quot;username&quot;) == nil {\n\n        sharedUserDefaults.set(username, forKey: &quot;username&quot;)\n\n    }\n\n    \n\n\n\nreturn true\n</code></pre>\n", "tags": ["ios", "swift", "xcode", "app-store-connect", "apple-appclips"]}
{"id": "48113480-87f0-4a44-83ee-d4403b5ac5ee", "text": "Q: How can I skip authentication in a single test with a fixture in Fast API together with pytest? A: <p>My preferred solution uses a context manager to manage adding and removing the dependency override (<a href=\"https://fastapi.tiangolo.com/advanced/testing-dependencies/#use-the-app-dependency-overrides-attribute\" rel=\"nofollow noreferrer\">ref for dependency override</a>). It's similar to @Peter K's answer but doesn't require any third-party dependencies.</p>\n<p>If, like me, you want the default in your tests to be &quot;assume authenticated&quot; then you should override the auth dependency globally in your test file (or in <code>conftest.py</code> for multiple test files). The context manager would then un-override it for those methods where you're specifically testing the authentication. Of course, if you wanted to require authentication by default then you would remove the global override and switch the bodies of the <code>try</code> and <code>finally</code> blocks in (and probably the name of) <code>manual_auth</code> .</p>\n<pre><code>from contextlib import contextmanager\n\nfrom fastapi.testclient import TestClient\n\nfrom .app import app, validate_token\n\n\ndef auto_authenticate():\n    pass\n\n\n@contextmanager\ndef manual_auth():\n    try:\n        # Remove the override\n        del app.dependency_overrides[validate_token]\n        yield\n    finally:\n        # Reapply the override\n        app.dependency_overrides[validate_token] = auto_authenticate\n\n\n# Override the auth dependency globally to do nothing\napp.dependency_overrides[validate_token] = auto_authenticate\n\n\nclient = TestClient(app)\n\n\ndef test_hello():\n    response = client.get(&quot;/&quot;)\n    assert response.status_code == 200\n\n\ndef test_hello_not_authenticated():\n    with manual_auth():\n        response = client.get(&quot;/&quot;)\n        assert response.status_code == 403\n</code></pre>\n", "tags": ["python", "pytest", "fastapi", "fixtures"]}
{"id": "5e43681e-98f0-43c2-9198-eba981aaf078", "text": "Q: Git not committing, gpg stuck in database_open waiting for lock A: <p>A lock file might be left in the file system, preventing <code>gpg</code> from opening the keyring database.</p>\n<p>This can happen when the computer or process that held the lock (<code>9857</code> in your case) crashed.</p>\n<p>Quick check for lock files:</p>\n<pre class=\"lang-bash prettyprint-override\"><code>ls -al ~/.gnupg/public-keys.d\n</code></pre>\n<p>The lock file name is <code>pubring.db.lock</code>. There might also be other lock files starting with <code>.#lk0x</code> and ending with a process number.</p>\n<p>A strong indicator that something is in an invalid state is if the process id does not exist:</p>\n<pre class=\"lang-bash prettyprint-override\"><code>ps -p 9857\n</code></pre>\n<p>(replace <code>9857</code> with the number at the end of the <code>.#lk0x</code> files)</p>\n<h2>Solution</h2>\n<p>Manually <strong>delete</strong> the lockfile, then try again.</p>\n<pre class=\"lang-bash prettyprint-override\"><code>rm ~/.gnupg/public-keys.d/pubring.db.lock\n</code></pre>\n<p>Make sure to <strong>also delete</strong> any leftover/obsolete <code>.#lk0x*</code> files.</p>\n", "tags": ["git", "github-actions", "git-commit", "gnupg", "gpg-signature"]}
{"id": "058b5663-19b7-45fa-a9d2-7ce45445e31a", "text": "Q: Why do I not see the &quot;users and groups&quot; option when managing an azure ad enterprise app A: <p>deep under the covers the service principal must have the tag &quot;WindowsAzureActiveDirectoryCustomSingleSignOnApplication&quot; for that blade to appear.  you can't view service principal tags in the portal but can via graph services at <a href=\"https://graph.microsoft.com/v1.0/servicePrincipals/%7BservicePrincipalObjectId%7D\" rel=\"nofollow noreferrer\">https://graph.microsoft.com/v1.0/servicePrincipals/{servicePrincipalObjectId}</a></p>\n<p>try using graph explorer to see</p>\n<pre><code>    &quot;tags&quot;: [\n        &quot;WindowsAzureActiveDirectoryCustomSingleSignOnApplication&quot;\n    ],\n</code></pre>\n", "tags": ["azure", "azure-active-directory"]}
{"id": "15d8d448-f0d6-4d18-ad20-fa6fee2fb49d", "text": "Q: How handle I correct a SVG icon in React? A: <p>Don't try and access files from the /src since its not a public directory if you want to use images you HAVE to put it in the public</p>\n", "tags": ["reactjs", "typescript", "svg"]}
{"id": "473e8d03-5c12-46ef-806e-8b815e0adc1e", "text": "Q: Project loom: Why are virtual threads not the default? A: <h2>tl;dr</h2>\n<p>Java has no \u201cdefault\u201d kind of thread. You choose.</p>\n<ul>\n<li>Use virtual threads for tasks that involve <a href=\"https://en.wikipedia.org/wiki/Blocking_(computing)\" rel=\"nofollow noreferrer\">blocking</a>.</li>\n<li>Use platform threads for:\n<ul>\n<li><a href=\"https://en.wikipedia.org/wiki/CPU-bound\" rel=\"nofollow noreferrer\">CPU-bound</a> tasks.</li>\n<li>Tasks that call long-running <a href=\"https://en.wikipedia.org/wiki/Native_(computing)\" rel=\"nofollow noreferrer\">native code</a>.</li>\n</ul>\n</li>\n</ul>\n<p>In Java 21/22/23, use platform threads for tasks with long-running code that is <code>synchronized</code>. For Java 24 and later, use virtual threads, per <a href=\"https://openjdk.java.net/jeps/425\" rel=\"nofollow noreferrer\">JEP 425</a>.</p>\n<h2>No default</h2>\n<p>You asked:</p>\n<blockquote>\n<p>Why not just make them the default?</p>\n</blockquote>\n<p>In modern Java, we generally do not address threads directly. Instead, we use the Executors framework added years ago in Java 5.</p>\n<p>In particular, in most cases a Java programmer uses the <a href=\"https://download.java.net/java/early_access/loom/docs/api/java.base/java/util/concurrent/Executors.html\" rel=\"nofollow noreferrer\"><code>Executors</code></a> utility class to produce an <a href=\"https://download.java.net/java/early_access/loom/docs/api/java.base/java/util/concurrent/ExecutorService.html\" rel=\"nofollow noreferrer\"><code>ExecutorService</code></a>. That executor service is backed by various kinds of thread factories or thread pools.</p>\n<p>For example, if you want to serialize one task after another, we would use an <a href=\"https://download.java.net/java/early_access/loom/docs/api/java.base/java/util/concurrent/Executors.html#newSingleThreadExecutor()\" rel=\"nofollow noreferrer\">executor service backed by a single thread</a>.</p>\n<pre><code>ExecutorService executorService = Executors.newSingleThreadExecutor() ;\n</code></pre>\n<p>If you browse through <code>Executors</code> class Javadoc, you will see a variety of options. \ud83d\udc49 None of them is &quot;default&quot;. The programmer chooses one to suit the needs of her particular situation.</p>\n<p>With <a href=\"https://wiki.openjdk.java.net/display/loom/Main\" rel=\"nofollow noreferrer\">Project Loom</a>, we will have at least one more such option to choose from. In the preview build of Java, call the new <a href=\"https://download.java.net/java/early_access/loom/docs/api/java.base/java/util/concurrent/Executors.html#newVirtualThreadPerTaskExecutor()\" rel=\"nofollow noreferrer\"><code>Executors.newVirtualThreadPerTaskExecutor()</code></a> to get an executor service backed by <a href=\"https://openjdk.java.net/jeps/425\" rel=\"nofollow noreferrer\">virtual threads</a>. Go nuts, and throw a million tasks at it.</p>\n<pre><code>ExecutorService executorService = Executors.newVirtualThreadPerTaskExecutor() ;\n</code></pre>\n<p>You asked:</p>\n<blockquote>\n<p>why are they separate things?</p>\n</blockquote>\n<p>One of the highest priorities for the Java team is backward-compatibility: Existing apps should be able to run without surprise.</p>\n<p>Virtual threads have a <em>very</em> different behavior and performance profile than platform threads. So I do not expect to see the Java team retrofitting virtual threads onto existing features of Java generally. They may choose to do so, but only if absolutely certain no detrimental effects will surface in the behavior of existing apps.</p>\n<h1>When to choose or avoid virtual threads</h1>\n<p>You asked:</p>\n<blockquote>\n<p>Is there any reason to not use them?</p>\n</blockquote>\n<p>Yes, certainly. Two reasons:</p>\n<ul>\n<li>CPU-bound tasks</li>\n<li>Tasks used to indirectly throttle other resources</li>\n</ul>\n<h3>CPU-bound tasks</h3>\n<p>The entire point of virtual threads is to keep the &quot;real&quot; thread, the platform host-OS thread, busy. When a virtual thread blocks, such as waiting for storage I/O or waiting network I/O, the virtual thread is &quot;dismounted&quot; from the host thread while another virtual thread is &quot;mounted&quot; on the host thread to get some execution done.</p>\n<p>So, if your task\u2019s code does not block, do not bother with virtual threads. But this kind of code is rare. Most tasks in most apps are often waiting for users, storage, databases, networks, attached devices, etc. An example of a rare task that might not block is something that is <a href=\"https://openjdk.java.net/jeps/425\" rel=\"nofollow noreferrer\">CPU-bound</a> like video-encoding/decoding, scientific data analysis, or some kind of intense number-crunching. Such tasks should be assigned to platform threads directly rather than virtual threads.</p>\n<h3>Throttling</h3>\n<p>Another reason to avoid virtual threads is with existing code that depends on the limits or bottlenecks of platform threads to throttle their app\u2019s usage of other resources. For example, if a database server is limited to 10 simultaneous connections, then some app have been written to use an executor service backed by only 8 or 9 threads. Such existing code should not be blindly switched to virtual threads.</p>\n<p>Of course such code is less than optimal. Such a code base would be better, clearer, more obvious to comprehend if explicit limiting/throttling mechanisms were utilized.</p>\n<p>Using explicit throttling mechanisms will be needed if a programmer wants to benefit having thousands, even millions, of simultaneous virtual threads while avoiding exhausting/overloading other limited resources.</p>\n<p>Java has long offered such throttling mechanisms. They just were not always used, given the simplicity/ease of relying on the limits/bottlenecks of a limited number of platform threads.</p>\n<h3>Other contraindications</h3>\n<p>Virtual threads are not appropriate in two more situations:</p>\n<ul>\n<li>Long-running calls to native code (JNI, Foreign Functions, etc).</li>\n<li>Long-running code that is <code>synchronized</code>, in Java 21/22/23, before Java 24. See <a href=\"https://openjdk.org/jeps/491\" rel=\"nofollow noreferrer\"><em>JEP 491: Synchronize Virtual Threads without Pinning</em></a>. Non-issue in Java 24/25 and later.</li>\n</ul>\n<p>In both cases the virtual thread scheduler is unable to detect blocking.</p>\n<h2>For more info</h2>\n<p>For details, see the articles, talks, and interviews of Ron Pressler, Alan Bateman, or Jos\u00e9 Paumard.</p>\n", "tags": ["java", "project-loom"]}
{"id": "27dfc6a1-c6cd-46de-9497-b7439ca9139d", "text": "Q: Flutter ImageFilter.blur is gone when scrolling to beginning or end of list A: <p><code>BackdropFilter</code> blurs what's behind it. When you overscroll, the card moves past the edge where there's actual content, nothing to blur.</p>\n<p>Quick fix, clamp the scroll so it can't overscroll:</p>\n<pre><code>physics: const ClampingScrollPhysics(),\n</code></pre>\n<p>Or clip the PageView:</p>\n<pre><code>clipBehavior: Clip.hardEdge,  // instead of Clip.none\n</code></pre>\n<p>Either stops the card from entering &quot;empty space&quot; where the blur has nothing to work with.</p>\n", "tags": ["flutter", "dart", "mobile-development"]}
